
---
title: "Time series properties of US reference rates 2016-2023"
author: "Nancy Hammond"
date: "`r format(Sys.Date(), '%Y-%m-%d')`"
geometry: "left=3cm,right=3cm,top=2cm,bottom=2cm"
output: 
  bookdown::pdf_document2:
    toc: false
    keep_tex: true
    fig_caption: yes
    includes:  
      in_header: my_latex_file.tex
    extra_dependencies: ["float"]
    number_sections: yes
    latex_engine: pdflatex
header-includes:
  - \usepackage{booktabs}
  - \usepackage{float}
  - \usepackage{placeins}
echo: false  
---



<!--
regex: 
      - "Rate characteristics \\d{1,2}"
      - "EFFR Key percentiles during sample period\\d{1,2}"
      
geometry: "left=3cm,right=3cm,top=2cm,bottom=2cm"
output: 
  bookdown::pdf_document2:
    toc: true
    keep_tex: true
    fig_caption: yes
    number_sections: yes
    latex_engine: pdflatex
header-includes:
  - \usepackage{booktabs}
  - \usepackage{float}
echo: false
-->


```{r setup, include=FALSE}
library(ggplot2)
library(dplyr)
library(tidyverse)
library(knitr)
library(xtable)
library(tinytex)
library(reshape2)
library(bookdown)
library(gridExtra)
library(cowplot)
library(patchwork)
library(caTools)
library(kableExtra)
library(knitr)
knitr::opts_chunk$set(echo = FALSE, cache = FALSE)
#knitr::opts_chunk$set(cache = FALSE)
#knitr::knit("ONRates_simplev10_05262024v6.Rmd")
```

```{r, echo=FALSE, }
knitr::opts_chunk$set(cache = FALSE)
knitr::opts_chunk$set(cache.rebuild = TRUE)
```



```{r, echo=FALSE, }
knitr::opts_chunk$set(fig.pos = "!H")
```
<!--
\url{https://stackoverflow.com/questions/44850011/how-to-stop-bookdown-tables-from-floating-to-bottom-of-the-page-in-pdf}
data_frame(col_a = seq_len(5), col_b = rnorm(5), col_c = runif(5)) %>%
  knitr::kable(caption = "This is a test") %>%
  kableExtra::kable_styling(latex_options = "hold_position")
  
  xtable_output <- xtable(charnorm, caption = "Normalcy 3/04/2016-7/31/2019", caption.placement = "top", comment = FALSE)

# Print xtable with custom sanitize function to remove comments
print(xtable_output, 
      file = "my_table.tex",
      sanitize.text.function = function(x) {x})

# Read the generated table and apply kable styling
table_content <- readLines("my_table.tex")
kable_output <- kable(table_content, format = "latex", booktabs = TRUE)
kable_styled <- kable_styling(kable_output, latex_options = "hold_position")


  
  
\url{https://stackoverflow.com/questions/16626462/figure-position-in-markdown-when-converting-to-pdf-with-knitr-and-pandoc}
\url{https://rbasics.org/packages/pandoc-package-in-r/}
overstack solution for figure placement
\usepackage{float}
\let\origfigure\figure
\let\endorigfigure\endfigure
\renewenvironment{figure}[1][2] {
    \expandafter\origfigure\expandafter[H]
} {
    \endorigfigure
}


CHAT how to:
# Define the LaTeX content as a character vector
latex_content <- "
\\usepackage{float}
\\let\\origfigure\\figure
\\let\\endorigfigure\\endfigure
\\renewenvironment{figure}[1][2] {
    \\expandafter\\origfigure\\expandafter[H]
} {
    \\endorigfigure
}
"

# Write the LaTeX content to a .tex file
writeLines(latex_content, con = "my_latex_file.tex")

# Alternatively, you can use cat
cat(latex_content, file = "my_latex_file.tex")



Here is example .Rmd which includes it (assuming you called the .tex file 'preamble-latex.tex'):

---
title: "example"
author: "you"
date: "`r format(Sys.time(), '%d %B %Y')`"
output:
  rmarkdown::pdf_document:
    fig_caption: yes        
    includes:  
      in_header: preamble-latex.tex
---

```{r, fig.cap='Markdownvellous!'}
plot(1:10, 1:10)
```
-->
```{r, load environment mp, echo=FALSE, cache=FALSE}
my_envmp <<- readRDS("C:/Users/Owner/Documents/Research/OvernightRates/my_environmentmp.RDS")
#saveRDS(my_envmp, file = "C:/Users/Owner/Documents/Research/OvernightRates/my_environmentmp.RDS")
# rmarkdown::render("C:/Users/Owner/Documents/Research/OvernightRates/ONrates03142024draft.Rmd",envir= my_envmp)
```


```{r, load environment episodes, echo=FALSE, cache=FALSE}
#rm(my_envepisodes)
my_envepisodes <<- readRDS("C:/Users/Owner/Documents/Research/OvernightRates/my_envepisodes.RDS")
# Assign individual variables from the environment to the global environment
quantilesE <- my_envepisodes$quantilesE
quantilesT <- my_envepisodes$quantilesT
quantilesB <- my_envepisodes$quantilesB
quantilesS <- my_envepisodes$quantilesS
#saveRDS(my_envepisodes, file = "C:/Users/Owner/Documents/Research/OvernightRates/my_envepisodes.RDS")
```


```{r, load environment boxplots, echo=FALSE, cache=FALSE}
my_environmentbox <<- readRDS("C:/Users/Owner/Documents/Research/OvernightRates/my_envbox.RDS")
#Correct the assignment
badjust <- my_environmentbox$adjust
bcovid <- my_environmentbox$covid
bzlb <- my_environmentbox$zlb
binflation <- my_environmentbox$inflation 
```

```{r, load environment box, echo=FALSE}
my_environmentbox <- readRDS("C:/Users/Owner/Documents/Research/OvernightRates/my_environmentbox.RDS")
```

```{r, load environment volatile, echo=FALSE}
my_envvolatile <<- readRDS("C:/Users/Owner/Documents/Research/OvernightRates/my_envvolatile.RDS")
#str(my_envvolatile$sample_measure1)
```

```{r,echo=FALSE}
library(knitr)
fomc <- read.csv('C:/Users/Owner/Documents/Research/OvernightRates/Final data files/FOMCrates_sampleFinalv2.csv', header = TRUE, sep = ",", dec = ".", stringsAsFactors = FALSE, nrows = 40)
#kable(fomc)
```


<!--
Structure of article: IMRAD:
Introduction
Data
Methodology
Results and
Discussion
Conclusion
Acknowledgements
References
Supporting Materials
-->



```{r, main data spread, echo=FALSE}
#Access the data frame stored in the environment
my_data <- my_envmp$spread_no_na
``` 

```{r, sdate,echo=FALSE}
sdate<-as.Date(my_data$Date,"%m/%d/%Y"); 
```

```{r, select sample,echo=FALSE}
begs <-which(sdate == as.Date("2016-03-04"))[1] #sample start date 3/04/2016
ends <-which(sdate == as.Date("2023-12-14"))[1] #sample end  date  12/27/2022
my_data=my_data[begs:ends,]
spread_no_na=my_data[begs:ends,]
```

```{r, Load rate data frame rrbp, echo=FALSE}
rrbp <<- data.frame(
  subset(my_data, select = c("sdate","EFFR","TGCR", "BGCR", "SOFR")
))
```

```{r, Load volume data frame vold, echo=FALSE}
vold <- data.frame(
  subset(my_data, select = c("sdate","VolumeEFFR", "VolumeTGCR","VolumeBGCR","VolumeSOFR"))
)
```


```{r,initialize list the lists measure_list1 and measurelist_2 to store matrices, echo=FALSE}
nmat <- 6 #number of matrices
ncl <- 5#number of columns
begn<- c(1, 859, 923,  1014, 1519, 1)
endn<- c(858, 922, 1013, 1518, 1957, 1957)
start_dates <- sdate[begn]
end_dates <- sdate[endn]
start_dates_strings <- as.character(start_dates)
end_dates_strings <- as.character(end_dates)
measure_list1 <- vector("list", length = nmat)
measure_list2 <- vector("list", length = nmat)
my_envvolatile$norm_measure1 <- subset(my_envvolatile$norm_measure1, select = c("EFFR", "TGCR", "BGCR", "SOFR"))
```
# Abstract
How monetary policy impacts volatility of rates in the market for repurchase agreements also reveals
the Federal Reserve preference for volatility as it manages the policy rate, the Federal Funds
rate (FFR) within the target rate range specified by the FOMC. The Fed’s open market operations adjust reserves through repurchase transactions in the tri-party market to offset volatility in the Federal Funds rate.  The Fed's changes in the FFR, the target rate, and the administered rates, the interest on reserves (IORB) and the overnight reverse repurchase rate (ONRRP) also impact money market rates in these key funding markets. One puzzle is how the FFR survives the volatility of these short rates in the
Federal Reserve Bank management of the FFR within the FOMC’s target range 
 
 
This paper describes the dynamics of these rates and proposes a model of volatility joint with monetary policy. Comparing different policy regimes, we hope to elucidate the Fed's preferences for volatility in  managing the FFR within ranges set by the FOMC. How that volatility may vary under different monetary policy regimes may reveal the Fed's preferences for offsetting volatility in managing the FFR with the FOMC targets.


# Introduction
  How monetary policy impacts volatility of rates in the market for repurchase agreements also reveals how the Federal Reserve Bann (Fed) preference for volatility as it manages the policy rate, the Federal Funds rate (FFR) with the target rates specified by the FOMC. The Fed's  open market operations adjust reserves through repurchase transactions to maintain the Federal Funds rate within the FOMC’s target range. How does the Fed manage the FFR to survive the volatility of repurchase market rates? 

  The Fed was challenged to manage its policy rate after the excess liquidity created by quantitative easing after the Great Financial Crisis (GFC). Increasing the FFR by lowering reserves through repurchases or decreasing the FFR through lending through reverse repurchase is... Events like the spikes in repo and the FFR in 2019, the March 2020 dash for cash show how the adjustment of reserves through repurchase markets and the arbitrage opportunities between repo and the price of reserves affect credit and the economy.

   The daily \$4 trillion repurchase market market provides liquidity to primary dealers, hedge funds, money market funds, government-sponsored enterprise (GSEs), banks, and private investors. Bank reserves and deposits are regularly swapped for Treasuries and other securities, which are then swapped for repurchase agreements (repos) used to fund loans, obtain leverage, and many other functions. 
   
 The repurchase funding market rates are:
-  triparty general collaterialrate (TGCR) — the major dealer funding market
-  GCF — the interdealer repo market 
-  bilateral general collaterial rate (BGCR) — the dealer-to-customer repo market
-  The Secured Overnight Financing Rate (SOFR) is the Fed’s broadest measure of repo rates for borrowing     collateralized by US Treasury securities.

The Federal Funds rate is the Fed's policy rate, the rate banks exchange funds in the interbank market. The administered rates for setting policy, interest on reserves (IORB) and the overnight reverse repo rate are important tools for managing the FFR.

The tri-party general collaterial market is repo’s primary funding market, In tri-party repo, most players are cash lenders or borrowers. For example, primary dealers are required to intermediate US Treasury issuance to their customers. They finance these purchases from their inventory or by borrowing from the Fed in the triparty market. Participants obtain cash at the cheapest rates primarily from MMFs (money market funds) in tri-party repo, then lend at a spread in other repo markets. Primary dealers sell securities to the customers in the more lucrative OTC broad general collateral market.

To manage the federal funds rate within its target range, the Federal Reserve responds to volatility in the federal funds rate by adjusting reserves through repo and reverse repo operations in the triparty market. The Fed is the only major participant to engage in both tri-party repo borrowing and lending.  By trading securities with banks and other counterparites, Federal Reserve purchases or sales of assets from banks change the size of the Federal Reserve balance sheet. A repurchase transaction or repo is a loan secured by collateral subject to an agreement to resell the securities at a later date. The borrower issues a cash equivalent liability to the lender. In a reverse repo an entity lends cash against secured collateral. The Federal Reserve manages the FFR with temporary borrowing, repurchase agreements  and lending, reverse repurchase agreements. In a  repo transaction, the Desk purchases securities from a counterparty. The transaction temporarily increases the supply of reserve balances in the banking system and lowers the FFR. In a reverse repo transaction, the Desk sells securities to a counterparty subject to an agreement to repurchase the securities at a later date. Reverse repo transactions temporarily reduce the supply of reserve balances in the banking system and raise the FFR.
  
   The Federal reserve has also established facilities for dealers and investors, the Standard Repurchase Facility (SRF) to fund dealers. And the Overnight Reverse Repurchase Facility (O/N RRP) for lenders to invest excess liquidity. Identifying the behavior and relationhships among these reference rates, policy and money market rates, is important to understanding the monetary system.

Repurchase and reverse repurchase funding markets have become a major source of funding for primary dealers, hedge funds, government-sponsored enterprise (GSEs), money market funds (MMFS) and other participants. Primary dealers appointed by the Fed are required to intermediate new US Treasury issues. Primary dealers borrow at cheaper rates from lenders, asset managers in the tri party and the Fed, then lend at a spread in other repo markets. Loans are secured by collateral. They lend at the higher broad General Collateral Rate (BGCR) to leveraged investors such as hedge funds.The Fed conducts OMO in the tri party market, both  borrowing and lending.  The Secured Overnight Financing Rate (SOFR), Fed’s broadest measure of repo rates, expresses the average cost of borrowing overnight.


   The level of reserves in the banking system changes when the Fed responds to volatility in the federal funds market by adjusting the reserve supply to keep the federal funds rate within its target range through daily repo and reverse repo operations. Reserves can also change
1) when funds are transferred between reserves and non-reserve accounts at the Fed
2) with changes in the US Treasury account at the Fed



This paper describes the dynamics of these rates and proposes a model of volatility joint with monetary policy. Comparing different policy regimes, we hope to elucidate the Fed's preferences for offsetting volatility in  managing the FFR within ranges set by the FOMC. How that volatility may vary under different monetary policy regimes may reveal the Fed's preferences for offsetting volatility in managing the FFR with the FOMC targets.
 
Section  1 reviews monetary policy over the seven year period, 2016-2023  and identies FOMC rate changes, monetary regimes, and events in order to define monetary shocks. (see other authors like J and new?)
Section 2 reviews the time series properties of daily policy and money market rates and transactions held at the Federal Reserve from 3/4/2016-12/14/2023. Section 3 describes rate behavior during different policy episodes.  Section 4 discusses methodology for modelling volatility of the EFFR. Section 5 Results.  Section 6 Conclusions.  Sections 5-6 are in progress.

<!--
key characteristics of the FFR - time varying volatility or autoregressive conditional heteroskedasticity, spectacular outliers, skew, fat tails. shifts around central tendencies, jumps.
-->

Hamilton (1996) was the first to estimate the conditional mean and the conditional variance of the daily Federal Funds rate (FFR) in an adaption of Nelson's (1991) EGARCH model. Open-market purchases rather than interday arbitrage smooth  small fluctuations in the FFR. Adding reserves through an overnight repurchase agreement lowers the federal funds rate by inducing movement along a schedule that represents lending banks' liquidity benefit from holding excess reserves. Important day effects, the last day of the quarter or the last day of the year are responsible for large outliers of the FFR, the extreme volatility. 

Piazzesi (2005) exploits both Federal Reserve and financial markets watch and dependence on bond yields ina continuous-time model of the joint distribution of bond yields and the FOMC interest rate target for the FFR. With high-frequency data in a linear-quadratic jump-diffusion model. She provides information about the exact timing of FOMC meetings to improve bond pricing and ability to identify monetary policy shocks. Yield-based information that may underlie the FOMC’s policy decisions describes Fed policy better than Taylor rules. The Fed's estimated policy rule reacts to information in the yield curve, especially yields with two year maturities, implying the Fed responds to some medium-run forecast of the economy.The short informational lag before Fed's policy decision, information available right before the FOMC meeting start provides a recursive identification scheme that turns the target forecast from right before the Federal Open Market Committee (FOMC) meeting into a high-frequency policy rule and the associated forecast errors into policy shocks. Decisions about target moves result in a series of target values that look like a pure jump process. Estimates reveals increased volatility of interest rates at all maturities in both FOMC meeting days and releases of key macroeconomic data. Macro news releases change the conditional distribution of a future Fed move. Policy inertia is the Fed incremental implementation of changes in the FFR.

.. 
 

 
<!--
Findings:
 1) latent factors
 the target set by the Fed is an observable factor in the model and provides a clean measure of the short end of the yield curve. The use of target data avoids having to deal with calendar day effects in very short rates, which typically require lots of parameters
 2) Second, the estimated response of yields to policy shocks is strong and slowly declines only with the maturity of the yield
 3) The estimated policy rule describes the Fed as reacting to information contained in the yield curve. the most important information is contained in yields with maturities around two years, which suggests that the Fed reacts to some medium-run forecast of the economy. 

* The estimated policy rule displays interest rate smoothing: the target level is autocorrelated. 
* The rule also displays policy inertia: the Fed only partially adjusts the target to its desired rate. Inertia leads to positive autocorrelation in target changes, because one change is typically followed by additional changes in the same direction over a number of FOMC meetings

* yield data summarize market expectations of future target moves. These market expectations are
based on a host of variables that are omitted from other rules. 
yield data are available at higher frequencies and are less affected by
measurement errors than macroeconomic variables. 
The model demonstrated the policy inertia, the tendency to continue same policy changes. 
-->

(Andersen, Benzoni,Lund, 2004) model the U.S. short-term interest rate 3 month Tbill with a three-factor jump-diffusion model, a time-varying mean reversion factor, a stochastic volatility factor, and a jump process.  The U.S. short-term interest rate is characterized by complex conditional heteroskedasticity, fat-tailed innovations, and pronounced autocorrelation patterns. Stochastic volatility is critical for a good fit. Benzoni et al identify mean reversion of the short rate around a central tendency. The stochastic mean  allows a relatively fast mean-reversion of the short rate around a highly persistent time-varying central tendency process. Jumps are integral to the quality of fit and relieve the stochastic volatility factor from accommodating extreme outlier behavior. 

The mean drift may be indicative of slowly evolving inflationary expectations (Gara horiz?), time-variation in the required real interest rate, or both.

Bertolini, Bertola, Prati (), Garaet al  () and Benzoni observe these effect of Fed interventions on the volatility in interbank rates 
* declines in high rate regimes  
* rises end of quarter, end of year  
* falls before holidays, rises day after  
* many rate changes are half percent or more (annualized)  
* outliers  
* Volatility persistent like Hamilton, end of quarter, end of year, before and after holidays, large rate changes.

<!--
    - TS properties. Many rate changes of half percent or more (annualized), and outliers. Volatility persistent. maintenace periods, calendar days, end of quarter, end of year, before and after holidays, large rate changes
    - Mean reversion versus dispersion?
-->


Bertolini, Bertola, Prati (2004) model of FFR volatility isolate Fed preferences for offsetting volatility in the FFR market in an EGARCH model of the log volatility of the FFR. Their work was motivated by the puzzle that the high frequency patterns of FFR volatility survives Fed's attempt to manage the FFR within the FOMC target range. Overnight wholesale money market rates both track the FFR and quickly revert to changes in the unsecured federal funds rate (FFR) or administered rates. 

Gara Afonso, Kyungmin Kim, Antoine Martin, Ed Nosal, Simon Potter, and Sam Schulhofer-Wohl derive a function of reserve demand that describes the price at which banks are willing to trade reserves as a function of the total amount of reserves in the banking system. The function measures banks’ demand for liquidity  as a function of aggregate reserves and the FFR under the Fed's policy of ample supply of reserves (2020). The FFR is price at which banks are willing to borrow and lend  reserve balances.The Banks' reserve demand sensitivity to shocks to reserves is greater when reserves are scarce. 

Policy changes shift the curve up and down by moving its lower bound. Increases (decreases) in the (FFR-IORB) IORB rate shift the demand curve down (up by changing the banks’ opportunity cost of lending in the federal funds market. Low frequency horizontal shifts in the demand function reflect sensitivity of rates to shocks to reserves

<!--
The slope of demand function is negative as reserves decline. When reserves are abundant [connect, the demand curve is flat around the the IORB rate paid by the Federal Reserve on reserve balancesthe banks’ opportunity cost of lending in the federal funds market. 

The reserve demand function, realized rates against realized reserves, is nonlinear, downward-sloping reflecting a negative relation ship between prices and quantities. The slope of the demand curve, representing the sensitivity of rates to reserve shocks, becomes increasingly steeper the more scarce are reserves. The slope flattens when reserves are abundant. 

\emph{Vertical shift}
Policy changes shift the curve up and down by moving its lower bound. Increases (decreases) in the (FFR-IORB) IORB rate shift the demand curve down (up by changing the banks’ opportunity cost of lending in the federal funds market 
\emph{Horizontal shift}
Low frequency horizontal shifts in the demand function reflect sensitivity of rates to shocks to reserves.
(1): AT every level of the FFR, the quantity of aggregate
reserves demanded by the banking system Increase. As a result of these shifts, the level of reserves at which the curve stops being flat and start displaying a negative slope may have moved over time.

The visible negative correlation between quantities (reserves) and prices (federal funds rates) suggests  supply shocks tend to dominate demand shocks. 
-->

The  Romer and Romer (2023) narrative approach to macroeconomic shocks identify as significant contractionary and expansionary changes in monetary policy not taken in response to current or prospective developments in real activity. However, this approach would exclude shocks such as policy changes such as QE, LSAP, and forward guidance or events such the spike in repo rates in 2019 or the March 2020 dash for cash. 
<!--
This goes in policy section
Changes in the Fed funds rate and the administered rates IORB and the reward rate ON RRP are one source of shocks to overnight reference rates (\@ref{table:FOMC rate changes 2016-2023})
-->

Jarocinski (2002) 
Another literature identifies monetary policy shocks from changes of financial asset prices in a narrow time window around Federal Open Market Committee (FOMC) announcements. Prior to the announcement, asset prices reflect the consensus view on the state of the economy and the Fed’s expected response to it. Afterwards, asset prices incorporate also any unexpected news conveyed in the announcement. These news could be about the current fed funds rate or its future path, asset purchases, the Fed’s view on the state of the economy, etc. They represent different structural shocks that may affect the economy differently.

Estimating the Fed's unconventional policy shocks, Javocinski (2022) estimates structural shocks that underlie the reactions of financial market to FOMC announcements. While the nature of the shocks is not specified ex ante, ex post the estimated shocks can be naturally labeled as the current fed funds rate policy, an “Odyssean” forward guidance (a commitment to a future course of policy rates), a large scale asset purchase and a “Delphic” forward guidance (a statement about the future course of policy rates understood as a forecast of the appropriate stance of the policy rather than a commitme;;;;nt (Campbell et al., 2012).

Alvarez metrics for kurtosis


# Time series properties of overnight policy, money market rates, transactions, and reserves held at the Federal Reserve
Daily weighted average median rates reference rates, both policy and money market rates (the NY Federal Reserve download program) are the effective (transaction weighted) Federal funds rate (EFFR) that tracks transactions in the Federal funds market, the secured overnight funding rate (SOFR) that captures transactions in  overnight wholesale funding markets, and the money market rates - the Tri-Party General Collateral Rate (TGCR) and the  broad general collateral rate (BGCR).
   
The repurchase markets provide liquidity to primary dealers, asset managers, hedge funds, government-sponsored enterprises (GSEs), money market funds and other participants.Participants borrow or lend securities for cash or reserves in the tri-party, GCF repo, and bilateral markets. The importance for monetary policy is the role of primary dealers who intermediate US Treasury issuance to their customers with their major counterparty the Federal Reserve bank. Dealers borrow overnight from the Fed in the tri party general collateral market at the lower TGCR rate, then sell the securities to their customers in the bilateral general collateral market at the higher BGCR rates. Then repay the Fed the next date.   Transactions in the tri party market are centrally cleared. The over the counter BGCR rates are the more lucrative rates in which  the U.S. central bank primary  dealers trade with their customers.The s overnight funding rate (SOFR) is broad measure of the cost of borrowing cash overnight collateralized by Treasury securities. SOFR replaced LIBOR as a benchmark overnight rate. The SOFR includes all trades in the triparty market, the Broad General Collateral market plus bilateral Treasury repurchase agreement (repo) transactions cleared through the Delivery-versus-Payment (DVP) service offered by the Fixed Income Clearing Corporation (FICC).

The Federal Reserve, both a borrower and lender in the triparty market, offsets volatility in the EFFR by adjusting reserves through repurchase and reverse purchase transactions.  In a  repo transaction, the Desk purchases securities from a counterparty. The transaction temporarily increases the supply of reserve balances in the banking system and lowers the FFR. In a reverse repo transaction, the Desk sells securities to a counterparty subject to an agreement to repurchase the securities at a later date. Reverse repo transactions temporarily reduce the supply of reserve balances in the banking system and raise the FFR.  Our interest is how much the Federal Reserve is willing to offset volatility in the FFR as it manages the FFR with the target rates specified by the FOMC.

Overnight money market rates in funding markets share several features. They closely closely track and cluster around the Fed policy rate, the EFFR. They respond quickly to changes in the EFFR or the administered rates IORB and ON RRP (Figure \@ref(fig:sampleratests). Their medians change over time, their small interquartile range (IQR) indicates that they cluster tightly around their medians. They contain extreme values or outliers, characteristic of fat tailed distributions. Rates are heteroskedastic - volatility as measured by percent change in in the sum of squared median returns varies over time.


The FFR, the administered rates, and money market rates have similar qualities  of short rates:
- All rates track and cluster around the FFR (measured by the effective Federal Funds rate (EFFR))
- Money market rates quickly respond to changes in the FFR and administrative rates, the IORR and the      ON/RRP
- The central tendency of all rates is their tight (low variance) clustering around their medians
- Their volatility changes over time, conditional heteroskedasticity 
- Rates highly skewed, 
- Distributions  are fat tailed due to extreme outliers
- Pronounced autocorrelation patterns



## Characteristics of the sample 2016-2023
The rate data from the Federal Reserve Data Download Program, average volume weighted medians, are a better measure of central tendency since daily rates have skewed distributions with outliers. Less influenced by extreme values, the Interquartile range (IQR), the 75th minus the 25 percentile of the data, contains 50 percent of the data.  The IQR describes how tightly rates cluster around their median.  The  range, the 99th minus the one percentile, some two percent of rates, show the magnitude of the outlier rates (Table (\@ref(tab:Rate characteristics 2016-2023)), the extreme values in rates.


```{r sampleratests, fig.cap="Sample reference rates 3/4/2016-12/14/2023", echo=FALSE,fig.num=TRUE, warning=FALSE, message=FALSE, results='asis'}
#sdate<-rrbp[,1]
#sdate<-spread_no_na$sdate
library(ggplot2)
library(reshape2)
#sdate<-as.Date(my_data$Date,"%m/%d/%Y")
#rrbp$sdate<-sdate
meltrrbp <- melt(rrbp,id="sdate")
maxr<-539
meltrrbp <- melt(rrbp, id = "sdate")
maxr <- 539

ratests_sample <- ggplot(meltrrbp, aes(x = sdate, y = value, colour = variable, shape = variable, group = variable)) + 
   geom_point(size = 1) +
   labs(x = "", y = "Basis Points (bp)", color = "Rate") +  
   scale_y_continuous(breaks = seq(0, maxr, by = 50), limits = c(0, maxr)) + 
   theme_minimal() + 
   guides(shape = guide_legend(title = "Rate"))
ratests_sample
   #my_envepisodes$ratests_sample<-ratests_sample
```


```{r, EFFR Key percentiles of the sample 3/4/2016-12/14/2023,echo=FALSE}
bgn<-1
edn<-nrow(rrbp)
sdate<-spread_no_na$sdate
sample<-rrbp[bgn:edn,]  # All
sdate<-spread_no_na$sdate
sdatesample<-sdate[bgn:edn]
qsampleE=quantilesE[bgn:edn,] 
qsampleT=quantilesT[bgn:edn,]
qsampleB=quantilesB[bgn:edn,]
qsampleS=quantilesS[bgn:edn,]

my_envepisodes$sdate <- sdate
my_envepisodes$sampleE <-qsampleE
my_envepisodes$sampleT <-qsampleT
my_envepisodes$sampleB <-qsampleB
my_envepisodes$sampleS <-qsampleS
my_envepisodes$sdate <- sdate
my_envepisodes$sampleE <-qsampleE
my_envepisodes$sampleT <-qsampleT
my_envepisodes$sampleB <-qsampleB
my_envepisodes$sampleS <-qsampleS

Estats <- colMeans(qsampleE[bgn:edn,2:ncol(qsampleE)], na.rm = TRUE)
Tstats <- colMeans(qsampleT[bgn:edn,2:ncol(qsampleT)], na.rm = TRUE)
Bstats <- colMeans(qsampleB[bgn:edn,2:ncol(qsampleB)], na.rm = TRUE)
Sstats <- colMeans(qsampleS[bgn:edn,2:ncol(qsampleS)], na.rm = TRUE)

# Add NA for targets 
Tstats2<-c(Tstats[1],Tstats[2], TargetUe=NA, TargetDe=NA,Tstats[3],Tstats[4],Tstats[5],Tstats[6])
Bstats2<-c(Bstats[1],Bstats[2], TargetUe=NA, TargetDe=NA,Bstats[3],Bstats[4],Bstats[5],Bstats[6])
Sstats2<-c(Sstats[1],Sstats[2], TargetUe=NA, TargetDe=NA,Sstats[3],Sstats[4],Sstats[5],Sstats[6])
```


```{r samplebox, fig.cap="EFFR IQR and range of the sample 3/4/2016-12/14/2023", echo=FALSE, warning=FALSE, message=FALSE,fig.pos='H', fig.label="samplebox"}
library(ggplot2)
boxplot_sample <- data.frame(
  Group = structure(1:4, .Label = c("EFFR", "TGCR", "BGCR", "SOFR"), class = "factor"),
  y0 = c(Estats[5], Tstats[3], Bstats[3], Sstats[3]),
  y25 = c(Estats[6], Tstats[4], Bstats[4], Sstats[4]),
  y50 = c(Estats[1], Tstats[1] , Bstats[1] , Sstats[1]) ,
  y75 = c(Estats[7], Tstats[5], Bstats[5], Sstats[5]),
  y100 = c(Estats[8], Tstats[6], Bstats[6], Sstats[6]))

  bsample <- ggplot(boxplot_sample, aes(x = Group,
                                        ymin = y0,
                                        ymax = y100,
                                        lower = y25,
                                        middle = y50,
                                        upper = y75,
                                        fill = Group)) +
    geom_boxplot(stat = "identity") +
    theme(panel.background = element_rect(fill = "white"),
        plot.background = element_rect(fill = "white"),
        axis.title.x = element_blank())  # Remove x-axis label
  bsample
```

```{r samplerates, fig.cap= "EFFR percentiles of the sample 3/4/2016-12/14/2023", echo=FALSE,fig.num=TRUE,warning=FALSE, message=FALSE}
  library(ggplot2)
          sample<-quantilesE
          sdate <- quantilesE[, 1]
          data_without_sdate <- quantilesE[, -1]
          #maxr<-max(normE[,ncol(quantilesE)]) 
          #minr<-min(normE[,ncol(quantilesE)])
          
          meltrates_sample <- melt(data.frame(sdate, data_without_sdate), id.vars = "sdate")
          rates_sample <<- ggplot(meltrates_sample, aes(x = sdate, y = value, colour = variable, group = variable)) + 
            geom_line() +
            labs(caption = "Sample 3/4/2016-12/14/2023", x = "", y = "rates basis points (bp) volume (billion dollars)", color = "Rate") +  
            scale_y_continuous(breaks = seq(0, maxr, by = 25), limits = c(0,maxr)) + 
            theme_minimal()
          #my_envepisodes$rates_sample<-rates_sample
  rates_sample
#Caption below the plot
#cat("\\vspace{10pt}", "\\caption{Sample 3/4/2016-12/14/2023}", "\\label{fig:sample_caption}", "\n")      
```

```{r samplevold, fig.cap= "Sample volumes of overnight rates 3/4/2016-12/14/2023", echo=FALSE,fig.num=TRUE,warning=FALSE, message=FALSE,fig.label="samplevold"}
y_breaks =25 
#str(vold)
maxr<-max(vold[,2:ncol(vold)]) #1850
dailyvolumes <- ggplot(vold, aes(x = sdate)) +
  geom_point(aes(y = VolumeEFFR, color = "EFFR"), shape = 16, size = 1) + 
  geom_point(aes(y = VolumeTGCR, color = "TGCR"), shape = 16, size = 1) + 
  geom_point(aes(y = VolumeBGCR, color = "BGCR"), shape = 16, size = 1) + 
  geom_point(aes(y = VolumeSOFR, color = "SOFR"), shape = 16, size = 1) + 
  labs(x = "", y = "volume (billions)", color = "Legend Title", linetype = "Legend Title") + 
  scale_color_manual(values = c("EFFR" = "black", "TGCR" = "green", "BGCR" = "blue", "SOFR" = "red"), name = "Legend Title") + 
  scale_linetype_manual(values = c("EFFR" = "solid",  "TGCR" = "dotted", "BGCR" = "dotdash", "SOFR" = "longdash"), name = "Legend Title") +  
   scale_y_continuous(breaks = seq(0,maxr, by = 100), limits = c(0, maxr)) +
   #scale_y_continuous(breaks = y_breaks, limits = y_limits) + 
  theme_minimal()
dailyvolumes
```

\emph{Funding rates track the FFR}
Median funding rates closely track the the policy rate, the effective Federal funds rate (EFFR) (Table \@ref(tab:Sample statistics 2016-2023)). Similar average median rates illustrate the tendency of money market rates and SOFR to cluster around the EFFR. The average median EFFR over the full sample is 157 basis point (bp), the money market rates about 132-134 bp - Tri-Party General Collateral Rate (TGCR),  the Broad General Collateral Rate (BGCR) 133 bp, the the Secured Overnight Financing Rate (SOFR), 134 bp. The percentiles of rates reflect the same clustering around the EFFR (Figure \@ref(fig:samplerates)).

<!--
(Figure \@ref (fig:EFFR percentiles of the sample 3/4/2016-12/14/2023)).
(Figure \@ref(fig:EFFR IQR and range of the sample 3/4/2016-12/14/2023)).
(Figure \@ref(fig:Volatility percent change daily rates 2016-2023)).
(Figure \@ref(fig:Sample volumes of reference rates 3/4/2016-12/14/2023)). 
-->

\emph{Variability: Small IQRs for all rates except SOFR, indiate rates cluster tightly around their median values (Figure \@ref(fig:samplebox)).Fifty percent of EFFR daily rates fall within 157.71-156.15 bp, an IQR of  1.56 basis points, the TGCR and BGCR cluster even more tightly, under one bp (133), SOHR  shows greater dispersion, 4.2 bp. (136.70-132.50).

\emph{Outliers}
The EFFR and money market rates are skewed with fatter tails.  A large range means high variability, a small range means low variability. The range of the EFFR and the money market rates, two percent of the data in the 99th minus the one percentile show sample TGCR, BGCR, and SOFR rates are some 14 to 16 basis points -  15.99 (EFFR), 13.86 (TGCR), 16.11 (BGCR), and 14.51 (SOFR) basis points. 

\emph{Volatility} 
The change in volatility over time, the percent change in median reference rates, indicates heteroskedasticity in rate data. From 2016 to 2020, the percent change in these daily rates, ranges plus of minus 0.5 percent from 2016 to November 2019 (Figure \@ref(fig:samplevola)). From  2020 to 2022 during the pandemic until the Fed began its fight to contain inflation in 2023, the percent change in rates varies plus or minus 2 percent. Volatility falls steadily during the fight against inflation.

<!--
Figure \@ref(fig:volatility Percent change Daily rates 2016-2023)
              EFFR     TGCR     BGCR     SOFR    
Rate          156.9688 132.8314 132.8482 134.0756
Volume        78.91262 296.9484 311.2315 754.3664
Upper target  170.5161 NA       NA       NA      
Lower target  145.5161 NA       NA       NA      
Percentile_01 153.07   124.8942 125.0746 NA      
Percentile_25 156.1502 132.3551 132.3679 NA      
Percentile_75 157.7067 133.2718 133.325  129.022 
Percentile_99 169.0629 138.7547 141.1865 132.5059

          Median IQR  Range VOl
     EFFR 156.97 1.56 15.99 78.91
TGCR TGCR 132.83 0.92 13.86 296.95
BGCR BGCR 132.85 0.96 16.11 311.23
SOFR SOFR 134.08 4.20 14.51 754.37

\url{https://statisticsbyjim.com/basics/interquartile-range/}
 Most ranges are double digit to 41.26 percent SOFR data as outliers during the adjustment period. In contrast, 
-->
<!--
The lines or ribbon in Figure show the EFFR is on average within the FOMC target range, 145.52 to 170.52 trough out the sample. Only one 5.25 when?? [indicate where in percentile plots]
FIND THIS CHART OR DOES IT EXIST IN rates_sample. aka samplequantiles
-->

\emph{Volume}
The volume of SOFR transactions, \$754 billion per day, dwarf trading in all other EFFR and money market rates. EFFR has a notably lower daily trade volume of \$79 billion,  TGCR and BGCR at around \$300 billion each (TGCR 296.95, BGCR 311.23) (Figure \@ref(fig:samplevold)).



<!--
Establish Mean reversion around a central tendency in daily rates. MR within2,3,...5 days show?
Is there a relationship to policy iniertia?
-Benzoni identify mean reversion around a central tendency. The stochastic mean  allows a relatively fast -mean-reversion of the short rate around a highly persistent time-varying central tendency process. 
-Jumps are integral to the quality of fit and relieve the stochastic volatility factor from accommodating -extreme outlier behavior. 
-->


```{r, tab.cap="Rate characteristics 2016-2023", echo=FALSE, results='asis',warning=FALSE, message=FALSE}
library(xtable)
k=6 
bgn<-1
edn<-nrow(rrbp)
sdate<-spread_no_na$sdate
sample<-rrbp[bgn:edn,]  # All
sdate<-spread_no_na$sdate
sdatesample<-sdate[bgn:edn]
qsampleE=quantilesE[bgn:edn,] # rate specific metrics 
qsampleT=quantilesT[bgn:edn,]
qsampleB=quantilesB[bgn:edn,]
qsampleS=quantilesS[bgn:edn,]

my_envepisodes$sdate <- sdate
my_envepisodes$sampleE <-qsampleE
my_envepisodes$sampleT <-qsampleT
my_envepisodes$sampleB <-qsampleB
my_envepisodes$sampleS <-qsampleS

Estats <- colMeans(qsampleE[bgn:edn,2:ncol(qsampleE)], na.rm = TRUE)
Tstats <- colMeans(qsampleT[bgn:edn,2:ncol(qsampleT)], na.rm = TRUE)
Bstats <- colMeans(qsampleB[bgn:edn,2:ncol(qsampleB)], na.rm = TRUE)
Sstats <- colMeans(qsampleS[bgn:edn,2:ncol(qsampleS)], na.rm = TRUE)

Tstats2<-c(Tstats[1],Tstats[2], TargetUe=NA, TargetDe=NA,Tstats[3],Tstats[4],Tstats[5],Tstats[6])
Bstats2<-c(Bstats[1],Bstats[2], TargetUe=NA, TargetDe=NA,Bstats[3],Bstats[4],Bstats[5],Bstats[6])
Sstats2<-c(Sstats[1],Sstats[2], TargetUe=NA, TargetDe=NA,Sstats[3],Sstats[4],Sstats[5],Sstats[6])

Estats_mat <- matrix(Estats, nrow = 8, ncol = 1)
Tstats_mat <- matrix(Tstats2, nrow = 8, ncol = 1)
Bstats_mat <- matrix(Bstats2, nrow = 8, ncol = 1)
Sstats_mat <- matrix(Sstats2, nrow = 8, ncol = 1)




charsample <- cbind(Estats_mat, Tstats_mat, Bstats_mat, Sstats_mat)
rownames(charsample) <- c("Rate", "Volume", "Upper target", "Lower target", 
                     "Percentile_01", "Percentile_25", "Percentile_75", "Percentile_99")
colnames(charsample) <- c("EFFR", "TGCR", "BGCR",  "SOFR")
xtable(charsample, caption = "Rate characteristics 2016-2023", label = "tab:Rate characteristics 2016-2023")
#print(xtable(charsample),type = "latex", digits = c(2, 2, 2, 2),include.rownames = FALSE, caption.placement = "top", comment = FALSE)
#kable(charsample, format = "latex", caption = "Adjustment 8/1/2019-10/31/2019")
```


```{r, EFFR Key percentiles during sample period 3/4/2016-12/14/2023,echo=FALSE}
k=6
begn<- c(1, 859, 923,  1014, 1519, 1)
endn<- c(858, 922, 1013, 1518, 1957, 1957)
bgn<-begn[k]
edn<-endn[k]
qsampleE=quantilesE[bgn:edn,] # rate specific metrics  -->
qsampleT=quantilesT[bgn:edn,] 
qsampleB=quantilesB[bgn:edn,] 
qsampleS=quantilesS[bgn:edn,] 

Estats <- colMeans(qsampleE[,2:ncol(qsampleE)], na.rm = TRUE)
#resave qsamplee to env with sdate in position s
#Ostatssample <- colMeans(qsampleO[,2:ncol(qsampleO)], na.rm = TRUE)
Tstats <- colMeans(qsampleT[,2:ncol(qsampleT)], na.rm = TRUE)
Bstats <- colMeans(qsampleB[,2:ncol(qsampleB)], na.rm = TRUE)
Sstats <- colMeans(qsampleS[,2:ncol(qsampleS)], na.rm = TRUE)
```


```{r, tab.cap="Sample statistics 2016-2023", echo=FALSE, results='asis',warning=FALSE, message=FALSE}
library(xtable)
k=6 
bgn<-1
edn<-nrow(rrbp)
sample<-rrbp[bgn:edn,]  # All
sdate<-spread_no_na$sdate
sdatesample<-sdate[bgn:edn]
qsampleE=quantilesE[bgn:edn,] 
qsampleT=quantilesT[bgn:edn,] 
qsampleB=quantilesB[bgn:edn,]
qsampleS=quantilesS[bgn:edn,]

categories = c('EFFR', 'TGCR', 'BGCR', 'SOFR')
median_values = c(Estats[1], Tstats[1], Bstats[1], Sstats[1])
iqr_values = c(Estats[7] - Estats[6], Tstats[5] - Tstats[4], Bstats[5] - Bstats[4], Sstats[5] - Sstats[4]) 
range_values = c(Estats[8] - Estats[5],  Tstats[6] - Tstats[3], Bstats[6] - Bstats[3], Sstats[6] - Sstats[3])
volume=c(Estats[2],Tstats[2],Bstats[2],Sstats[2])
ratesamplestats <- data.frame(Category = categories, Median = median_values, IQR = iqr_values, RANGE=range_values, VOLUME=volume)
row.names(ratesamplestats) <- NULL
xtable(ratesamplestats,include.rownames = FALSE, caption="Sample 3/04/2016-12/14/2023", caption.placement="top")
#print(xtable(ratesamplestats), type = "latex",digits = c(2, 2, 2, 2), include.rownames = FALSE, caption.placement = "top", comment = FALSE)
```

```{r samplevola,  fig.cap= "Volatility percent change daily rates 2016-2023", echo=FALSE,fig.num=TRUE,warning=FALSE, message=FALSE, fig.label="samplevola"}
#env=my_envvolatile
library(ggplot2)
sdate<-as.Date(my_data$Date,format="%m/%d/%Y")
k=6
my_envvolatile$sample_measure1 <- subset(my_envvolatile$sample_measure1, select = c("EFFR", "TGCR", "BGCR", "SOFR"))

df <- as.data.frame(my_envvolatile$sample_measure1)
df <- df*100
df$OBFR <- NULL
bgn<-1
edn<-nrow(df)
start_dates <-sdate[bgn]
end_dates <-sdate[edn]
sdate<-sdate[(bgn+1):edn]

start_dates_strings <- as.character(start_dates)
end_dates_strings <- as.character(end_dates)
title <- paste("Percent change in rates during full sample", start_dates_strings[1], "to", end_dates_strings[length(end_dates_strings)])
#figure_number <- 10
#title <- paste("Figure", figure_number, ": Log percent change in rates during normalcy period", start_dates_strings[1], "to", end_dates_strings[length(end_dates_strings)])
library(tidyr)
df$sdate <- sdate[bgn:edn]

#Reshape the data to long format
df_long <- gather(df, key = "Variable", value = "Value", -sdate)

logchange_rates_sample<-ggplot(df_long, aes(x = sdate, y = Value, color = Variable)) +
  geom_point() +
  labs(caption = title,
       x = "",
       y = "percent change in basis points",
       color = "Variable") +
  #theme(plot.title = element_text(hjust = 0.5))
  #labs(caption = paste("Figure", figure_number))
  theme_minimal()
logchange_rates_sample
#(see Figure \@ref(fig:stdev volatility 5day)
```


## Behavior the Federal Funds rate and money market rates during different policy episodes
<!--
IS THIS ABOUT EPISODES?
The interquartile range for SOFR exceeds that for the EFFR and the money market rates TGCR and BGCR; fifty percent of SOFR rates lie within 10.53 bp during adjustment, 7.37 during covid, and 5.68 during inflation.The middle 50 percent of the data is more tighly clustered for all other rates in all episodes.

The range of the data, the 99th minus the first percentile, illustrates the extensive outliers, typical of short rates. The smallest is 5.62 TGCR during normalcy.

 Most ranges are double digit to 41.26 percent SOFR data as outliers during the adjustment period. In contrast, the range of the EFFR and the money market rates, TGCR, BGCR, and SOFR in the sample are some 14 to 16 basis points.
-->


The vertical shifts in rates from 2016 to 2023 suggest changes in distribution of rates during policy episodes. Forbes (2024) summarizes these monetary policy episodes:

- Normalcy   3/4/2016 to 7/31/2019  
- Mid cycle adjustment 8/1/2019 to 10/31/2019  
- Covid 11/1/2019 to 3/16/2020  
- Zero lower bound 3/17/2020 to 3/16/2022  
- Taming inflation 03/17/2022 - 12/14/2023 

I have added the period of the zero lower bound. A rigorous approach to identifying change in regimes is offered by (Valeria Gargiulo, Christian Matthes, and Katerina Petrova,2024) and (Bianchi, Ludvigson, and Ma, 2024). (\url{https://www.forbes.com/advisor/investing/fed-funds-rate-history/})

During the period of normalcy, there were a series of 25 basis point (bp) increase rates from 2016 to mid 2019 (Figure \@ref(fig:ratestsnorm), during the  mid cycle adjustment with plus or minus 25 bp from August to November 2019 (Figure \@ref(fig:ratestsadjust).  During covid from November 2019 to mid March 2020, there were  a series of 25 bp increases(Figure \@ref(fig:ratestscovid).  No changes in the policy rate during the zero lower bound period in 2020-2021 (Figure \@ref(fig:ratestszlb). From March 17, 2022 to December 14, 2023, the Fed raised the FFR in steady increments of 25, 50, and 75 bp.
 (Figure \@ref(fig:ratestsinflation). 
 
<!--
or joint plot pratests
\@ref(fig:Rates during different policy episodes)
-->

<!--
\url{https://www.forbes.com/advisor/investing/fed-funds-rate-history/}
Federal Funds Rate History 1990 to 2024 Michael Adams May 20, 2024
\url{https://www.forbes.com/advisor/investing/fed-funds-rate-history/}
\url{https://www.federalreserve.gov/monetarypolicy/timeline-balance-sheet-policies.htm}
\url{https://www.federalreserve.gov/monetarypolicy/timeline-balance-sheet-policies.htm} 2008-2014
June 14, 2017: The FOMC states that it "expects to begin implementing a balance sheet normalization program this year." The balance sheet normalization process is outlined in an "Addendum to the Policy Normalization Principles and Plans" released along with the postmeeting statement.
July 26, 2017: The FOMC states that it expects to begin implementing its balance sheet normalization program "relatively soon, provided that the economy evolves broadly as anticipated."
September 20, 2017: The FOMC announces that, "in October, the Committee will initiate the balance sheet normalization program described in the June 2017 Addendum to the Committee's Policy Normalization Principles and Plans."
?interim normalization period from 2015 to 2019. Several items come up:
\url{https://www.federalreserve.gov/monetarypolicy/files/quarterly_balance_sheet_developments_report_201911.pdf}
Nov 2019 thru 2023 4 or 5 reports
--> 


<!--
  episodesstats
      Category     Median        IQR     RANGE     VOLUME
EFFR      EFFR 133.789044  1.2202797 17.646853   75.86364
TGCR      TGCR  83.829837  0.2179487  5.620047  158.52564
BGCR      BGCR  83.835664  0.2307692  8.475524  166.42075
SOFR      SOFR  84.784382  3.3006993  8.531469  350.22028
EFFR1     EFFR 200.093750  4.6562500 17.671875   66.84375
TGCR1     TGCR 206.296875  1.2968750 22.703125  466.21875
BGCR1     BGCR 206.343750  1.3593750 34.000000  492.46875
SOFR1     SOFR 208.218750 10.5312500 41.265625 1151.00000
EFFR2     EFFR 150.461538  2.3516484 11.714286   71.70330
TGCR2     TGCR 148.637363  0.3076923 11.208791  401.73626
BGCR2     BGCR 148.637363  0.4175824 16.021978  423.18681
SOFR2     SOFR 151.186813  7.3736264 19.461538 1085.60440
EFFR3     EFFR   8.085149  1.5405941  7.332673   68.96832
TGCR3     TGCR   4.586139  0.1247525 11.211881  353.60396
BGCR3     BGCR   4.588119  0.1465347 11.859406  376.31881
SOFR3     SOFR   5.409901  3.0495050 14.441584  943.72277
EFFR4     EFFR 368.601367  1.6150342 23.364465   99.56492
TGCR4     TGCR 362.141230  3.2642369 32.273349  455.91572
BGCR4     BGCR 362.195900  3.3621868 33.339408  469.75399
SOFR4     SOFR 364.066059  5.6788155 21.353075 1199.93622
-->  

<!--
Establish Mean reversion around a central tendency in daily rates. MR within2,3,...5 days show?
Is there a relationship to policy inertia?
%Benzoni identify mean reversion around a central tendency. The stochastic mean  allows a relatively fast %mean-reversion of the short rate around a highly persistent time-varying central tendency process. 
%Jumps are integral to the quality of fit and relieve the stochastic volatility factor from accommodating %extreme outlier behavior. 
-->


<!--
Median rates  EFFR       TGCR       BGCR        SOFR
Normalcy      133.79  83.83  83.84   84.78
Adjust        200.09 206.3  206.34  208.22
Covid         150.46 148.64 148.64  151.19
Zlb             8.08   4.59   4.59    5.40
inflation     368.60 362.14 362.2   364.07

episodeschar
Normalcy 

                    EFFR       TGCR       BGCR        SOFR
Rate          133.789044  83.829837  83.835664   84.784382
Volume         75.863636 158.525641 166.420746  350.220280
Upper target  143.094406         NA         NA          NA
Lower target  118.094406         NA         NA          NA
Percentile_01 129.376457  79.883450  79.966200   81.437063
Percentile_25 133.326340  83.438228  83.452214   83.547786
Percentile_75 134.546620  83.656177  83.682984   86.848485
Percentile_99 147.023310  85.503497  88.441725   89.968531

Adjust  
Rate          200.093750 206.296875 206.343750  208.218750
Volume         66.843750 466.218750 492.468750 1151.000000
Upper target  212.890625         NA         NA          NA
Lower target  187.890625         NA         NA          NA
Percentile_01 192.078125 191.656250 191.796875  196.468750
Percentile_25 197.250000 205.625000 205.625000  206.000000
Percentile_75 201.906250 206.921875 206.984375  216.531250
Percentile_99 209.750000 214.359375 225.796875  237.734375

Covid 
Rate          150.461538 148.637363 148.637363  151.186813
Volume         71.703297 401.736264 423.186813 1085.604396
Upper target  168.956044         NA         NA          NA
Lower target  143.956044         NA         NA          NA
Percentile_01 145.802198 142.076923 142.296703  145.615385
Percentile_25 149.527473 148.472527 148.472527  148.714286
Percentile_75 151.879121 148.780220 148.890110  156.087912
Percentile_99 157.516484 153.285714 158.318681  165.076923

zlb
Rate            8.085149   4.586139   4.588119    5.409901
Volume         68.968317 353.603960 376.318812  943.722772
Upper target   25.000000         NA         NA          NA
Lower target    0.000000         NA         NA          NA
Percentile_01   5.069307   2.079208   2.051485    1.570297
Percentile_25   7.130693   4.520792   4.526733    3.920792
Percentile_75   8.671287   4.645545   4.673267    6.970297
Percentile_99  12.401980  13.291089  13.910891   16.011881

inflation
Rate          368.601367 362.141230 362.195900  364.066059
Volume         99.564920 455.915718 469.753986 1199.936219
Upper target  385.649203         NA         NA          NA
Lower target  360.649203         NA         NA          NA
Percentile_01 365.448747 340.849658 341.457859  355.364465
Percentile_25 367.562642 360.990888 361.013667  362.034169
Percentile_75 369.177677 364.255125 364.375854  367.712984
Percentile_99 388.813212 373.123007 374.797267  376.717540

episodesstats
      Category     Median        IQR     RANGE     VOLUME
EFFR      EFFR 133.789044  1.2202797 17.646853   75.86364
TGCR      TGCR  83.829837  0.2179487  5.620047  158.52564
BGCR      BGCR  83.835664  0.2307692  8.475524  166.42075
SOFR      SOFR  84.784382  3.3006993  8.531469  350.22028

EFFR1     EFFR 200.093750  4.6562500 17.671875   66.84375
TGCR1     TGCR 206.296875  1.2968750 22.703125  466.21875
BGCR1     BGCR 206.343750  1.3593750 34.000000  492.46875
SOFR1     SOFR 208.218750 10.5312500 41.265625 1151.00000

EFFR2     EFFR 150.461538  2.3516484 11.714286   71.70330
TGCR2     TGCR 148.637363  0.3076923 11.208791  401.73626
BGCR2     BGCR 148.637363  0.4175824 16.021978  423.18681
SOFR2     SOFR 151.186813  7.3736264 19.461538 1085.60440

EFFR3     EFFR   8.085149  1.5405941  7.332673   68.96832
TGCR3     TGCR   4.586139  0.1247525 11.211881  353.60396
BGCR3     BGCR   4.588119  0.1465347 11.859406  376.31881
SOFR3     SOFR   5.409901  3.0495050 14.441584  943.72277

EFFR4     EFFR 368.601367  1.6150342 23.364465   99.56492
TGCR4     TGCR 362.141230  3.2642369 32.273349  455.91572
BGCR4     BGCR 362.195900  3.3621868 33.339408  469.75399
SOFR4     SOFR 364.066059  5.6788155 21.353075 1199.93622

COVID
% latex table generated in R 4.3.2 by xtable 1.8-4 package % Thu Apr 25 15:05:13 2024
EFFR TGCR BGCR SOFR
Rate 150.46 148.64 148.64 151.19
Volume 71.70 401.74 423.19 1085.60
Upper target 168.96
Lower target 143.96
Percentile_01 145.80 142.08 142.30 145.62
Percentile_25 149.53 148.47 148.47 148.71
Percentile_75 151.88 148.78 148.89 156.09
Percentile_99 157.52 153.29 158.32 165.08
Table @ref(tab:Rate statistics covid 11/1/2019-3/16/2020) provides a summary of the data.
% latex table generated in R 4.3.2 by xtable 1.8-4 package % Thu Apr 25 15:05:13 2024
Category Median IQR RANGE VOLUME
EFFR Estatscovid 150.46 2.35 11.71 71.70
TGCR Tstatscovid 148.64 0.31 11.21 401.74
BGCR Bstatscovid 148.64 0.42 16.02 423.19
SOFR Sstatscovid 151.19 7.37 19.46 1085.60
(see Figure @ref(fig:Rates during covid 11/1/2019-3/16/2020
-->


```{r, tab.cap="Rate characteristics normalcy 3/4/2016-7/31/2019", eval=TRUE,echo=FALSE,results='markup',results='asis',warning=FALSE, message=FALSE}
library(xtable)
k=1 
begn <- c(1, 859, 923, 1014, 1519, 1) 
endn <- c(858, 922, 1013, 1518, 1957, 1957) 
bgn<-begn[k] 
edn<-endn[k] 
norm<-rrbp[bgn:edn,] 
sdatenorm<-sdate[bgn:edn]

qnormE=quantilesE[bgn:edn,]
qnormT=quantilesT[bgn:edn,]
qnormB=quantilesB[bgn:edn,] 
qnormS=quantilesS[bgn:edn,] 

my_envepisodes$sdatenorm <-sdatenorm
my_envepisodes$normE <-qnormE
my_envepisodes$normT <-qnormT
my_envepisodes$normB <-qnormB
my_envepisodes$normS <-qnormS

Estatsnorm <- colMeans(qnormE[,2:ncol(qnormE)], na.rm = TRUE)
Tstatsnorm <- colMeans(qnormT[,2:ncol(qnormT)], na.rm = TRUE)
Bstatsnorm <- colMeans(qnormB[,2:ncol(qnormB)], na.rm = TRUE)
Sstatsnorm <- colMeans(qnormS[,2:ncol(qnormS)], na.rm = TRUE)

Tstatsnorm2<-c(Tstatsnorm[1],Tstatsnorm[2], TargetUe=NA, TargetDe=NA,Tstatsnorm[3],Tstatsnorm[4],Tstatsnorm[5],Tstatsnorm[6])
Bstatsnorm2<-c(Bstatsnorm[1],Bstatsnorm[2], TargetUe=NA, TargetDe=NA,Bstatsnorm[3],Bstatsnorm[4],Bstatsnorm[5],Bstatsnorm[6])
Sstatsnorm2<-c(Sstatsnorm[1],Sstatsnorm[2], TargetUe=NA, TargetDe=NA,Sstatsnorm[3],Sstatsnorm[4],Sstatsnorm[5],Sstatsnorm[6])

Estatsnorm_mat <- matrix(Estatsnorm, nrow = 8, ncol = 1)
Tstatsnorm_mat <- matrix(Tstatsnorm2, nrow = 8, ncol = 1)
Bstatsnorm_mat <- matrix(Bstatsnorm2, nrow = 8, ncol = 1)
Sstatsnorm_mat <- matrix(Sstatsnorm2, nrow = 8, ncol = 1)

charnorm <- cbind(Estatsnorm_mat, Tstatsnorm_mat, Bstatsnorm_mat, Sstatsnorm_mat)
rownames(charnorm) <- c("Rate", "Volume", "Upper target", "Lower target", 
                     "Percentile_01", "Percentile_25", "Percentile_75", "Percentile_99")
colnames(charnorm) <- c("EFFR", "TGCR", "BGCR",  "SOFR")
xtable_output <- xtable(charnorm, caption="Normalcy 3/04/2016-7/31/2019", caption.placement="top", comment = FALSE)
kable_output <- kable(xtable_output, format = "latex", booktabs = TRUE)
kable_styled <- kable_styling(kable_output, latex_options = "hold_position")
print.results = FALSE
#?
# start_dates <-sdate[begn[k]]
# end_dates <-sdate[endn[k]]
# start_dates_strings <- as.character(start_dates)
# end_dates_strings <- as.character(end_dates)
```
<!--
# Your data and xtable generation
charnorm <- data.frame(Variable = c("Var1", "Var2"), Value = c(0.1, 0.2))  # Example data
xtable_output <- xtable(charnorm, caption = "Normalcy 3/04/2016-7/31/2019", caption.placement = "top", comment = FALSE)

# Convert xtable output to kable and style it
kable_output <- kable(xtable_output, format = "latex", booktabs = TRUE)
kable_styled <- kable_styling(kable_output, latex_options = "hold_position")

# Print the styled table
print(kable_styled)
-->

```{r,EFFR during normalcy period 3/4/2016-7/31/2019, echo=FALSE}
ratecol=2
vol=3
targetup = 3
targetdown = 4
p1=6
p25=7
p75=8
p99=9
normE<-my_envepisodes$norm
maxr<-max(normE[,ncol(normE)])
minr<-min(normE[,ncol(normE)])
```

<!--
sdate position
 str(my_envepisodes$adjust)
'data.frame':	64 obs. of  9 variables:
 $ sdate            : Date, format: "2019-08-01" "2019-08-02" "2019-08-05" "2019-08-06" ...
 $ EFFR             : num  214 214 213 213 212 212 212 212 212 212 ...
 $ VolumeEFFR       : num  81 74 68 65 66 62 69 68 66 60 ...
 $ TargetUe         : num  225 225 225 225 225 225 225 225 225 225 ...
 $ TargetDe         : num  200 200 200 200 200 200 200 200 200 200 ...
 $ Percentile01_EFFR: num  205 208 208 208 208 208 205 207 207 207 ...
 $ Percentile25_EFFR: num  210 210 210 210 210 210 210 210 210 210 ...
 $ Percentile75_EFFR: num  215 215 214 214 213 213 213 213 213 213 ...
 $ Percentile99_EFFR: num  220 218 218 218 218 218 218 218 218 218 ...
 -->


```{r, IQR and range of rates during normalcy period 3/4/2016-7/31/2019,echo=FALSE}
qnormE=quantilesE[bgn:edn,]
qnormT=quantilesT[bgn:edn,] 
qnormB=quantilesB[bgn:edn,] 
qnormS=quantilesS[bgn:edn,] 

Estatsnorm <- colMeans(qnormE[,2:ncol(qnormE)], na.rm = TRUE)
Tstatsnorm <- colMeans(qnormT[,2:ncol(qnormT)], na.rm = TRUE)
Bstatsnorm <- colMeans(qnormB[,2:ncol(qnormB)], na.rm = TRUE)
Sstatsnorm <- colMeans(qnormS[,2:ncol(qnormS)], na.rm = TRUE)
```
 
```{r, IQR and range of rates during mid cycle adustment period 8/1/2019-10/31/2019, echo=FALSE}
qadjE<-my_envepisodes$quantilesE[bgn:edn,]
qadjT<-my_envepisodes$quantilesT[bgn:edn,]
qadjB<-my_envepisodes$quantilesB[bgn:edn,]
qadjS<-my_envepisodes$quantilesS[bgn:edn,]

Estatsadj <- colMeans(qadjE[,2:ncol(qadjE)], na.rm = TRUE)
#Ostatsadj <- colMeans(qadjO[,2:ncol(qadjO)], na.rm = TRUE)
Tstatsadj <- colMeans(qadjT[,2:ncol(qadjT)], na.rm = TRUE)
Bstatsadj <- colMeans(qadjB[,2:ncol(qadjB)], na.rm = TRUE)
Sstatsadj <- colMeans(qadjS[,2:ncol(qadjS)], na.rm = TRUE)

Tstatsadj2<-c(Tstatsadj[1],Tstatsadj[2], TargetUe=NA, TargetDe=NA,Tstatsadj[3],Tstatsadj[4],Tstatsadj[5],Tstatsadj[6])
Bstatsadj2<-c(Bstatsadj[1],Bstatsadj[2], TargetUe=NA, TargetDe=NA,Bstatsadj[3],Bstatsadj[4],Bstatsadj[5],Bstatsadj[6])
Sstatsadj2<-c(Sstatsadj[1],Sstatsadj[2], TargetUe=NA, TargetDe=NA,Sstatsadj[3],Sstatsadj[4],Sstatsadj[5],Sstatsadj[6])
```


```{r , IQR and range of rates during covid period 8/1/2019-10/31/2019, echo=FALSE}
qcovidE<-my_envepisodes$quantilesE[bgn:edn,]
qcovidT<-my_envepisodes$quantilesT[bgn:edn,]
qcovidB<-my_envepisodes$quantilesB[bgn:edn,]
qcovidS<-my_envepisodes$quantilesS[bgn:edn,]

Estatscovid <- colMeans(qcovidE[,2:ncol(qcovidE)], na.rm = TRUE)
#Ostatscovid <- colMeans(qcovidO[,2:ncol(qcovidO)], na.rm = TRUE)
Tstatscovid <- colMeans(qcovidT[,2:ncol(qcovidT)], na.rm = TRUE)
Bstatscovid <- colMeans(qcovidB[,2:ncol(qcovidB)], na.rm = TRUE)
Sstatscovid <- colMeans(qcovidS[,2:ncol(qcovidS)], na.rm = TRUE)

Tstatscovid2<-c(Tstatscovid[1],Tstatscovid[2], TargetUe=NA, TargetDe=NA,Tstatscovid[3],Tstatscovid[4],Tstatscovid[5],Tstatscovid[6])
Bstatscovid2<-c(Bstatscovid[1],Bstatscovid[2], TargetUe=NA, TargetDe=NA,Bstatscovid[3],Bstatscovid[4],Bstatscovid[5],Bstatscovid[6])
Sstatscovid2<-c(Sstatscovid[1],Sstatscovid[2], TargetUe=NA, TargetDe=NA,Sstatscovid[3],Sstatscovid[4],Sstatscovid[5],Sstatscovid[6])
```


```{r, IQR and range of rates during zero lower bound period 3/16/2022,echo=FALSE}
k=4
begn<-c(1,859,923,1014,1519,1)
endn<-c(858,922,1013,1518,1957,1957)
bgn<-begn[k]
edn<-endn[k]
#print(bgn)
#print(edn)
zlb<-rrbp[bgn:edn,]
sdatezlb<-sdate[bgn:edn]

qzlbE=quantilesE[bgn:edn,]
qzlbT=quantilesT[bgn:edn,]
qzlbB=quantilesB[bgn:edn,]
qzlbS=quantilesS[bgn:edn,]

Estatszlb <- colMeans(qzlbE[,2:ncol(qzlbE)], na.rm = TRUE)
#resave qzlbe to env with sdate in position s
#Ostatszlb <- colMeans(qzlbO[,2:ncol(qzlbO)], na.rm = TRUE)
Tstatszlb <- colMeans(qzlbT[,2:ncol(qzlbT)], na.rm = TRUE)
Bstatszlb <- colMeans(qzlbB[,2:ncol(qzlbB)], na.rm = TRUE)
Sstatszlb <- colMeans(qzlbS[,2:ncol(qzlbS)], na.rm = TRUE)
```

```{r, IQR and range of rates during inflation period 03/17/2022-12/14/2023, echo=FALSE}
k=5 
begn<-c(1,859,923,1014,1519,1)
endn<-c(858,922,1013,1518,1957,1957)
bgn<-begn[k]
edn<-endn[k]
inflation<-rrbp[bgn:edn,]
sdateinflation<-sdate[bgn:edn]

qinflationE=quantilesE[bgn:edn,]
qinflationT=quantilesT[bgn:edn,]
qinflationB=quantilesB[bgn:edn,]
qinflationS=quantilesS[bgn:edn,]

Estatsinflation <<- colMeans(qinflationE[,2:ncol(qinflationE)], na.rm = TRUE)
Tstatsinflation <<- colMeans(qinflationT[,2:ncol(qinflationT)], na.rm = TRUE)
Bstatsinflation <<- colMeans(qinflationB[,2:ncol(qinflationB)], na.rm = TRUE)
Sstatsinflation <<- colMeans(qinflationS[,2:ncol(qinflationS)], na.rm = TRUE)
```



```{r Combine episode dataframes, include=FALSE,echo=FALSE}
episodesstats <- my_envepisodes$episodesstats
episodeschar <- my_envepisodes$episodeschar
#\url{https://forum.posit.co/t/you-cant-use-macro-parameter-character-in-vertical-mode/143627/2}
```
<!--
See (\@ref(tab:Comparative statistics of all policy episodes) provides a summary of the data.
-->



<!-- Time series plots
```{r, ratestsnorm, fig.cap="Rates during normalcy period 3/4/2016-7/31/2019", echo=FALSE, warning=FALSE, message=FALSE, fig.pos='H'}-->
```{r ratestsnorm, fig.cap="Rates during normalcy period 3/4/2016-7/31/2019", echo=FALSE, warning=FALSE, message=FALSE,fig.pos='H'}
#, fig.label="ratestsnorm"}
library(ggplot2)
library(reshape2)
#, results='asis' fig.pos='H' out.extra = ''
k <- 1
begn <- c(1, 859, 923, 1014, 1519, 1)
endn <- c(858, 922, 1013, 1518, 1957, 1957)
bgn <- begn[k]
edn <- endn[k]

norm <- rrbp[bgn:edn, ]
maxr <- max(norm[, 2:ncol(norm)]) 
minr <- min(norm[, 2:ncol(norm)])

meltrates_norm <- melt(norm, id="sdate")
ratests_norm <- ggplot(meltrates_norm, aes(x=sdate, y=value, colour=variable, group=variable)) + 
  geom_point(shape=16, size=1) +
  labs(caption="Normalcy 3/04/2016-7/31/2019", x="", y="Basis Points (bp)", color="Rate") +
  scale_y_continuous(breaks=seq(minr, maxr, by=25), limits=c(minr, maxr)) + 
  theme_minimal() + 
  guides(shape=guide_legend(title="Rate"))
ratests_norm
```
\FloatBarrier


```{r, fomcnorm, echo=FALSE, results='asis'}
library(xtable)
fomc <- read.csv('C:/Users/Owner/Documents/Research/OvernightRates/Final data files/FOMCrates_sampleFinal.csv', header = TRUE, sep = ",", dec = ".", stringsAsFactors = FALSE)
#Set column names based on the first row
colnames(fomc) <- names(fomc)
#print(colnames)
fdate<-as.Date(fomc$Date,"%d/%m/%Y")
normtab<-fomc[1:9,]
#xtable_norm <- xtable(normtab, caption="FOMC rate changes Normalcy 3/4/2016 to 7/31/2019", comment = #FALSE)
xtable(normtab, caption="FOMC rate changes Normalcy 3/4/2016 to 7/31/2019",label = "tab:fomcnorm", caption.placement = "bottom",comment = FALSE)
print.results = FALSE
```
\FloatBarrier
(Table \@ref(tab:fomcnorm))
<!--
Rate hikes 2015-2018 Returning to normalcy		
20-Dec-18	25	2.25% to 2.50%
Sept. 27, 2018	25	2.0% to 2.25%
Jun. 14, 2018	25	1.75% to 2.0%
22-Mar-18	25	1.50% to 1.75%
Dec. 14, 2017	25	1.25% to 1.50%
15-Jun-17	25	1.00% to 1.25%
16-Mar-17	25	0.75% to 1.00%
Dec. 15, 2016	25	0.5% to 0.75%
-->


```{r ratestsadjust,fig.cap="Rates during mid cycle adjustment 8/1/2019-10/31/2019", echo=FALSE, warning=FALSE, message=FALSE, fig.pos='H', fig.label="ratestsadjust"}
#The EFFR and the money market rates during the adjustment period 
k=2  
library(ggplot2)
library(reshape2)
begn <- c(1, 859, 923, 1014, 1519, 1)
endn <- c(858, 922, 1013, 1518, 1957, 1957)
bgn<-begn[k]
edn<-endn[k]
adjust<-rrbp[bgn:edn,]
maxr<-max(adjust[,2:ncol(adjust)]) 
minr<-min(adjust[,2:ncol(adjust)])
meltrates_adjust <- melt(adjust,id="sdate")
ratests_adjust <- ggplot(meltrates_adjust,aes(x=sdate,y=value,colour=variable,group=variable)) + 
  geom_point(shape=16,size=1) +
  labs(caption = "Adjustment 8/1/2019-10/31/2019", x = "", y = "Basis Points (bp)", color = "Rate") +
  scale_y_continuous(breaks = seq(minr, maxr, by = 25), limits = c(minr, maxr)) + 
  theme_minimal() + guides(shape = guide_legend(title = "Rate"))
ratests_adjust
#Removed 3 rows containing missing values (`geom_point()`).
```
\FloatBarrier
(Figure \@ref(fig:ratestsadjust)).


```{r, fomcadjust, echo=FALSE, results='asis'}
library(xtable)
adjusttab<-fomc[10:11,]
xtable(adjusttab,caption="Mid cycle adjustment 8/1/2019 to 10/31/2019",label = "tab:fomcadjust", caption.placement = "bottom",comment = FALSE)
print.results = FALSE
```
\FloatBarrier
(Table \@ref(tab:fomcadjust))
<!--
2019 rates cuts mid cycle adjustment		
31-Oct-19	-25	1.50% to 1.75%
Sept. 19, 2019	-25	1.75% to 2.0%
Aug. 1, 2019	-25	2.0% to 2.25%
-->

```{r ratestscovid, fig.cap="Rates during covid 11/1/2019-3/16/2020", echo=FALSE, warning=FALSE, message=FALSE, fig.pos='H', fig.label="ratestscovid"}
library(ggplot2)
library(reshape2)
#(Figure \@ref(fig:ratestscovid))
k=3  
library(ggplot2)
begn <- c(1, 859, 923, 1014, 1519, 1)

endn <- c(858, 922, 1013, 1518, 1957, 1957)
bgn<-begn[k]
edn<-endn[k]
covid<-rrbp[bgn:edn,]
maxr<-525  #max(covid[,2:ncol(covid)]) 
minr<-0 #min(adjust[,2:ncol(covid)])
meltrates_covid <- melt(covid,id="sdate")
ratests_covid <- ggplot(meltrates_covid,aes(x=sdate,y=value,colour=variable,group=variable)) + 
  geom_point(shape=16,size=1) +
  labs(caption = "Covid 11/1/2019-3/16/2020", x = "", y = "Basis Points (bp)", color = "Rate") +
  scale_y_continuous(breaks = seq(minr, maxr, by = 25), limits = c(minr, maxr)) + 
  theme_minimal() + guides(shape = guide_legend(title = "Rate"))
#ratests_covid
#ggsave(filename = "C:/Users/Owner/Documents/Research/OvernightRates/ONRates_simplev10_05262024v7_files/fi#gure-latex/ratestscovid-1.pdf", plot = ratests_covid, device = "pdf")
```


\FloatBarrier


```{r, fomccovid, echo=FALSE, results='asis'}
library(xtable)
covidtab<-fomc[12:13,]
xtable(covidtab, caption="Covid 11/1/2019 to 3/16/2020",label = "tab:fomccovid", caption.placement = "bottom", comment = FALSE)
 print.results = FALSE
```
\FloatBarrier
(Table \@ref(tab:fomccovid))
<!--
2020 Fed Rate Cuts: Coping with Covid-19		
16-Mar-20	-100	0% to 0.25%
3-Mar-20	-50	1.0% to 1.25%
-->



```{r, fomczlb, echo=FALSE, results='asis'}
library(xtable)
#The EFFR and the money market rates during the zero lower bound (Table \@ref(tab:fomczlb))
zlbtab<-fomc[14:22,]
xtable(zlbtab, caption="Zero lower bound 3/17/2020 to 3/16/2022",label = "tab:fomczlb", caption.placement = "bottom",  comment = FALSE)
print.results = FALSE
```
```{r ratestszlb, fig.cap= "Rates during zero lower bound 3/17/2020-3/16/2022",echo=FALSE,warning=FALSE, message=FALSE, fig.pos='H', fig.label="ratestszlb"}
# (see Figure \@ref(fig:Rates during zero lower bound 3/17/2020-3/16/2022)
# (Figure \@ref(fig:ratestszlb)). 
library(ggplot2)
library(reshape2)
k=4 
library(ggplot2)
begn <- c(1, 859, 923, 1014, 1519, 1)
endn <- c(858, 922, 1013, 1518, 1957, 1957)
bgn<-begn[k]
edn<-endn[k]
zlb<-rrbp[bgn:edn,]
maxr<-max(zlb[,2:ncol(zlb)]) 
minr<-min(zlb[,2:ncol(zlb)])
meltrates_zlb <- melt(zlb,id="sdate")
ratests_zlb<- ggplot(meltrates_zlb,aes(x=sdate,y=value,colour=variable,group=variable)) + 
  geom_point(shape=16,size=1) +
  labs(caption = "Zero lower bound 3/17/2020-3/16/2022", x = "", y = "Basis Points (bp)", color = "Rate") +
  scale_y_continuous(breaks = seq(minr, maxr, by = 25), limits = c(minr, maxr)) + 
  theme_minimal() + guides(shape = guide_legend(title = "Rate"))
ratests_zlb
#zlb<-my_envepisodes$zlb
#ggsave(filename = "C:/Users/Owner/Documents/Research/OvernightRates/ONRates_simplev10_05262024v7_files/fi#gure-latex/ratestscovid-1.pdf", plot = ratests_covid, device = "pdf")
```

\FloatBarrier
 
```{r ratestsinflation, fig.cap= "Rates during Taming inflation 3/17/2022-12/14/2023",echo=FALSE,warning=FALSE, message=FALSE, fig.pos='H', fig.label="ratestsinflation"}
#  (see Figure \@ref(fig:Rates during Taming inflation 3/17/2022-12/14/2023)
# The EFFR and the money market rates during the taming of inflation (Table \@ref(tab:fomcinflation))
# (Figure \@ref(fig:ratestsinflation)). 
library(ggplot2)
library(reshape2)
k=5
library(ggplot2)
begn <- c(1, 859, 923, 1014, 1519, 1)
endn <- c(858, 922, 1013, 1518, 1957, 1957)
bgn<-begn[k]
edn<-endn[k]
inflation<-rrbp[bgn:edn,]
maxr<-max(inflation[,2:ncol(inflation)]) 
minr<-min(inflation[,2:ncol(inflation)])
meltrates_inflation <- melt(inflation,id="sdate")
ratests_inflation<- ggplot(meltrates_inflation,aes(x=sdate,y=value,colour=variable,group=variable)) + 
  geom_point(shape=16,size=1) +
  labs(caption = "Inflation 03/17/2022-12/14/2023", x = "", y = "Basis Points (bp)", color = "Rate") +
  scale_y_continuous(breaks = seq(minr, maxr, by = 50
  ), limits = c(minr, maxr)) + 
  theme_minimal() + guides(shape = guide_legend(title = "Rate"))
ratests_inflation
```
\FloatBarrier


```{r, fomcinflation, echo=FALSE, results='asis'}
library(xtable)
inflationtab<-fomc[24:37,]
xtable(inflationtab, caption="Taming inflation 03/17/2022 to 12/14/2023", label = "tab:fomcinflation", caption.placement = "bottom", comment = FALSE)
print.results = FALSE
```
\FloatBarrier

```{r pratests, fig.cap= "Rates during different policy episodes",echo=FALSE,warning=FALSE, message=FALSE, fig.pos='H', fig.label="pratests"}
#  (see Figure \@ref(fig:Rates during different policy episodes)
pratests<-(ratests_norm | ratests_adjust) / (ratests_covid |ratests_zlb) / ratests_inflation
print(pratests)
```
<!--
Fed Rate Hikes 2022-2023: Taming Inflation		
26-Jul-23	25	5.25% to 5.50%
3-May-23	25	5.00% to 5.25%
22-Mar-23	25	4.75% to 5.00%
1-Feb-23	25	4.50% to 4.75%
14-Dec-22	50	4.25% to 4.50%
2-Nov-22	75	3.75% to 4.00%
21-Sep-22	75	3.00% to 3.25%
27-Jul-22	75	2.25% to 2.50%
16-Jun-22	75	1.50% to 1.75%
5-May-22	50	0.75% to 1.00%
17-Mar-22	25	0.25% to 0.50%
-->

<!--
These are the percentile plots to be replaced by IQR ribbon plots
-->
## The FFR and its target range
```{r ratesnorm, fig.cap="EFFR during normalcy period 3/4/2016-7/31/2019", echo=FALSE, warning=FALSE, message=FALSE, fig.pos='H',fig.label="ratesnorm"}
library(ggplot2)
library(reshape2)
normE<-my_envepisodes$norm
sdate <- normE[, 1]
data_without_sdate <- normE[, -1]
maxr<-max(normE[,ncol(normE)]) 
minr<-min(normE[,ncol(normE)])

meltrates_norm <- melt(data.frame(sdate, data_without_sdate), id.vars = "sdate")
rates_norm <- ggplot(meltrates_norm, aes(x = sdate, y = value, colour = variable, group = variable)) + 
  geom_line() +
  labs( caption = "Normalcy 3/4/2016-7/31/2019", x = "", y = "rates basis points (bp) volume (billion dollars)", color = "Rate") +  
  scale_y_continuous(breaks = seq(0, maxr, by = 25), limits = c(0,maxr)) + 
  theme_minimal()
rates_norm
```
\FloatBarrier

\emph{The normalcy period} (Figure \@ref(fig:ratesnorm)).
The EFFR, median and IQR values are within the FOMC target ranges (the step function for the lower and upper target rates, TargetDe, and TargetUe).
                  
```{r normbox, fig.cap="IQR and range during normalcy period 3/4/2016-7/31/2019", echo=FALSE, warning=FALSE, message=FALSE,fig.pos='H', fig.label="normbox"}
library(ggplot2)
library(reshape2)
qnormE=quantilesE[bgn:edn,] 
qnormT=quantilesT[bgn:edn,] 
qnormB=quantilesB[bgn:edn,] 
qnormS=quantilesS[bgn:edn,] 

Estatsnorm <- colMeans(qnormE[,2:ncol(qnormE)], na.rm = TRUE)
Tstatsnorm <- colMeans(qnormT[,2:ncol(qnormT)], na.rm = TRUE)
Bstatsnorm <- colMeans(qnormB[,2:ncol(qnormB)], na.rm = TRUE)
Sstatsnorm <- colMeans(qnormS[,2:ncol(qnormS)], na.rm = TRUE)

boxplot_normalcy <- data.frame(
  Group = structure(1:4, .Label = c("EFFR", "TGCR", "BGCR", "SOFR"), class = "factor"),
  y0 = c(Estatsnorm[5], Tstatsnorm[3], Bstatsnorm[3], Sstatsnorm[3]),
  y25 = c(Estatsnorm[6], Tstatsnorm[4], Bstatsnorm[4], Sstatsnorm[4]),
  y50 = c(Estatsnorm[1], Tstatsnorm[1], Bstatsnorm[1], Sstatsnorm[1]),
  y75 = c(Estatsnorm[7], Tstatsnorm[5], Bstatsnorm[5], Sstatsnorm[5]),
  y100 = c(Estatsnorm[8], Tstatsnorm[6], Bstatsnorm[6], Sstatsnorm[6])
)

bnormalcy <- ggplot(boxplot_normalcy, aes(x = Group,
                                          ymin = y0,
                                          ymax = y100,
                                          lower = y25,
                                          middle = y50,
                                          upper = y75,
                                          fill = Group)) +
  labs(caption = "Normalcy 3/4/2016-7/31/2019", x = "", y = "Basis Points (bp)", color = "Rate", shape = "Rate") +  
  geom_boxplot(stat = "identity") +
  theme(panel.background = element_rect(fill = "white"),
        plot.background = element_rect(fill = "white"),
        axis.title.x = element_blank())  # Remove x-axis label
bnormalcy
```
\FloatBarrier
<!-- The episode percentile plots -->
The IQR and range during the normalcy period are shown in (Figure \@ref(fig:normbox)).

```{r, normchar,echo=FALSE,results='asis',warning=FALSE, message=FALSE}
library(xtable)
k=1 
begn <- c(1, 859, 923, 1014, 1519, 1) 
endn <- c(858, 922, 1013, 1518, 1957, 1957) 
bgn<-begn[k] 
edn<-endn[k] 
norm<-rrbp[bgn:edn,] 
sdatenorm<-sdate[bgn:edn]

qnormE=quantilesE[bgn:edn,]
qnormT=quantilesT[bgn:edn,]
qnormB=quantilesB[bgn:edn,] 
qnormS=quantilesS[bgn:edn,] 

my_envepisodes$sdatenorm <-sdatenorm
my_envepisodes$normE <-qnormE
my_envepisodes$normT <-qnormT
my_envepisodes$normB <-qnormB
my_envepisodes$normS <-qnormS

Estatsnorm <- colMeans(qnormE[,2:ncol(qnormE)], na.rm = TRUE)
Tstatsnorm <- colMeans(qnormT[,2:ncol(qnormT)], na.rm = TRUE)
Bstatsnorm <- colMeans(qnormB[,2:ncol(qnormB)], na.rm = TRUE)
Sstatsnorm <- colMeans(qnormS[,2:ncol(qnormS)], na.rm = TRUE)

Tstatsnorm2<-c(Tstatsnorm[1],Tstatsnorm[2], TargetUe=NA, TargetDe=NA,Tstatsnorm[3],Tstatsnorm[4],Tstatsnorm[5],Tstatsnorm[6])
Bstatsnorm2<-c(Bstatsnorm[1],Bstatsnorm[2], TargetUe=NA, TargetDe=NA,Bstatsnorm[3],Bstatsnorm[4],Bstatsnorm[5],Bstatsnorm[6])
Sstatsnorm2<-c(Sstatsnorm[1],Sstatsnorm[2], TargetUe=NA, TargetDe=NA,Sstatsnorm[3],Sstatsnorm[4],Sstatsnorm[5],Sstatsnorm[6])

Estatsnorm_mat <- matrix(Estatsnorm, nrow = 8, ncol = 1)
Tstatsnorm_mat <- matrix(Tstatsnorm2, nrow = 8, ncol = 1)
Bstatsnorm_mat <- matrix(Bstatsnorm2, nrow = 8, ncol = 1)
Sstatsnorm_mat <- matrix(Sstatsnorm2, nrow = 8, ncol = 1)

charnorm <- cbind(Estatsnorm_mat, Tstatsnorm_mat, Bstatsnorm_mat, Sstatsnorm_mat)
rownames(charnorm) <- c("Rate", "Volume", "Upper target", "Lower target", 
                     "Percentile_01", "Percentile_25", "Percentile_75", "Percentile_99")
colnames(charnorm) <- c("EFFR", "TGCR", "BGCR",  "SOFR")
#xtable_output <- 
xtable(charnorm, caption="Normalcy 3/04/2016-7/31/2019", label = "tab:normchar", caption.placement = "bottom", comment = FALSE) 
#kable_output <- kable(xtable_output, format = "latex", booktabs = TRUE)
#kable_styled <- kable_styling(kable_output, latex_options = "hold_position")
print.results = FALSE
```
\FloatBarrier


The rate characteristics the normalcy period are shown in 
(Table \@ref(tab:normchar)).

```{r,normstatistics, echo=FALSE, results='asis',warning=FALSE, message=FALSE}
begn <- c(1, 859, 923, 1014, 1519, 1)
endn <- c(858, 922, 1013, 1518, 1957, 1957)
library(xtable)
k <- 1 
bgn <- begn[k]
edn <- endn[k]
norm <- rrbp[bgn:edn,]  # All
sdatenorm <- sdate[bgn:edn]

qnormE <- quantilesE[bgn:edn,] 
qnormT <- quantilesT[bgn:edn,]
qnormB <- quantilesB[bgn:edn,] 
qnormS <- quantilesS[bgn:edn,] 

my_envepisodes$sdatenorm <- sdatenorm
my_envepisodes$normE <- qnormE
my_envepisodes$normT <- qnormT
my_envepisodes$normB <- qnormB
my_envepisodes$normS <- qnormS

Estatsnorm <<- colMeans(qnormE[,2:ncol(qnormE)], na.rm = TRUE)
Tstatsnorm <<- colMeans(qnormT[,2:ncol(qnormT)], na.rm = TRUE)
Bstatsnorm <<- colMeans(qnormB[,2:ncol(qnormB)], na.rm = TRUE)
Sstatsnorm <<- colMeans(qnormS[,2:ncol(qnormS)], na.rm = TRUE)

categories <- c("EFFR", "TGCR", "BGCR", "SOFR")
median_values <- c(Estatsnorm[1], Tstatsnorm[1], Bstatsnorm[1], Sstatsnorm[1])
iqr_values <- c(Estatsnorm[7] - Estatsnorm[6], Tstatsnorm[5] - Tstatsnorm[4], Bstatsnorm[5] - Bstatsnorm[4], Sstatsnorm[5] - Sstatsnorm[4])
range_values <- c(Estatsnorm[8] - Estatsnorm[5], Tstatsnorm[6] - Tstatsnorm[3], Bstatsnorm[6] - Bstatsnorm[3], Sstatsnorm[6] - Sstatsnorm[3])
volume_values <- c(Estatsnorm[2], Tstatsnorm[2], Bstatsnorm[2], Sstatsnorm[2])
normstats <<- data.frame(Category = categories, Median = median_values, IQR = iqr_values, RANGE = range_values, VOLUME = volume_values)
row.names(normstats) <- NULL
#xtable_output<-
xtable(normstats, caption="Normalcy 3/04/2016-7/31/2019", label = "tab:normstatistics", caption.placement = "bottom",comment = FALSE)
#kable_output <- kable(xtable_output, format = "latex", booktabs = TRUE)
#kable_styled <- kable_styling(kable_output, latex_options = "hold_position")
print.results = FALSE
```
\FloatBarrier
The rate statistics the normalcy period are shown in 
(Table \@ref(tab:normstatistics)).

\emph{The adjustment period}
The outliers from the spike in repo rates September 2019 is the only time the FFR was not within the FOMC target range

```{r,  EFFR during adjustment period 8/1/2019-10/31/2019, echo=FALSE,results='asis'}
rates=2
vol=3
targetup = 4
targetdown = 5
p1=6
p25=7
p75=8
p99=9
adjust<-rrbp[bgn:edn,]
max(adjust[,2:ncol(adjust)]) 
min(adjust[,2:ncol(adjust)])
qadjE<-my_envepisodes$adjust
maxr<-max(qadjE[,rates]) 
minr<-min(qadjE[,rates])
```

```{r ratesadjust, fig.cap= "EFFR during adjustment period 8/1/2019-10/31/2019", eval=TRUE, echo=FALSE,fig.num=TRUE,warning=FALSE, message=FALSE, fig.pos='H', fig.label="ratesadjust"}
#(see Figure \@ref(fig:EFFR during adjustment period 8/1/2019-10/31/2019)
library(ggplot2)                        
library(reshape2)
qadjE<-my_envepisodes$adjust # Using the same data as the first plot
sdate <- as.Date(qadjE[, 1])
data_without_sdate<- qadjE[, -1]
rates=2
adjust<-rrbp[bgn:edn,]
maxr<-max(adjust[,2:ncol(adjust)]) 
minr<-min(adjust[,2:ncol(adjust)])
maxr<-max(qadjE[,2]) 
minr<-min(qadjE[,2]) 

meltrates_adjust <- melt(data.frame(sdate, data_without_sdate), id.vars = "sdate")
meltrates_adjust$variable <- as.factor(meltrates_adjust$variable)
meltrates_adjust$value <- as.numeric(meltrates_adjust$value)
rates_adjust <<- ggplot(meltrates_adjust, aes(x = sdate, y=value, colour=variable, group=variable)) +
  geom_line() +
  labs(caption= "Adjustment  8/1/2019-10/31/2019",x = "", y = "rates basis points (bp) volume (billion dollars)", color = "Rate") +  
  scale_y_continuous(breaks = seq(minr, maxr, by = 25), limits = c(minr, maxr)) + 
  scale_x_date(date_labels = "%Y-%m-%d", date_breaks = "1 month") +  #Specify date format and breaks
  theme_minimal()
rates_adjust
#my_envepisodes$rates_adjust<-rates_adjust
```
\FloatBarrier
(Figure \@ref(fig:ratesadjust)).


```{r adjustbox, fig.cap= "IQR and range of rates during mid cycle adustment period 8/1/2019-10/31/2019",echo=FALSE,fig.pos='H',fig.label="adjustbox"}
#(Figure \@ref(fig:EFFR Key percentiles during mid cycle adjustment period 8/1/2019-10/31/2019)
 library(ggplot2)
library(reshape2)
 boxplot_adjust<- data.frame(
    Group = structure(1:4, .Label = c("EFFR", "TGCR", "BGCR", "SOFR"), class = "factor"),
    y0 = c(Estatsadj[5], Tstatsadj[3], Bstatsadj[3], Sstatsadj[3]),
    y25 = c(Estatsadj[6], Tstatsadj[4], Bstatsadj[4], Sstatsadj[4]),
    y50 = c(Estatsadj[1], Tstatsadj[1] , Bstatsadj[1] , Sstatsadj[1]) ,
    y75 = c(Estatsadj[7], Tstatsadj[5], Bstatsadj[5], Sstatsadj[5]),
    y100 = c(Estatsadj[8], Tstatsadj[6], Bstatsadj[6], Sstatsadj[6]))
  
  badjust<<-ggplot(boxplot_adjust , aes(x=Group,
                                           ymin = y0,
                                           ymax = y100,
                                           lower = y25,
                                           middle = y50,
                                           upper = y75,
                                           fill = Group)) +
    labs(caption = "Mid cycle adjustment 8/1/2019-10/31/2019", x="",  y = "Basis Points (bp)", color = "Rate", shape = "Rate") +  
    geom_boxplot(stat = "identity") +  
  theme(panel.background = element_rect(fill = "white"),
        plot.background = element_rect(fill = "white"),
        axis.title.x = element_blank())  # Remove x-axis label)
  badjust
my_environmentbox$adjust <- badjust
```
\FloatBarrier
(Figure \@ref(fig:adjustbox)).



The rate characteristics the adjustment period are shown in 
```{r, adjustchar, echo=FALSE,results='asis',warning=FALSE, message=FALSE}
library(xtable)
k=2  
begn <- c(1, 859, 923, 1014, 1519, 1)
endn <- c(858, 922, 1013, 1518, 1957, 1957)
bgn<-begn[k]
edn<-endn[k]
adjust<-rrbp[bgn:edn,]
sdateadj<-sdate[bgn:edn]

qadjE=quantilesE[bgn:edn,]
qadjT=quantilesT[bgn:edn,]
qadjB=quantilesB[bgn:edn,]
qadjS=quantilesS[bgn:edn,]

my_envepisodes$sdateadj <-sdateadj
my_envepisodes$adjE <-qadjE
my_envepisodes$adjT <-qadjT
my_envepisodes$adjB <-qadjB
my_envepisodes$adjS <-qadjS

Estatsadj <<- colMeans(qadjE[,2:ncol(qadjE)], na.rm = TRUE)
Tstatsadj <<- colMeans(qadjT[,2:ncol(qadjT)], na.rm = TRUE)
Bstatsadj <<- colMeans(qadjB[,2:ncol(qadjB)], na.rm = TRUE)
Sstatsadj <<- colMeans(qadjS[,2:ncol(qadjS)], na.rm = TRUE)


Tstatsadj2<<-c(Tstatsadj[1],Tstatsadj[2], TargetUe=NA, TargetDe=NA,Tstatsadj[3],Tstatsadj[4],Tstatsadj[5],Tstatsadj[6])
Bstatsadj2<<-c(Bstatsadj[1],Bstatsadj[2], TargetUe=NA, TargetDe=NA,Bstatsadj[3],Bstatsadj[4],Bstatsadj[5],Bstatsadj[6])
Sstatsadj2<<-c(Sstatsadj[1],Sstatsadj[2], TargetUe=NA, TargetDe=NA,Sstatsadj[3],Sstatsadj[4],Sstatsadj[5],Sstatsadj[6])

Estatsadj_mat <- matrix(Estatsadj, nrow = 8, ncol = 1)
Tstatsadj_mat <- matrix(Tstatsadj2, nrow = 8, ncol = 1)
Bstatsadj_mat <- matrix(Bstatsadj2, nrow = 8, ncol = 1)
Sstatsadj_mat <- matrix(Sstatsadj2, nrow = 8, ncol = 1)

charadj <- cbind(Estatsadj_mat, Tstatsadj_mat, Bstatsadj_mat, Sstatsadj_mat)
rownames(charadj) <- c("Rate", "Volume", "Upper target", "Lower target", 
                     "Percentile_01", "Percentile_25", "Percentile_75", "Percentile_99")

colnames(charadj) <- c("EFFR", "TGCR", "BGCR",  "SOFR")
xtable(charadj,caption="Adjustment 8/1/2019-10/31/2019",label="tab:adjustchar", caption.placement="bottom", comment = FALSE)
print.results = FALSE
```
\FloatBarrier
(Table \@ref(tab:adjustchar)).



```{r, adjuststatistics, echo=FALSE,results='asis',warning=FALSE, message=FALSE}
library(xtable)
k=2  
begn <- c(1, 859, 923, 1014, 1519, 1)
endn <- c(858, 922, 1013, 1518, 1957, 1957)
bgn<-begn[k]
edn<-endn[k]
adjust<-rrbp[bgn:edn,]
sdateadj<-sdate[bgn:edn]

qadjE=quantilesE[bgn:edn,]
qadjT=quantilesT[bgn:edn,]
qadjB=quantilesB[bgn:edn,]
qadjS=quantilesS[bgn:edn,]

my_envepisodes$sdateadj <-sdateadj
my_envepisodes$adjE <-qadjE
my_envepisodes$adjT <-qadjT
my_envepisodes$adjB <-qadjB
my_envepisodes$adjS <-qadjS

Estatsadj <<- colMeans(qadjE[,2:ncol(qadjE)], na.rm = TRUE)
Tstatsadj <<- colMeans(qadjT[,2:ncol(qadjT)], na.rm = TRUE)
Bstatsadj <<- colMeans(qadjB[,2:ncol(qadjB)], na.rm = TRUE)
Sstatsadj <<- colMeans(qadjS[,2:ncol(qadjS)], na.rm = TRUE)

Tstatsadj2<<-c(Tstatsadj[1],Tstatsadj[2], TargetUe=NA, TargetDe=NA,Tstatsadj[3],Tstatsadj[4],Tstatsadj[5],Tstatsadj[6])
Bstatsadj2<<-c(Bstatsadj[1],Bstatsadj[2], TargetUe=NA, TargetDe=NA,Bstatsadj[3],Bstatsadj[4],Bstatsadj[5],Bstatsadj[6])
Sstatsadj2<<-c(Sstatsadj[1],Sstatsadj[2], TargetUe=NA, TargetDe=NA,Sstatsadj[3],Sstatsadj[4],Sstatsadj[5],Sstatsadj[6])

Estatsadj_mat <- matrix(Estatsadj, nrow = 8, ncol = 1)
Tstatsadj_mat <- matrix(Tstatsadj2, nrow = 8, ncol = 1)
Bstatsadj_mat <- matrix(Bstatsadj2, nrow = 8, ncol = 1)
Sstatsadj_mat <- matrix(Sstatsadj2, nrow = 8, ncol = 1)

categories <- c("EFFR", "TGCR", "BGCR", "SOFR")
median_values <- c(mean(Estatsadj), mean(Tstatsadj), mean(Bstatsadj), mean(Sstatsadj))
iqr_values <- c(IQR(Estatsadj), IQR(Tstatsadj), IQR(Bstatsadj), IQR(Sstatsadj))
range_values <- c(max(Estatsadj) - min(Estatsadj), max(Tstatsadj) - min(Tstatsadj), max(Bstatsadj) - min(Bstatsadj), max(Sstatsadj) - min(Sstatsadj))
volume_values <- c(sum(Estatsadj), sum(Tstatsadj), sum(Bstatsadj), sum(Sstatsadj))

adjstats <<- data.frame(Category = categories, Median = median_values, IQR = iqr_values, RANGE = range_values, VOLUME = volume_values)
#row.names(adjstats) <- categories
row.names(adjstats) <- NULL
xtable(adjstats, include.rownames = FALSE,caption="Adjustment 8/1/2019-10/31/2019",label="tab:adjuststatistics", caption.placement="bottom", comment = FALSE)
print.results = FALSE
```
\FloatBarrier
The rate statistics the adjustment period are shown in 
(Table \@ref(tab:adjuststatistics)).


\emph{The pandemic}  
The outliers from the March 20, 2020 dash for cash are outside the FOMC target rate 
<!--
Is this a model text format?
\emph{Funding rates cluster around the FFR}
  The average weighted median for the EFFR during the zero lower bound is 8 basis points (pb). The average weighted medians of other money market rates cluster around the median EFFR - TGCR,BGCR and SOFR? 4,6 bp. Daily transaction volume in SOFR (billions of dollars ) is around 754 billion. The money market volumes in TGCR and BGCR around 353-376 billion.  Daily trade volume in EFFR is a low 69 billion.  The percentiles of rates reflect the same clustering around the EFFR and SOFR as do their medians.
-->

```{r, EFFR during covid period 11/1/2019-3/16/2020, echo=FALSE}
rates=2
vol=3
targetup = 3
targetdown = 4
p1=6
p1=7
p1=8
p1=9
qcovidE<-my_envepisodes$covid
maxr<-max(covid[,2:ncol(covid)]) 
minr<-min(covid[,2:ncol(covid)])  
```

```{r ratescovid, fig.cap= "EFFR during covid period 11/1/2019-3/16/2020",echo=FALSE, fig.pos='H', fig.label="ratescovid"}
#warning=FALSE, message=FALSE, 
#(see Figure \@ref(fig:EFFR during covid period 11/1/2019-3/16/2020)
library(ggplot2)
library(reshape2)
rates=2
qcovidE<-my_envepisodes$covid # Using the same data as the first plot
data_without_sdate<- qcovidE[, -1]
sdate <- as.Date(qcovidE[, 1])
maxr<-max(qcovidE[,2:ncol(qcovidE)]) 
minr<-min(qcovidE[,2:ncol(qcovidE)])  

meltrates_covid <- melt(data.frame(sdate, data_without_sdate), id.vars = "sdate")
meltrates_covid$variable <- as.factor(meltrates_covid$variable)
meltrates_covid$value <- as.numeric(meltrates_covid$value)
rates_covid <- ggplot(meltrates_covid, aes(x = sdate, y = value, colour = variable, group = variable)) +
  geom_line() +
  labs(caption="Covid 11/1/2019-3/16/2020",x = "", y = "rates basis points (bp) volume (billion dollars)", color = "Rate") +  
  scale_y_continuous(breaks = seq(0, maxr, by = 25), limits = c(0, maxr)) + 
  scale_x_date(date_labels = "%Y-%m-%d", date_breaks = "1 month") +  
  theme_minimal()
rates_covid
#my_envepisodes$rates_covid<-rates_covid
```
\FloatBarrier
(Figure \@ref(fig:ratescovid)).

```{r covidbox, fig.cap= "IQR and range of rates during covid period 11/1/2019-3/16/2020", echo=FALSE, fig.pos='H', fig.label="covidbox"}
#(Figure \@ref(fig:EFFR Key percentiles during.label="covidbox"}
library(ggplot2)
library(reshape2)
 boxplot_covid <- data.frame(
    Group = structure(1:4, .Label = c("EFFR", "TGCR", "BGCR", "SOFR"), class = "factor"),
    y0 = c(Estatscovid[5], Tstatscovid[3], Bstatscovid[3], Sstatscovid[3]),
    y25 = c(Estatscovid[6], Tstatscovid[4], Bstatscovid[4], Sstatscovid[4]),
    y50 = c(Estatscovid[1], Tstatscovid[1] , Bstatscovid[1] , Sstatscovid[1]) ,
    y75 = c(Estatscovid[7], Tstatscovid[5], Bstatscovid[5], Sstatscovid[5]),
    y100 = c(Estatscovid[8], Tstatscovid[6], Bstatscovid[6], Sstatscovid[6]))
                            
  bcovid<<-ggplot(boxplot_covid, aes(x=Group,
                                           ymin = y0,
                                           ymax = y100,
                                           lower = y25,
                                           middle = y50,
                                           upper = y75,
                                           fill = Group)) +
    labs(caption = "Covid 11/1/2019-3/16/2020", x="",  y = "Basis Points (bp)", color = "Rate", shape = "Rate") +  
    geom_boxplot(stat = "identity") +  
  theme(panel.background = element_rect(fill = "white"),
        plot.background = element_rect(fill = "white"),
        axis.title.x = element_blank())  # Remove x-axis label)
  bcovid
  my_environmentbox$covid <-  bcovid 
```
\FloatBarrier
(Figure \@ref(fig:covidbox)).


The rate characteristics during covid  are shown in 

```{r,covidchar, echo=FALSE,results='asis',warning=FALSE, message=FALSE} 
library(xtable)
k=3  
begn<-c(1,859,923,1014,1519,1)
endn<-c(858,922,1013,1518,1957,1957)
bgn<-begn[k]
edn<-endn[k]
covid<-rrbp[bgn:edn,]
sdatecovid<-sdate[bgn:edn]

qcovidE=quantilesE[bgn:edn,]
qcovidT=quantilesT[bgn:edn,]
qcovidB=quantilesB[bgn:edn,]
qcovidS=quantilesS[bgn:edn,]

my_envepisodes$sdatecovid <-sdatecovid
my_envepisodes$covidE <-qcovidE
my_envepisodes$covidT <-qcovidT
my_envepisodes$covidB <-qcovidB
my_envepisodes$covidS <-qcovidS

covidE<- qcovidE
covidT<- qcovidT
covidB<- qcovidB
covidS<- qcovidS

Estatscovid <<- colMeans(covidE[,2:ncol(qcovidE)], na.rm = TRUE)
Tstatscovid <<- colMeans(covidT[,2:ncol(qcovidT)], na.rm = TRUE)
Bstatscovid <<- colMeans(covidB[,2:ncol(qcovidB)], na.rm = TRUE)
Sstatscovid <<- colMeans(covidS[,2:ncol(qcovidS)], na.rm = TRUE)

Estatscovid2<<-c(Estatscovid[1],Estatscovid[2], TargetUe=NA, TargetDe=NA,Estatscovid[3],Estatscovid[4],Estatscovid[5],Estatscovid[6])
Tstatscovid2<<-c(Tstatscovid[1],Tstatscovid[2], TargetUe=NA, TargetDe=NA,Tstatscovid[3],Tstatscovid[4],Tstatscovid[5],Tstatscovid[6])
Bstatscovid2<<-c(Bstatscovid[1],Bstatscovid[2], TargetUe=NA, TargetDe=NA,Bstatscovid[3],Bstatscovid[4],Bstatscovid[5],Bstatscovid[6])
Sstatscovid2<-c(Sstatscovid[1],Sstatscovid[2], TargetUe=NA, TargetDe=NA,Sstatscovid[3],Sstatscovid[4],Sstatscovid[5],Sstatscovid[6])

Estatscovid_mat <- matrix(Estatscovid, nrow = 8, ncol = 1)
Tstatscovid_mat <- matrix(Tstatscovid2, nrow = 8, ncol = 1)
Bstatscovid_mat <- matrix(Bstatscovid2, nrow = 8, ncol = 1)
Sstatscovid_mat <- matrix(Sstatscovid2, nrow = 8, ncol = 1)

charcovid <- cbind(Estatscovid_mat, Tstatscovid_mat, Bstatscovid_mat, Sstatscovid_mat)
rownames(charcovid) <- c("Rate", "Volume", "Upper target", "Lower target", 
                     "Percentile_01", "Percentile_25", "Percentile_75", "Percentile_99")

colnames(charcovid) <- c("EFFR", "TGCR", "BGCR",  "SOFR")
xtable(charcovid, caption="Covid 03/17/2022-12/14/2023", label="tab:covidchar",caption.placement="bottom", comment = FALSE)
print.results = FALSE
```
\FloatBarrier
(Table \@ref(tab:covidchar)).

The rate statistics during covid are shown in 

```{r, covidstatistics, echo=FALSE,results='asis',warning=FALSE, message=FALSE}
library(xtable)
categories <- c("EFFR", "TGCR", "BGCR", "SOFR")
median_values = c(Estatscovid[1], Tstatscovid[1], Bstatscovid[1], Sstatscovid[1])
iqr_values = c(Estatscovid[7] - Estatscovid[6], Tstatscovid[5] - Tstatscovid[4], Bstatscovid[5] - Bstatscovid[4], Sstatscovid[5] - Sstatscovid[4])
range_values = c(Estatscovid[8] - Estatscovid[5], Tstatscovid[6] - Tstatscovid[3], Bstatscovid[6] - Bstatscovid[3], Sstatscovid[6] - Sstatscovid[3])
volume_values = c(Estatscovid[2], Tstatscovid[2], Bstatscovid[2], Sstatscovid[2])
covidstats <<- data.frame(Category = categories, Median = median_values, IQR = iqr_values, RANGE=range_values, VOLUME = volume_values)

covidstats <- data.frame(Category = categories, Median = median_values, IQR = iqr_values, RANGE = range_values, VOLUME = volume_values)
#row.names(covidstats) <- categories
row.names(covidstats) <- NULL
xtable(covidstats, include.rownames = FALSE, caption="Covid 03/17/2022-12/14/2023", label="tab:covidstatistics",caption.placement="bottom",comment = FALSE)
print.results = FALSE
```
\FloatBarrier
(Table \@ref(tab:covidstatistics)).


\emph{The zero lower bound} 

```{r, EFFR during zero lower bound (zlb) period 3/17/2020-3/16/2022, echo=FALSE}
rates=2
vol=3
targetup = 3
targetdown = 4
p1=6
p25=7
p75=8
p99=9
zlbE<-my_envepisodes$zlb
maxr<-max(zlbE[,rates]) #25
minr<-min(zlbE[,rates]) # 4
```

```{r rateszlb,fig.cap= "EFFR during zero lower bound (zlb) period 3/17/2020-3/16/2022", echo=FALSE,warning=FALSE, message=FALSE, fig.pos='H', fig.label="rateszlb"}
library(ggplot2)
library(reshape2)
qzlbE<-my_envepisodes$zlb
sdate <- qzlbE[, 1]
rates=2
data_without_sdate <- qzlbE[, -1]
maxr<-max(qzlbE[,rates]) 
minr<-0 

meltrates_zlb<- melt(data.frame(sdate, data_without_sdate), id.vars = "sdate")
rates_zlb <- ggplot(meltrates_zlb,aes(x=sdate,y=value,colour=variable,group=variable)) + 
  geom_line() +
  labs(caption="Zero lower bound 3/17/2020-3/16/2022",x="", y = "rates basis points (bp) volume (billion dollars)", color="Rate") +  
  scale_y_continuous(breaks = seq(0,maxr, by = 5), limits = c(0,maxr)) + 
  scale_x_date(date_labels = "%Y-%m-%d", date_breaks = "3 months") + 
  theme_minimal()
rates_zlb
#my_envepisodes$rates_zlb<-rates_zlb
```
\FloatBarrier
(Figure \@ref(fig:rateszlb)) 


```{r zlbbox, fig.cap= "IQR and range of rates during zero lower bond period  3/17/2020-3/16/2022",echo=FALSE,fig.pos='H',fig.label="zlbbox"}
library(ggplot2)
library(reshape2)
boxplot_zlb <- data.frame(
    Group = structure(1:4, .Label = c("EFFR", "TGCR", "BGCR", "SOFR"), class = "factor"),
    y0 = c(Estatszlb[5], Tstatszlb[3], Bstatszlb[3], Sstatszlb[3]),
    y25 = c(Estatszlb[6], Tstatszlb[4], Bstatszlb[4], Sstatszlb[4]),
    y50 = c(Estatszlb[1], Tstatszlb[1] , Bstatszlb[1] , Sstatszlb[1]) ,
    y75 = c(Estatszlb[7], Tstatszlb[5], Bstatszlb[5], Sstatszlb[5]),
    y100 = c(Estatszlb[8], Tstatszlb[6], Bstatszlb[6], Sstatszlb[6]))
  
  bzlb<<-ggplot(boxplot_zlb , aes(x=Group,
                                           ymin = y0,
                                           ymax = y100,
                                           lower = y25,
                                           middle = y50,
                                           upper = y75,
                                           fill = Group)) +
    labs(caption = "Zero lower bound  3/17/2020-3/16/2022", x="",  y = "Basis Points (bp)", color = "Rate", shape = "Rate") +  
    geom_boxplot(stat = "identity") +
  theme(panel.background = element_rect(fill = "white"),
        plot.background = element_rect(fill = "white"),
        axis.title.x = element_blank())  # Remove x-axis label)
  print(bzlb)
  my_environmentbox$zlb <-  bzlb 
```
\FloatBarrier
and (Figure \@ref(fig:zlbbox)).

```{r,zlbchar, echo=FALSE,results='asis',warning=FALSE, message=FALSE} 
library(xtable)
k=4  
begn<-c(1,859,923,1014,1519,1)
endn<-c(858,922,1013,1518,1957,1957)
bgn<-begn[k]
edn<-endn[k]
zlb<-rrbp[bgn:edn,]
sdatezlb<-sdate[bgn:edn]

qzlbE=quantilesE[bgn:edn,]
qzlbT=quantilesT[bgn:edn,]
qzlbB=quantilesB[bgn:edn,]
qzlbS=quantilesS[bgn:edn,]


# Store your data frame in the environment
my_envepisodes$sdatezlb <-sdatezlb
my_envepisodes$zlbE <-qzlbE
my_envepisodes$zlbT <-qzlbT
my_envepisodes$zlbB <-qzlbB
my_envepisodes$zlbS <-qzlbS

#Estatszlb <<- colMeans(qzlbE[,1:ncol(qzlbE)-1], na.rm = TRUE)
Estatszlb <<- colMeans(qzlbE[,2:ncol(qzlbE)], na.rm = TRUE)
Tstatszlb <<- colMeans(qzlbT[,2:ncol(qzlbT)], na.rm = TRUE)
Bstatszlb <<- colMeans(qzlbB[,2:ncol(qzlbB)], na.rm = TRUE)
Sstatszlb <<- colMeans(qzlbS[,2:ncol(qzlbS)], na.rm = TRUE)

Tstatszlb2<<-c(Tstatszlb[1],Tstatszlb[2], TargetUe=NA, TargetDe=NA,Tstatszlb[3],Tstatszlb[4],Tstatszlb[5],Tstatszlb[6])
Bstatszlb2<<-c(Bstatszlb[1],Bstatszlb[2], TargetUe=NA, TargetDe=NA,Bstatszlb[3],Bstatszlb[4],Bstatszlb[5],Bstatszlb[6])
Sstatszlb2<<-c(Sstatszlb[1],Sstatszlb[2], TargetUe=NA, TargetDe=NA,Sstatszlb[3],Sstatszlb[4],Sstatszlb[5],Sstatszlb[6])

Estatszlb_mat <- matrix(Estatszlb, nrow = 8, ncol = 1)
Tstatszlb_mat <- matrix(Tstatszlb2, nrow = 8, ncol = 1)
Bstatszlb_mat <- matrix(Bstatszlb2, nrow = 8, ncol = 1)
Sstatszlb_mat <- matrix(Sstatszlb2, nrow = 8, ncol = 1)

charzlb <- cbind(Estatszlb_mat, Tstatszlb_mat, Bstatszlb_mat, Sstatszlb_mat)

rownames(charzlb) <- c("Rate", "Volume", "Upper target", "Lower target", 
                     "Percentile_01", "Percentile_25", "Percentile_75", "Percentile_99")

colnames(charzlb) <- c("EFFR", "TGCR", "BGCR",  "SOFR")
xtable(charzlb,caption="Zero lower bound 03/17/2020-03/16/2022", label="tab:zlbchar",caption.placement="bottom", comment = FALSE)
print.results = FALSE
```
\FloatBarrier
The rate characteristics the zero lower bound are shown in 
(Table \@ref(tab:zlbchar)).

```{r,zlbstatistics, echo=FALSE,results='asis',echo=FALSE,warning=FALSE, message=FALSE}
categories <- c("EFFR", "TGCR", "BGCR", "SOFR")
library(xtable)
k=4  
begn<-c(1,859,923,1014,1519,1)
endn<-c(858,922,1013,1518,1957,1957)
bgn<-begn[k]
edn<-endn[k]
zlb<-rrbp[bgn:edn,]
sdatezlb<-sdate[bgn:edn]

qzlbE=quantilesE[bgn:edn,]
qzlbT=quantilesT[bgn:edn,]
qzlbB=quantilesB[bgn:edn,]
qzlbS=quantilesS[bgn:edn,]

my_envepisodes$sdatezlb <-sdatezlb
my_envepisodes$zlbE <-qzlbE
my_envepisodes$zlbT <-qzlbT
my_envepisodes$zlbB <-qzlbB
my_envepisodes$zlbS <-qzlbS

Estatszlb <<- colMeans(qzlbE[,2:ncol(qzlbE)], na.rm = TRUE)
#Ostatszlb <<- colMeans(qzlbO[,2:ncol(qzlbO)], na.rm = TRUE)
Tstatszlb <<- colMeans(qzlbT[,2:ncol(qzlbT)], na.rm = TRUE)
Bstatszlb <<- colMeans(qzlbB[,2:ncol(qzlbB)], na.rm = TRUE)
Sstatszlb <<- colMeans(qzlbS[,2:ncol(qzlbS)], na.rm = TRUE)

median_values = c(Estatszlb[1], Tstatszlb[1], Bstatszlb[1], Sstatszlb[1])
iqr_values = c(Estatszlb[7] - Estatszlb[6], Tstatszlb[5] - Tstatszlb[4], Bstatszlb[5] - Bstatszlb[4], Sstatszlb[5] - Sstatszlb[4])
range_values = c(Estatszlb[8] - Estatszlb[5], Tstatszlb[6] - Tstatszlb[3], Bstatszlb[6] - Bstatszlb[3], Sstatszlb[6] - Sstatszlb[3])
volume_values = c(Estatszlb[2], Tstatszlb[2], Bstatszlb[2], Sstatszlb[2])
zlbstats <<- data.frame(Category = categories, Median = median_values, IQR = iqr_values, RANGE=range_values, VOLUME = volume_values)
#row.names(zlbstats) <- categories
row.names(zlbstats) <- NULL
xtable(zlbstats, include.rownames = FALSE,caption="Rate statistics Zero lower bound 03/17/2020-03/16/2022",label="tab:zlbstatistics", caption.placement="bottom", comment = FALSE)
print.results = FALSE
```
\FloatBarrier
The rate statistics the zero lower bound are shown in 
(Table \@ref(tab:zlbstatistics)).


\emph{The Fed's fight to control inflation}  

```{r, EFFR during inflation period 03/17/2022-12/14/2023, echo=FALSE}
rates=2
vol=3
targetup = 4
targetdown = 5
p1=6
p25=7
p75=8
p99=9
qinflationE<-my_envepisodes$inflationE
maxr<-max(qinflationE[,rates]) 
minr<-min(qinflationE[,rates])
```


```{r ratesinflation, fig.cap= "EFFR during inflation period 3/17/2022-12/14/2023",echo=FALSE,warning=FALSE, message=FALSE, fig.pos='H', fig.label="ratesinflation"}
library(ggplot2)
library(reshape2)
qinflationE<-my_envepisodes$inflation
sdate <- qinflationE[, 1]
rates=2
data_without_sdate <- qinflationE[, -1]
maxr<-max(qinflationE[,rates]) 
minr<-min(qinflationE[,rates])
meltrates_inflation <- melt(data.frame(sdate, data_without_sdate), id.vars = "sdate")
rates_inflation <<- ggplot(meltrates_inflation,aes(x=sdate,y=value,colour=variable,group=variable)) + 
  geom_line() +
  labs(caption="Inflation 03/17/2022-12/14/2023",x="", y = "rates basis points (bp) volume (billion dollars)", color="Rate") +  
  scale_y_continuous(breaks = seq(0,maxr, by = 50), limits = c(0,maxr)) + 
  theme_minimal()
rates_inflation
```

\FloatBarrier
(Figure \@ref(fig:ratesinflation)).

The EFFR and the IQR are within the FOMC target rates

```{r inflationbox, fig.cap="IQR and range of rates during inflation period 3/17/2022-12/14/2023", echo=FALSE, fig.pos='H',fig.label="inflationbox"}
library(ggplot2)
library(reshape2)
boxplot_inflation <- data.frame(
  Group = structure(1:4, .Label = c("EFFR", "TGCR", "BGCR", "SOFR"), class = "factor"),
  y0 = c(Estatsinflation[5], Tstatsinflation[3], Bstatsinflation[3], Sstatsinflation[3]),
  y25 = c(Estatsinflation[6], Tstatsinflation[4], Bstatsinflation[4], Sstatsinflation[4]),
  y50 = c(Estatsinflation[1], Tstatsinflation[1] , Bstatsinflation[1] , Sstatsinflation[1]) ,
  y75 = c(Estatsinflation[7], Tstatsinflation[5], Bstatsinflation[5], Sstatsinflation[5]),
  y100 = c(Estatsinflation[8], Tstatsinflation[6], Bstatsinflation[6], Sstatsinflation[6]))
  
  binflation<<-ggplot(boxplot_inflation , aes(x=Group,
                                       ymin = y0,
                                       ymax = y100,
                                       lower = y25,
                                       middle = y50,
                                       upper = y75,
                                       fill = Group)) +
    labs(caption = "Inflation 03/17/2022-12/14/2023", x="",  y = "Basis Points (bp)", color = "Rate", shape = "Rate") +  
    geom_boxplot(stat = "identity") +
  theme(panel.background = element_rect(fill = "white"),
        plot.background = element_rect(fill = "white"),
        axis.title.x = element_blank())  # Remove x-axis label)
  binflation
  my_environmentbox$inflation <-binflation
```
\FloatBarrier
(Figure \@ref(fig:inflationbox)).


```{r, inflationchar, echo=FALSE,results='asis',warning=FALSE, message=FALSE}
library(xtable)
k=5 
begn<-c(1,859,923,1014,1519,1)
endn<-c(858,922,1013,1518,1957,1957)
bgn<-begn[k]
edn<-endn[k]
inflation<-rrbp[bgn:edn,]
sdateinflation<-sdate[bgn:edn]

qinflationE=quantilesE[bgn:edn,]
qinflationT=quantilesT[bgn:edn,]
qinflationB=quantilesB[bgn:edn,]
qinflationS=quantilesS[bgn:edn,]

my_envepisodes$sdateinflation <-sdateinflation
my_envepisodes$inflationE <-qinflationE
my_envepisodes$inflationT <-qinflationT
my_envepisodes$inflationB <-qinflationB
my_envepisodes$inflationS <-qinflationS

Estatsinflation <<- colMeans(qinflationE[,2:ncol(qinflationE)], na.rm = TRUE)
Tstatsinflation <<- colMeans(qinflationT[,2:ncol(qinflationT)], na.rm = TRUE)
Bstatsinflation <<- colMeans(qinflationB[,2:ncol(qinflationB)], na.rm = TRUE)
Sstatsinflation <<- colMeans(qinflationS[,2:ncol(qinflationS)], na.rm = TRUE)

Tstatsinflation2<<-c(Tstatsinflation[1],Tstatsinflation[2], TargetUe=NA, TargetDe=NA,Tstatsinflation[3],Tstatsinflation[4],Tstatsinflation[5],Tstatsinflation[6])
Bstatsinflation2<<-c(Bstatsinflation[1],Bstatsinflation[2], TargetUe=NA, TargetDe=NA,Bstatsinflation[3],Bstatsinflation[4],Bstatsinflation[5],Bstatsinflation[6])
Sstatsinflation2<<-c(Sstatsinflation[1],Sstatsinflation[2], TargetUe=NA, TargetDe=NA,Sstatsinflation[3],Sstatsinflation[4],Sstatsinflation[5],Sstatsinflation[6])

Estatsinflation_mat <- matrix(Estatsinflation, nrow = 8, ncol = 1)
Tstatsinflation_mat <- matrix(Tstatsinflation2, nrow = 8, ncol = 1)
Bstatsinflation_mat <- matrix(Bstatsinflation2, nrow = 8, ncol = 1)
Sstatsinflation_mat <- matrix(Sstatsinflation2, nrow = 8, ncol = 1)
charinflation <- cbind(Estatsinflation_mat, Tstatsinflation_mat, Bstatsinflation_mat, Sstatsinflation_mat)
rownames(charinflation) <- c("Rate", "Volume", "Upper target", "Lower target", 
                     "Percentile_01", "Percentile_25", "Percentile_75", "Percentile_99")
colnames(charinflation) <- c("EFFR", "TGCR", "BGCR",  "SOFR")
xtable(charinflation,caption="Taming inflation 03/17/2022-12/14/2023",label="tab:inflationchar", caption.placement="bottom", comment = FALSE)
print.results = FALSE
#include.rownames = FALSE
```
\FloatBarrier

The rate characteristics during the taming of inflation are shown in 
(Table \@ref(tab:inflationchar)).


```{r, inflationstatistics, echo=FALSE,results='asis',warning=FALSE, message=FALSE}
library(xtable)
k <- 5 
begn <- c(1, 859, 923, 1014, 1519, 1)
endn <- c(858, 922, 1013, 1518, 1957, 1957)
bgn <- begn[k]
edn <- endn[k]
inflation <- rrbp[bgn:edn,]
sdateinflation <- sdate[bgn:edn]
categories <- c("EFFR", "TGCR", "BGCR", "SOFR")

qinflationE <- quantilesE[bgn:edn,]
qinflationT <- quantilesT[bgn:edn,]
qinflationB <- quantilesB[bgn:edn,]
qinflationS <- quantilesS[bgn:edn,]

my_envepisodes$sdateinflation <- sdateinflation
my_envepisodes$inflationE <- qinflationE
my_envepisodes$inflationT <- qinflationT
my_envepisodes$inflationB <- qinflationB
my_envepisodes$inflationS <- qinflationS

Estatsinflation <- colMeans(qinflationE[, 2:ncol(qinflationE)], na.rm = TRUE)
Tstatsinflation <- colMeans(qinflationT[, 2:ncol(qinflationT)], na.rm = TRUE)
Bstatsinflation <- colMeans(qinflationB[, 2:ncol(qinflationB)], na.rm = TRUE)
Sstatsinflation <- colMeans(qinflationS[, 2:ncol(qinflationS)], na.rm = TRUE)

Tstatsinflation2 <- c(Tstatsinflation[1], Tstatsinflation[2], TargetUe=NA, TargetDe=NA, Tstatsinflation[3], Tstatsinflation[4], Tstatsinflation[5], Tstatsinflation[6])
Bstatsinflation2 <- c(Bstatsinflation[1], Bstatsinflation[2], TargetUe=NA, TargetDe=NA, Bstatsinflation[3], Bstatsinflation[4], Bstatsinflation[5], Bstatsinflation[6])
Sstatsinflation2 <- c(Sstatsinflation[1], Sstatsinflation[2], TargetUe=NA, TargetDe=NA, Sstatsinflation[3], Sstatsinflation[4], Sstatsinflation[5], Sstatsinflation[6])

median_values <- c(Estatsinflation[1], Tstatsinflation[1], Bstatsinflation[1], Sstatsinflation[1])
iqr_values <- c(Estatsinflation[7] - Estatsinflation[6], Tstatsinflation[5] - Tstatsinflation[4], Bstatsinflation[5] - Bstatsinflation[4], Sstatsinflation[5] - Sstatsinflation[4])
range_values <- c(Estatsinflation[8] - Estatsinflation[5], Tstatsinflation[6] - Tstatsinflation[3], Bstatsinflation[6] - Bstatsinflation[3], Sstatsinflation[6] - Sstatsinflation[3])
volume_values <- c(Estatsinflation[2], Tstatsinflation[2], Bstatsinflation[2], Sstatsinflation[2])
inflationstats <<- data.frame(Category = categories, Median = median_values, IQR = iqr_values, RANGE = range_values, VOLUME = volume_values)

inflationstats <- data.frame(Category = categories, Median = median_values, IQR = iqr_values, RANGE = range_values, VOLUME = volume_values)
row.names(inflationstats) <- NULL
xtable(inflationstats, include.rownames = FALSE, caption="Rate statistics Taming inflation 03/17/2022-12/14/2023", label="tab:inflationstatistics", caption.placement="bottom", comment = FALSE)
print.results = FALSE
```
\FloatBarrier
The rate statistics the taming of inflation are shown in 
(Table \@ref(tab:inflationstatistics)).


```{r,episodemedian,  echo=FALSE, results='asis',warning=FALSE, message=FALSE}
#Med_table
categories <- c('Sample', 'Normalcy', 'Adjust', 'Covid', 'Zlb', 'Inflation')
medianstats <- list(
  ratesamplestats[,2],
  normstats[,2],
  adjstats[,2],
  covidstats[,2],
  zlbstats[,2],
  inflationstats[,2]
)
num_rows <- length(medianstats[[1]])
median_matrix <- sapply(medianstats, "[", 1:num_rows)
rownames(median_matrix) <- c('EFFR', 'TGCR', 'BGCR', 'SOFR')
med_table <- xtable(median_matrix, caption = "Median of rates during policy regimes",label="tab:episodemedian", caption.placement="bottom", comment = FALSE)
colnames(med_table) <- categories
med_table
```
\FloatBarrier
(Table \@ref(tab:episodemedian))

```{r,episodeiqr,  echo=FALSE, results='asis',warning=FALSE, message=FALSE}
#IqR table
iqrstats <- list(
  ratesamplestats[,3],
  normstats[,3],
  adjstats[,3],
  covidstats[,3],
  zlbstats[,3],
  inflationstats[,3]
)
num_rows <- length(iqrstats[[1]])
iqr_matrix <- sapply(iqrstats, "[", 1:num_rows)
rownames(iqr_matrix) <- c('EFFR', 'TGCR', 'BGCR', 'SOFR')
iqr_table <<- xtable(iqr_matrix, caption = "Interquartile range (IQR) of rates during policy regimes", label="tab:episodeiqr", caption.placement="bottom", comment = FALSE)
colnames(iqr_table) <- categories
iqr_table
```
\FloatBarrier
(Table \@ref(tab:episodeiqr))


```{r,episoderange,  echo=FALSE, results='asis',warning=FALSE, message=FALSE}
#Range table
rangestats <- list(
  ratesamplestats[,4],
  normstats[,4],
  adjstats[,4],
  covidstats[,4],
  zlbstats[,4],
  inflationstats[,4]
)

num_rows <- length(rangestats[[1]])
range_matrix <- sapply(rangestats, "[", 1:num_rows)
rownames(range_matrix) <- c('EFFR', 'TGCR', 'BGCR', 'SOFR')
# Create the xtable
range_table <<- xtable(range_matrix, caption = "Range of rates during policy regimes", label="tab:episoderange", caption.placement="bottom", comment = FALSE)
colnames(range_table) <- categories
range_table

#stacked_table <- rbind(med_table, iqr_table, range_table)
#print(stacked_table)
```
\FloatBarrier
(Table \@ref(tab:episoderange))


The average median rates and percentiles illustrate the tendency of other rates to cluster around the EFFR, and the clustering and outliers present in these reference rates.

\emph{Median daily reference rates}
The difference in the central tendency as measured by the median rate, changes dramatically over different policy episodes. 

A measure of central tendency, the median of the reference rates EFFR and money market rates (Table \@ref(tab:episodemedian)) illustrate  how closely money market rates track the policy rate EFFR.  The change in median rates during different episodes demonstrate the how their central tendency changes with monetary policy. Average median rates for the sample are 157 bp for the EFFR, and some 133-134 bp for the money market rates and SOFR. 

The sample EFFR  157 bp drops to 134 bp during the normalization period, 184 bp in the adjustment period bp,  150.46 bp during covid,  8.09 bp the zero lower bound, and 369 bp during the inflation fighting period.  Rates hover near zero from March 2020 to March 2022 during the zero lower bound. Median rates during the inflation episode increased over 233 percent of the the sample average as the Fed raised the FFR  in 25 or 50 basis point to tame inflation. Rates rose steadily from March 2022 to 533 bp in December 2023 some 235 percent of the sample median rate

<!--
The median EFFR, 184 bp during adjustment periods, plunged from the sample mean 157 basis points in November 2019 to 15 bp in March 2020 (\@ref(tab:Median rates of policy regimes or top panel).
-->

<!--
EFFR 156.97 133.79 183.59 150.46 8.09 368.60
TGCR 132.83  83.83 248.51 148.64 4.59 362.14
BGCR 132.85  83.84 254.84 148.64 4.59 362.20
SOFR 134.08  84.78 369.33 151.19 5.41 364.07
-->


The IQR and range provide more information about the series, how close they stay to their median values  and also the extreme values characteristic of short rates (\@ref(tab:IQR of rates during policy regimes)).


\emph{Variability: clustering of funding rates  around their median (IQR)}
Small interquartile range (IQR) values are evidence that the EFFR and the money market rates, with the exception of SOFR, cluster more tightly around their median values for the sample as a whole  (Table \@ref(tab:episodeiqr)). For the sample, 1.54 bp for the EFFR, and under one bp for the money market rates. For different policy episodes the IQR is under 0.12 to 0.23 during normalcy and the zero lower bound, more disperse, over 1 bp during the adjustment periods and over 3bp during the inflation episode. Boxplots show the IQR, the location of the median and tails for the outliers.


<!--
(Figure \@ref(fig:IQR and range during normalcy period 3/4/2016-7/31/2019))
(Figure \@ref(fig:IQR and rang during mid cycle adjustment period 8/1/2019-10/31/2019))
(Figure \@ref(fig:IQR and rang during covid period 11/1/2019-3/16/2020))
(Figure \@ref(fig:IQR and rang during zero lower bond period  3/17/2020-3/16/2022))
(Figure \@ref(fig:IQR and rang during inflation period 3/17/2022-12/14/2023))
-->
<!--
Fifty percent of EFFR rates range from 1.22 during normalcy to 4.66 bp during the adjustment periods.
EFFR  1.56     1.22    4.66   2.35  1.54  1.62

The money market rates TDCR and BGCR are more densely culstered around their median values, under 1 bp in the same, under 0.12 to 0.23 in normalcy and zero lower bound, more disperse, over 1 bp during the adjustment and over 3bp during the inflation episode.
TGcr  0.92     0.22    1.3    0.31  0.12  3.26
BGCR  0.96     0.23    1.36   0.42  0.15  3.36
-->

SOFR exhibits the greater variability; for the sample as a whole, IQR for SOFR is a high 4 bp.  The dispersion of SOFR is even more diverse among policy regimes. SOFR rates have the largest spread around the median rate, reaching over 10 bp during the adjustment period. SOFR is more tightly clustered around its median during normalcy, 3.30 bp and the zero lower bound  3.05 bp, but 7.37 bp during covid and 5.68 bp during inflation. Concoda reports [reference] in February 2023, some 25\% of repo trades were based on SOFR, a trillion dollar volume giving the Fed greater influence in global finance [check this claim from concoda]. NYFed data reveal SOFR rates to attain the largest spread in outliers in the tri party or bilateral repo [check].  

<!--
(\url{https://www.concoda.com/p/the-silent-monetary-revolution?r=dsye&utm_campaign=post&utm_medium=web})
-->

<!--
div style="text-align: center;"> for box plots
Not true in the repo spike during the pandemic, LIBOR skyrocketed above the Fed Funds rate, echoing stress in the unsecured debt markets while SOFR, failed to reveal the disturbance (check against the NYFed data)
9/16/2019	2.25	2.18	2.42	2.42
9/17/2019	2.3	2.25	5.25	5.25
9/18/2019	2.25	2.18	2.5	2.5
9/19/2019	1.9	1.85	1.9	1.91
9/20/2019	1.9	1.85	1.85	1.85
9/23/2019	1.9	1.85	1.82	1.82
9/24/2019	1.9	1.85	1.94	1.94
-->


\emph{Outliers}
The range of the data, the 99th and first percentile, is the spread from the lowest to the highest rates. More sensitive to outliers, the range represents 2 percent of the data, showing the magnitude of outliers under different policies (Table \@ref(tab:episoderange)). The  higher the range, the higher the variability. The spread outliers in the sample for all rates is 14 to 16 bp  (bottom panel Table).  During normalcy, the spread in money market rates and SOFR is 6 to 8 bp; the EFFR a higher 18 bp. Outliers soar during the period of adjustment, a spread of 18 bp, the EFFR reached 146 bp, the money market rates spread of 23- 34 bp, outliers reaching 275-300 bp. SOFR has the highest variablity, a spread of 42 bp, reaching a whopping 954 bp. The spread of outliers during covid and the zero lower bound are lower than the sample range. Spreads of extreme rate vaues  during the zero lower bond are lower than the sample, 7- 14 bp, some 11 to 12 bp for  the money market rates TGCR and BGCR 7.33 for the EFFR, and 14.44 for SOFR.  The spread 21 to 33 bp in outliers occurs during the Fed's attempt to contain inflation. some 23 basis points for the EFFR, the money market rates TGCR and BGCR 32-33 bp, and SOFR 21 bp.  Again SOFR shows greater variability in all episodes.

<!--
(\@ref(tab: Range of rates during policy regimes)-->

<!--
Range   Sample   Normalcy Adjust Covid Zlb  Inflation
EFFR  15.99     17.65    17.67  11,71   7.33  23.36
TGcr  13.86      5.62    22.7   11.21  11.21  32.27
BGCR  16.11      8.48    34.0   16.02  11.85  33.34
SOFR  14.51      8.53    41.65  19.46  14.44  21.35
-->


<!--
see Figure \@ref(fig:Boxplots all episodes 3/4/2016-12/14/2023)
\```{r, fig.caption= "Boxplots all episodes 3/4/2016-12/14/2023",echo=FALSE,results='asis'}
#pboxplots<-grid.arrange(bnormalcy, badjust, bcovid, bzlb, binflation, ncol=1) bad

print(pboxplots)
```
See (\@ref(fig:boxplots of rates during policy regimes) provides a summary of the data.

```{r, fig.cap="boxplots of rates during policy regimes", echo=FALSE, results='asis'}
library(patchwork)
# Combine boxplots
  pboxplots<-(bnormalcy | badjust ) / (bcovid | bzlb) / (binflation | bsample)
  print(pboxplots)
  my_environmentbox$pboxplots<-pboxplots
```
-->


\emph{Volatility}
Heteroskedasticity of overnight rates, here measured as log percent changes in rates, is plus of minus 0.5 percent from 2016 to 2020. Extreme values during the periods of the pandemic and the zero lower bound;  from  2020 to 2022, the percent change in rates varies plus or minus 2 percent.  then tapers off as the Fed began its fight to contain inflation in 2023, within plus or minus 2 percent (\@ref(fig:samplevola)

ADD volatility by episode

<!--
(\@ref(fig:volatility Percent change Daily rates 2016-2023)).
-->

<!-- Do volume by episode -->
\emph{Volume}
Daily volume in money market rates TBGR  \$297 billion,and BGCR \$311 billion, almost quadruple the transactions in the EFFR: \$79 billion. SOFR transactions, \$754 billion per day, dwarf trading in all other overnight reference rates.


<!--
Establish Mean reversion around a central tendency in daily rates. MR within2,3,...5 days show?
Is there a relationship to policy iniertia?
%Benzoni identify mean reversion around a central tendency. The stochastic mean  allows a relatively fast %mean-reversion of the short rate around a highly persistent time-varying central tendency process. 
%Jumps are integral to the quality of fit and relieve the stochastic volatility factor from accommodating %extreme outlier behavior. 
-->


<!--The overnight  bank funding rate (OBFR), similar to the EFFR, is a broad measure of U.S. dollar funding costs for U.S. based banks.-->
<!--
policy shocks on long-term bonds outside of a yield-curve model.
More patience is required to estimate a system of yield equations in a way that ensures
no-arbitrage. The cross-equation restrictions have to be derived from parameters that
describe the state dynamics and risk premia. Although the model is affine in the state
vector x,the functions $A(\tau) and B(\tau)$ are nonlinear functions of the underlying parameters

Who’s Borrowing and Lending in the Fed Funds Market Today?
Gara Afonso, Gonzalo Cisternas, Brian Gowen, Jason Miu, and Joshua Younger
\url{https://libertystreeteconomics.newyorkfed.org/2023/10/whos-borrowing-and-lending-in-the-fed-funds-market-today/}
--> 

<!--
After a brief description of policy, I consider shocks, such as changes in monetary policy shocks identified from  from changes of financial asset prices in a narrow time window around Federal Open Market Committee (FOMC) announcements
affect rate volatility. How that volatility may very under different monetary policy regimes may reveal the Fed's preferences for offsetting volatility in managing the FFR with the FOMC targets.
-->

## Important arbitrage opportunities in overnight reference rates
Under the corridor system that implements the [DATE] ample reserves, the Fed's setting of the IORB and O/NRRP which establish the the ceiling and floor of within which the Fed manages the range of the FFR. Fed temporary draining and adding reserves according to preferences for offsetting volatility in the FFR.

- Arbitrage opportunities exist to invest in repo when SOFR exceed IORR, the interest banks can receive on   deposits with the Fed
  \url{https://www.cmegroup.com/education/articles-and-reports/trading-us-money-market-spreads-with-sofr.html}                                                                                                       

\emph{IORB-EFFR}
The EFFR represents the cost of interbank borrowing and is determined by the market. The difference between the EFFR and IORR  presents arbitrage opportunities for banks. Banks can borrow funds at a lower EFFR and deposit the funds for a higher IORB rate, making a profit on the spread.

Unlike domestic banks, most foreign banks (FBO branches) are not insured by the Federal Deposit Insurance Corporation (FDIC). Since have FBO branches access to deposit is limited, they borrow in the Fed Funds market.  Since they do not pay the FDIC assessment fee, most FBO branches can borrow fed funds at a lower than domestic banks.  They can earn a larger spread by borrowing fed funds and depositing the borrowed funds at the Fed.

Historically, the IORB has been higher than the EFFR in general. A narrowing IORB/EFFR spread indicates tight supply of funds in the market and little room for arbitrage, which can lead to an outflow of excess reserves from the banking system.
\url{https://libertystreeteconomics.newyorkfed.org/2023/10/whos-borrowing-and-lending-in-the-fed-funds-market-today/}

<!--
First, it limits their access to deposits—the main source of domestic bank funding—making fed funds an important source of their short-term funding. Second, since they do not pay the FDIC assessment fee, most FBO branches face an effective cost of borrowing fed funds that is lower than that of domestic banks. Lower funding costs give FBO branches an advantage over their domestic counterparts in arbitraging fed funds offered at rates below the interest on reserve balances (IORB) rate, as they can effectively earn a larger spread by borrowing fed funds and depositing the borrowed funds at the Fed.  

after amendments to the International Banking Act disallowed new branches of FBOs from obtaining deposit insurance. This regulatory difference has two important implications for why FBO branches borrow in the fed funds market: First, it limits their access to deposits—the main source of domestic bank funding—making fed funds an important source of their short-term funding. Second, since they do not pay the FDIC assessment fee, most FBO branches face an effective cost of borrowing fed funds that is lower than that of domestic banks. Lower funding costs give FBO branches an advantage over their domestic counterparts in arbitraging fed funds offered at rates below the interest on reserve balances (IORB) rate, as they can effectively earn a larger spread by borrowing fed funds and depositing the borrowed funds at the Fed. Furthermore, differences in regulatory requirements across jurisdictions make engaging in the arbitrage trade less costly and less capital intensive for FBO branches. Specifically, leverage ratios in foreign jurisdictions are often calculated as a period-end snapshot, as opposed to daily or weekly averages in the U.S., which allows FBO branches more flexibility to borrow between reporting dates and simply unwind their positions on month-end or quarter-end dates to maintain higher reported leverage ratios
he FICC trades are filtered to remove a portion of transactions considered “specials”. 
[PLACE HERE or in rates discussion]
 
\url{https://libertystreeteconomics.newyorkfed.org/2023/10/whos-borrowing-and-lending-in-the-fed-funds-market-today/}
-->

\emph{SOFR}
The SOFR is an influential interest rate banks use to price U.S. dollar-denominated derivatives and loans. The daily SOFR is based on transactions in the Treasury repurchase market, where investors offer banks overnight loans backed by their bond assets. Benchmark rates such as the SOFR are essential in derivatives trading—particularly interest-rate swaps, which corporations and other parties use to manage interest-rate risk and to speculate on changes in borrowing costs.SOFR now covers 25% of daily repo volumes, equalling around $1 trillion, while the number of repos traded daily worldwide totals around $4 trillion. The size of the Eurodollar system, meanwhile, has shrunk dramatically. \url{https://www.concoda.com/p/the-silent-monetary-revolution}

When SOFR exceeds the IORR, banks idle reserve balances in SOFR. An IOER setting that lies near the prevailing level of market repo rates is likely to drive swings in the decisions by which banks choose where to park idle reserve balances, thereby amplifying daily swings in SOFR. SOFR can and frequently does exhibit more day-to-day volatility than survey-based STIR benchmarks. 
\url{https://www.cmegroup.com/education/articles-and-reports/trading-us-money-market-spreads-with-sofr.html}
<!--
SOFR replaced the London Interbank Offered Rate (LIBOR).

Benchmark rates such as the SOFR are essential in derivatives trading—particularly interest-rate swaps, which corporations and other parties use to manage interest-rate risk and to speculate on changes in borrowing costs.

SOFR volumes top $2 trillion for the first time after quarter-end pressures cause repo activity and rates to spike. meanwhile, the MOVE index (bond volatility) finally rises on a bear steepener
 \url{https://www.concoda.com/p/money-market-update-b03}

SOFR now covers 25% of daily repo volumes, equalling around $1 trillion, while the number of repos traded daily worldwide totals around $4 trillion. The size of the Eurodollar system, meanwhile, has shrunk dramatically. \url{https://www.concoda.com/p/the-silent-monetary-revolution}


Inter-Commodity Spreads Featuring SOFR
By virtue of its comprehensive link to activity in Treasury general collateral repo markets (\url{https://www.newyorkfed.org/data-and-statistics/data-visualization/tri-party-repo/}), SOFR can and frequently does exhibit more day-to-day volatility than survey-based STIR benchmarks.  An IOER setting that lies near the prevailing level of market repo rates is likely to drive swings in the decisions by which banks choose where to park idle reserve balances, thereby amplifying daily swings in SOFR.  For this reason, among others, inter-commodity spreads among SR1, SR3, GE, and ZQ futures may emerge as increasingly important tools to manage volatility.
\url{https://www.cmegroup.com/education/articles-and-reports/trading-us-money-market-spreads-with-sofr.html}
-->

\emph{ON RRP and TBills}
Money market mutual funds (MMFs) have been a major lender in the ONRRP facility.However, the supply of U.S. Treasury bills (T-bills). Since MMFs cannot hold securities with a remaining maturity greater than 397 days, T-bills are an especially appealing investment option for them. MMFs’ demand for Treasury securities, moreover, has grown significantly since October 2016, when the Securities and Exchange Commission (SEC) implemented an important reform of the MMF industry; this reform led to an increase in assets under management of more than $1 trillion for government MMFs—a type of MMF that can only hold Treasury securities, agency debt, or repurchase agreements collateralized by these assets.
\url{https://libertystreeteconomics.newyorkfed.org/2023/11/treasury-bill-supply-and-on-rrp-investment/} The supply of TBills affects the decision of money market mutual funds (MMFs) to invest in the ON RRP. When Tbills are scarce, MMEs increase their investment in the ON RRP as in January 2021 to around $2.6 trillion at the end of December 2022. When the supply Tbills is abundant, the reverse.  

With 3 month Tbills paying over 5 percent interest, the ON RPP has fallen to its lowest level. After the Fed’s largest liquidity injection on record, the “excess cash” era is coming to an end. Trillions of reserves once trapped in the Fed’s RRP (reverse repo) facility have been released to replenish the U.S. government’s bank account and fund QT (quantitative tightening). As the RRP balance reaches zero, the dynamics in the repo market are about to transform. The return to an “excess collateral” era awaits us.
After the resolution of the latest debt ceiling debacle in June 2023, however, the U.S. Treasury once again issued a deluge of Treasuries into the market, ending the safe asset deficit. The RRP balance had finally peaked, initiating the RRP drain
\url{https://www.concoda.com/p/the-reverse-repo-endgame}

<!--
We show that MMFs responded to a reduction in T-bill supply by increasing their take-up at the ON RRP, helping to explain the increased overall take-up T-bills Outstanding Decreased from January 2021 to July 2022 Take-up at the Federal Reserve’s Overnight Reverse Repo Facility (ON RRP) increased from a few billion dollars in January 2021 to around $2.6 trillion at the end of December 2022.  In this post, based on a recent Staff Report, we explain how the supply of U.S. Treasury bills (T-bills) affects the decision of money market mutual funds (MMFs) to invest at the facility. We show that MMFs responded to a reduction in T-bill supply by increasing their take-up at the ON RRP, helping to explain the increased overall take-up.

MMFs’ Demand for U.S. Treasury Securities
U.S. MMFs are open-end mutual funds regulated by the Securities and Exchange Commission (SEC) that can only invest in safe and highly liquid money-market instruments denominated in U.S. dollars. Among such instruments, U.S. Treasury securities are especially relevant because of their safety and liquidity. Since MMFs cannot hold securities with a remaining maturity greater than 397 days, T-bills are an especially appealing investment option for them. MMFs’ demand for Treasury securities, moreover, has grown significantly since October 2016, when the Securities and Exchange Commission (SEC) implemented an important reform of the MMF industry; this reform led to an increase in assets under management of more than $1 trillion for government MMFs—a type of MMF that can only hold Treasury securities, agency debt, or repurchase agreements collateralized by these assets.
\url{https://libertystreeteconomics.newyorkfed.org/2023/11/treasury-bill-supply-and-on-rrp-investment/}
-->


```{r, arbitragedata, echo=FALSE, warning=FALSE, message=FALSE} 
# Plot time series of SOFR, EFFR, IOR, RRP, 3 month Treasury
library(tidyverse)
# Select the desired columns from spread_no_na
print(names(spread_no_na))

# Ensure the Three_mon_Tbill column exists and has the correct length
if ("Three_mon_Tbill" %in% names(spread_no_na)) {
    print(length(spread_no_na$Three_mon_Tbill)) # Should print 1957
} else {
    stop("Three_mon_Tbill column does not exist in spread_no_na")
}

# Process the Three_mon_Tbill column to handle NA values
Three_mon_Tbill_processed <- ifelse(is.na(spread_no_na$Three_mon_Tbill), 0, spread_no_na$Three_mon_Tbill)

# Ensure the processed column has the correct length
print(length(Three_mon_Tbill_processed)) # Should print 1957

# Select the desired columns from spread_no_na
arbrates <- spread_no_na %>%
  dplyr::select(sdate, EFFR, SOFR, IORR, RRPONTSYAWARD)

# Add the processed Three_mon_Tbill column to the arbrates dataframe
arbrates <- arbrates %>%
  mutate(Three_mon_Tbill = Three_mon_Tbill_processed)

# Check the structure of the arbrates dataframe
str(arbrates)
```

(Figure \@ref(fig:arbratesnorm).

```{r arbratesnorm, fig.cap="Key reference rates: Normalcy 3/4/2016-7/31/2019", echo=FALSE,fig.num=TRUE, warning=FALSE, message=FALSE, results='asis'}
#Normalcy
k=1
bgn=begn[k]
edn=endn[k]
arbrates_long <- arbrates[bgn:edn,] %>%
  pivot_longer(cols = c(EFFR, SOFR, IORR, RRPONTSYAWARD, Three_mon_Tbill),
               names_to = "variable", values_to = "value")
# Calculate max rates for y-axis scaling
mxrates <- max(arbrates_long$value, na.rm = TRUE)

arb_ratesnorm <- ggplot(arbrates_long, aes(x = sdate, y = value, colour = variable, group = variable)) + 
  geom_point(size = 1, shape = 16) +
  labs(caption = "Normalcy 3/4/2016-7/31/2019",x = "", y = "Key rates", color = "", shape = "") +  
  scale_y_continuous(breaks = seq(0, mxrates, by = 50), limits = c(0, mxrates)) + 
  theme_minimal() + 
  guides(shape = guide_legend(title = ""))+
  scale_color_manual(values = c("EFFR" = "red",
                                "SOFR" = "magenta",
                                "IORR" = "blue",
                                "RRPONTSYAWARD" = "aquamarine",
                                "Three_mon_Tbill" = "yellow"))
print(arb_ratesnorm)
```

(Figure \@ref(fig:arbratesadjust).

```{r arbratesadjust, fig.cap="Key reference rates: Adjustment 8/1/2019-10/31/2019", echo=FALSE,fig.num=TRUE, warning=FALSE, message=FALSE, results='asis'}
#Adjust
k=2
bgn=begn[k]
edn=endn[k]
arbrates_long <- arbrates[bgn:edn,] %>%
  pivot_longer(cols = c(EFFR, SOFR, IORR, RRPONTSYAWARD, Three_mon_Tbill),
               names_to = "variable", values_to = "value")
# Calculate max rates for y-axis scaling
mxrates <- max(arbrates_long$value, na.rm = TRUE)

arb_ratesadjust <- ggplot(arbrates_long, aes(x = sdate, y = value, colour = variable, group = variable)) + 
  geom_point(size = 1, shape = 16) +
  labs(caption = " Mid cycle adjustment 8/1/2019-10/31/2019",x = "", y = "Key rates", color = "", shape = "") +  
  scale_y_continuous(breaks = seq(0, mxrates, by = 50), limits = c(0, mxrates)) + 
  theme_minimal() + 
  guides(shape = guide_legend(title = ""))+
  scale_color_manual(values = c("EFFR" = "red",
                                "SOFR" = "magenta",
                                "IORR" = "blue",
                                "RRPONTSYAWARD" = "aquamarine",
                                "Three_mon_Tbill" = "yellow"))
print(arb_ratesadjust)
```

(Figure \@ref(fig:arbratescovid).

```{r arbratescovid, fig.cap="Key reference rates: Covid 11/1/2019-3/16/2020", echo=FALSE,fig.num=TRUE, warning=FALSE, message=FALSE, results='asis'}
#Covid
k=3
bgn=begn[k]
edn=endn[k]
arbrates_long <- arbrates[bgn:edn,] %>%
  pivot_longer(cols = c(EFFR, SOFR, IORR, RRPONTSYAWARD, Three_mon_Tbill),
               names_to = "variable", values_to = "value")
# Calculate max rates for y-axis scaling
mxrates <- max(arbrates_long$value, na.rm = TRUE)

arb_ratescovid <- ggplot(arbrates_long, aes(x = sdate, y = value, colour = variable, group = variable)) + 
  geom_point(size = 1, shape = 16) +
  labs(caption = "Covid 11/1/2019-3/16/2020",x = "", y = "Key rates", color = "", shape = "") +  
  scale_y_continuous(breaks = seq(0, mxrates, by = 50), limits = c(0, mxrates)) + 
  theme_minimal() + 
  guides(shape = guide_legend(title = ""))+
  scale_color_manual(values = c("EFFR" = "red",
                                "SOFR" = "magenta",
                                "IORR" = "blue",
                                "RRPONTSYAWARD" = "aquamarine",
                                "Three_mon_Tbill" = "yellow"))
print(arb_ratescovid)
```

(Figure \@ref(fig:arbrateszlb).

```{r arbrateszlb, fig.cap="Key reference rates: Zero lower bound 3/17/2020-3/16/2022", echo=FALSE,fig.num=TRUE, warning=FALSE, message=FALSE, results='asis'}
#zlb
k=4
bgn=begn[k]
edn=endn[k]
arbrates_long <- arbrates[bgn:edn,] %>%
  pivot_longer(cols = c(EFFR, SOFR, IORR, RRPONTSYAWARD,Three_mon_Tbill),
               names_to = "variable", values_to = "value")
# Calculate max rates for y-axis scaling
mxrates <- max(arbrates_long$value, na.rm = TRUE)

arb_rateszlb <- ggplot(arbrates_long, aes(x = sdate, y = value, colour = variable, group = variable)) + 
  geom_point(size = 1, shape = 16) +
  labs(caption = "Zero lower bound 3/17/2020-3/16/2022",x = "", y = "Key rates", color = "", shape = "") +  
  scale_y_continuous(breaks = seq(0, mxrates, by = 50), limits = c(0, mxrates)) + 
  theme_minimal() + 
  guides(shape = guide_legend(title = ""))+
  scale_color_manual(values = c("EFFR" = "red",
                                "SOFR" = "magenta",
                                "IORR" = "blue",
                                "RRPONTSYAWARD" = "aquamarine",
                                "Three_mon_Tbill" = "yellow"))

print(arb_rateszlb)
```

(Figure \@ref(fig:arbratesinflation).

```{r arbratesinflation, fig.cap="Key reference rates: Taming inflation 3/17/2022-12/14/2023        ", echo=FALSE,fig.num=TRUE, warning=FALSE, message=FALSE, results='asis'}
#Inflation
k=5
bgn=begn[k]
edn=endn[k]
arbrates_long <- arbrates[bgn:edn,] %>%
  pivot_longer(cols = c(EFFR, SOFR, IORR, RRPONTSYAWARD, Three_mon_Tbill),
               names_to = "variable", values_to = "value")
# Calculate max rates for y-axis scaling
mxrates <- max(arbrates_long$value, na.rm = TRUE)

arb_ratesinflation <- ggplot(arbrates_long, aes(x = sdate, y = value, colour = variable, group = variable)) + 
  geom_point(size = 1, shape = 16) +
  labs(caption = "Taming inflation  3/17/2022-12/14/2023",x = "", y = "Key rates", color = "", shape = "") +  
  scale_y_continuous(breaks = seq(0, mxrates, by = 50), limits = c(0, mxrates)) + 
  theme_minimal() + 
  guides(shape = guide_legend(title = ""))+
  scale_color_manual(values = c("EFFR" = "red",
                                "SOFR" = "magenta",
                                "IORR" = "blue",
                                "RRPONTSYAWARD" = "aquamarine",
                                "Three_mon_Tbill" = "yellow"))
print(arb_ratesinflation)
```
<!--
ANOTHER ISSUE
Changes in spreads of administered rates also change trading patterns, investing in these funding markets or keeping reserves with the Fed. When SOFR, the Fed’s broadest measure of repo rates, exceeds O/N RRP, cash lenders returns to private repo, leaving the Fed’s O/N RRP facility. When the spread between SOFR and IORB has widened, funding market participants allocate cash to repo trades. When Treasury bill rates exceed the O/N RRP, investors also abandon the Fed's Reverse Repurchase facility.
-->
# Monetary policy during the sample period 2016-2023
  Before the Great Financial Crisis (GFC) of 2008, Federal Reserve conducted monetary policy policy by , trading limited reserves and securities in the interbank Federal Funds market through open market operations (OMO). The Fed responded to the great financial crisis (GFC) with large scale asset purchases (LSAPs) from 2008 to 2014 - QE,QE1, QE2, and QE3, funded by US Treasury sale of Treasury bills. The Fed increased reserve balances from large part of its SOMA Treasury holdings. But LSAPs resulted in excess liquidity. Swamped with reserves, banks had no need to borrow in the Fed Funds market. From 2010 to late 2019, reserves went through a full expansion-contraction cycle. Again in early 2020, reserves grew from $\$$8 trillion from 2010 and 2019 to \$19 trillion (2014 and 2021).
  
[2022,2023?]  

To regain control over the FFR after this major increase in liquidity, the Fed experimented with with different policies. 

<!--
After the meltdown of the shadow banking system following the Lehman
failure in September 2008, the Fed  initiated  QE1, purchasea of high grade securities, agency
mortgage backed securities (AMBS) - bulk of the purchases, agency debt, and long term government
bonds.
The Fed set up a commercial paper lending facility to purchase of commercial paper since the Fed accepted these instruments as collateral for the loans made to the facility. In October 2010, the Fed
announced QE2, purchases of long term government bonds in amounts lessthan QE1. In September 2011, the Fed implemented Operation, a sterilized acquisition of long term government bonds financed by selling some of its short term bonds. Twist was extended in the summer of 2012,
and the possibility of more LSAPs remains
under discussion
-->
October 1, 2008, Congress gave the Fed the power to pay interest on reserves (IORB) to help control the Federal Funds rate. The IORB rate, the interest rate that banks earn from the Fed on the funds deposited in their reserve accounts is the Fed’s principal tool for interest rate control. In 2013, to address the post GFC build up of excess liquidity, the Federal Reserve introduced the overnight reverse repurchase  facility (ON RRP), the Fed’s supplementary tool for interest rate control. 

The FOMC adopted target range in 2018. In 2019 the Fed's  mew regime of ample reserves manages the Fed Funds rate within the target range. The administrative rates, the IORB  and ON RRP  created a corridor system within which Fed manages the FFR within the FOMC target range. The Fed temporarily intervenes in repurchase (repo) and reverse repo markets to offset high frequency liquidity shocks in order to keep the FFR close to target. Together these administrative rates create a floor system for managing the FFR. IORB is the ceiling and the ON RRP rate the  floor. No bank would lend at rates lower than the IORB nor borrow at rates higher than the ON RRP rate.



## The Fed's involvement in repurchase markets

<!--
Concurrently, Sinc {DATES} there has been a dramatic increase in funding primary dealers and other financial participants through repo and wholesale money market rates. Repo markets trade $\$$4 trillions of dollars daily. [DATES]

\url{https://www.richmondfed.org/publications/research/economic_brief/2021/eb_21-31#:~:text=The%20Fed's%20Involvement%20in%20the%20Repo%20Market&text=The%20Fed%20supplied%20reserves%20by,temporary%20holdings%20of%20Treasury%20securities}
\url{https://www.sifma.org/resources/research/us-repo-statistics/}

\url{https://www.newyorkfed.org/markets/domestic-market-operations/monetary-policy-implementation/repo-reverse-repo-agreements}
-->

<!--

Repos are a common secured money market transaction. In a repo transaction, the Desk purchases securities from a counterparty subject to an agreement to resell the securities at a later date. Each repo transaction is economically similar to a loan collateralized by securities, and temporarily increases the supply of reserve balances in the banking system.
Conversely, in a reverse repo transaction, the Desk sells securities to a counterparty subject to an agreement to repurchase the securities at a later date. Reverse repo transactions temporarily reduce the supply of reserve balances in the banking system.
To support its policy objectives, the FOMC has established repo and reverse repo facilities. The Overnight Reverse Repo Facility (ON RRP) helps provide a floor under overnight interest rates by acting as an alternative investment for a broad base of money market investors when rates fall below the interest on reserve balances (IORB) rate. The Standing Repo Facility (SRF) serves as a backstop to dampen upward interest rate pressures that can occasionally emerge in overnight U.S. dollar funding markets and spillover into the fed funds market. The Desk generally conducts both the ON RRP and SRF operations each business day.
-->

   since the 1920s, The Fed used repo transactions to manage the reserves held by commercial banks with the Fed. The New York Fed’s Open Market Trading Desk (the Desk) is authorized and directed by the Federal Open Market Committee (FOMC) to conduct repurchase agreement (repo) and reverse repo transactions. These open market operations support effective monetary policy implementation and smooth market functioning by helping maintain the federal funds (fed funds) rate within the FOMC’s target range. Repo operations became the Fed's primary means of adjusting bank reserves.

<!--
   in order to influence the level and price of interbank credit as well as credit more broadly in the economy.manage the FFR in the interbank market?

   Following the increase in liquidity from the LSAP response to the GFC, the Fed no longer needed to engage in daily reserve management hence, no need for the Fed to actively participate in the repo market to adjust reserves. After 2008, The Fed's ability to pay interest on reserves (IORB) made reserves an attractive short-term investment.
-->

\emph{Repurchase and reverse purchase transactions}
<!--
When the Fed is the counterparty to an exchange of securities for reserves, the Fed loans reserves to the counterparty in exchange for a security as collateral. Reserves decrease as the counterparty's account at the Fed isdebited and the Federal Funds rate increases.  In a reverse repo transaction, the Fed lends securities to a counterparty, increasing reserves by a deposit in their account, and lowering the Federal Funds rates. Through these "reserve injections," the Fed was able to 
-->

To offset liquidity shocks, the Fed temporarily intervenes in repurchase (repo) and reverse repo transactions  to keep the federal funds rate within the FOMC target range. Repurchase agreements drain reserves from the system and raise the FFR. Reverse repo purchases of assets by the Fed add reserves and lower the FFR.

\emph{The reverse repurchase facility}
Fed opened its RRP (reverse repo) facility in 2013 after the GRC to absorb the excess liquidity  that drove the Fed Funds rate below the Fed's target range. The Overnight Reverse Repo Program (ON RRP) allows eligible counterparties to lend excess funds to the Fed through repo transactions, ensuring that repo rates remain close to or above the ON RRP rate. During periods of high reserves, the reverse repo facility takes up reserves when banks no longer want to take on additional reserves and reducing deposit rates and other funding. 

<!--
   The O/N RRP accepts offers to lend cash against securities from its System Open Market Account (SOMA) portfolio. The reverse repo facility is available to a wide range of money market lenders.In a reverse repo transaction, the 
   
   
   Desk sells securities to a counterparty subject to an agreement to repurchase the securities at a later date.  A reverse repo transaction temporarily  decreases the supply of reserve balances in the banking system and raises the FFR.   

The ON RRP facility has been effective in helping maintain control of the fed funds rate well within the target policy range. More recently, however, one of the ON RRP's primary uses has been to absorb funds that would otherwise end up as reserves on bank balance sheets, with the Fed effectively becoming the largest borrower in the repo market, as seen in Figure 1.

An important shift linked to the ON RRP is that the Fed now directly interacts with a much broader set of institutions in the repo market. Traditionally, primary dealers were the only admissible counterparties in open market operations. Access to the ON RRP, however, has been extended to banks, GSEs and other qualified financial institutions. Through this expansion, MMFs have become the main repo counterparty.3

While it can be attractive to MMFs, the ON RRP interest rate has been set lower than the IORR that banks earn, making the participation in the program uneconomical for banks. An important consequence of this relative pricing is that the stock of bank reserves is now heavily influenced by flows in and out of MMFs.
-->

\emph{The Standing Repo Facility (SRF)}
When the Fed reduced its balance sheet build up after quantitative easing (QE). repo rates. the FFR, and FX swap rates spiked in 2019, The FFR exceeded the Fed’s upper target rate. The Fed initiated the Standing Repo Facility (SRF) after scarce bank reserves constrained dealer balance sheets, leading to cash shortage and a segmented repo market. The SRF lets primary dealers and other approved counterparties borrow cash from the Fed, secured against U.S. Treasuries. The Fed transformed the SRF into a permanent facility.

\emph{Other changes}
The central banks continued to change their overall frameworks for controlling short-term interest rates.
The  FOMC reference rate changes from Libor to SOFR,was one such policy change. 

\emph{Concoda: from excess cash to excess collateral 
The RRP is the sole shock absorber for excess liquidity. In April 2021, the Federal Reserve began unwinding its largest monetary expansion on record. During the COVID-19 panic, the Fed allowed banks to absorb vast flows from QE by exempting reserves and Treasuries from its SLR (Supplementary Leverage Ratio). The onset of the Covid-19 pandemic in early 2020 led to turmoil in various financial markets.  Treasury markets faced similar turmoil, as a dash for cash by investors led to liquidity challenges across a variety of markets. Government agencies took action to stabilize financial markets and the economy.

In June 2022, the Federal Reserve started reducing the size of its balance sheet, which had expanded to
just under \$9 trillion in response to the COVID-19 pandemic. However, whereas banks’ reserves at the
Federal Reserve have decreased, the investment of money market funds (MMFs) at the Federal Reserve’s
overnight reverse repo (ON RRP) facility continued to increase, reaching \$2.4 trillion in September
2022. 

Throughout 2022, the rate for dealers to borrow from cash lenders remained tightly pinned to ON RRP.The Fed’s ON RRP thus began to determine rates in tri-party repo. Repo rates must to rise above both ON RRP and IORB for banks to fund repo trades with reserves, since they can earn IORB returns on reserves. When the spread between SOFR and IORB widens, financial participants  allocate cash to repo trades, supplying liquidity to the most crucial funding market. 

Beginning in 2023, the RRP balance was \$2.5 trillion in excess liquidity. However, returns on large U.S. Treasury issuance in June 2023 exceeded the ON RPP rate. The RRP balance peaked as the primary RRP users, MMFs, bought Treasuries. RRP balance plunged below \$800 billion in  December  2023 (Currently \$439.81 billion , 5/31/2024).

<!--
 The SLR was implemented as part of the Basel III reforms after the 2008 financial crisis. The ratio's numerator is tier 1 Capital, and the denominator comprises all on-balance-sheet assets – including U.S. Treasuries and deposits at Federal Reserve Banks – some off-balance-sheet items, and derivative exposures. One of the main goals of this interim rule was to "ease strains in the Treasury market resulting from the coronavirus and increase banking organizations' ability to provide credit to households and businesses." The SLR expired March 31, 2021 

How monetary policy and the ON RRP facility interact with the private repo market is illustrated by MMFs use of the facility. The MMFs use of the ON RRP facility increased by $2 trillion between January 2021 and June 2022, MMFs'heir private repo lending fell by almost $500 billion. T

\url{https://www.federalreserve.gov/econres/notes/feds-notes/money-market-fund-repo-and-the-on-rrp-facility-20231215.html}
-->
 
<!--
[CHECK and is fast approaching the zero bound] 	769.35.
\url{https://libertystreeteconomics.newyorkfed.org/2023/12/dropping-like-a-stone-on-rrp-take-up-in-the-second-half-of-2023/}
\url{https://fred.stlouisfed.org/graph/?g=1optd}
-->

Once the surplus of cash in the Fed’s RRP facility dries up, the stability of the triparty repo market will once again be tested. The Fed’s quantitative tightening (QT) and the U.S. Treasury’s large debt issuance will continue to pull funding away from repo, perhaps causing a repeat of the September 2019 “repocalypse”. Sensing a recurrence, a large number of banks have begun signing up to the Fed’s standing repo facility, granting themselves the ability to receive emergency loans and front-run a repo rate spike. If turmoil re-emerges, more monetary theatrics from the Federal Reserve await us, and the triparty repo market will be front and center.

<!--
The onset of the Covid-19 pandemic in early 2020 drastically increased uncertainty throughout the economy. This led to turmoil in various financial markets, evidenced by the Dow Jones Industrial Average in March 2020 posting its largest single-day drop since the 2008 global financial crisis. Treasury markets faced similar turmoil, as a dash for cash by investors led to liquidity challenges across a variety of markets.1 Government agencies took action to stabilize financial markets and the economy.

April 1, 2021, the Federal Reserve began unwinding measures that enabled its largest monetary expansion on record by exempting reserves and US Treasuries from the Supplementary Leverage Ratio (SLR).During the COVID-19 panic, the Fed allowed banks to absorb vast flows from QE (quantitative easing) by exempting reserves and Treasuries from its SLR (Supplementary Leverage Ratio)

On April 1, 2020, as part of efforts to restore stability in markets and economy, the Federal Reserve announced an interim final rule, set to expire on March 31, 2021, that would temporarily exclude U.S. Treasuries and deposits at Federal Reserve Banks from the calculation of the Supplementary Leverage Ratio (SLR). One of the main goals of this interim rule was to "ease strains in the Treasury market resulting from the coronavirus and increase banking organizations' ability to provide credit to households and businesses." The SLR was implemented as part of the Basel III reforms after the 2008 financial crisis. The ratio's numerator is tier 1 Capital, and the denominator comprises all on-balance-sheet assets – including U.S. Treasuries and deposits at Federal Reserve Banks – some off-balance-sheet items, and derivative exposures. 

The U.S. Treasury ended its mammoth issuance of Treasury bills in 2021 used to fund emergency COVID operations. Money market funds (MMFs), invested in bills, turned to the RRP. MMFs inflows continued into 2022.  the volatility of the largest bond market drawdown in recent history encouraged even greater demand for RRPs. The Fed’s O/N RRP had thus begun to determine rates in repo’s primary funding market (triparty repo).
\url{https://www.brookings.edu/articles/fed-response-to-covid19/


\url{https://www.federalreserve.gov/econres/notes/feds-notes/impact-of-leverage-ratio-relief-announcement-and-expiry-on-bank-stock-prices-20230629.html}
April 2021, the Federal Reserve began unwinding measures that enabled its largest monetary expansion on record. During the COVID-19 panic, the Fed allowed banks to absorb vast flows from QE (quantitative easing) by exempting reserves and Treasuries from its SLR (Supplementary Leverage Ratio)

•	At this time 2021, the U.S. Treasury ended its issuance of Treasury bills used to fund emergency COVID operations
* When the U.S. Treasury ended its mammoth issuance of Treasury bills in 2021 used to fund emergency COVID operations, money market funds (MMFs) turned to the RRP, 
•	MMFs inflows continued into 2022.  the volatility of the largest bond market drawdown in recent history encouraged even greater demand for RRPs. The Fed’s O/N RRP had thus begun to determine rates in repo’s primary funding market (triparty repo).
\url{https://www.brookings.edu/articles/fed-response-to-covid19/

MMFs began to park more investor cash in the U.S. central bank’s facility instead of lending it to private sector entities. At the same time, borrowers were spoilt for choice, with more cash than they could readily absorb. The Fed’s O/N RRP had thus begun to determine rates in repo’s primary funding market (triparty repo).Throughout 2022, the rate for dealers to borrow from cash lenders remained tightly pinned to O/N RRP.

•	MMFs inflows into O/N RRP continued into 2022.  the volatility of the largest bond market drawdown in recent history encouraged even greater demand for RRPs
Between January 2021 and June 2022, money market funds' (MMFs') investments in the Federal Reserve's Overnight Reverse Repurchase (ON RRP) facility rose by $2 trillion, while their private repo lending fell by almost $500 billion. These sizable shifts give us an opportunity to examine how monetary policy implementation and the ON RRP facility interact with the private repo market. 
\url{https://www.federalreserve.gov/econres/notes/feds-notes/money-market-fund-repo-and-the-on-rrp-facility-20231215.html}

The Fed’s ON RRP had thus begun to determine rates in repo’s primary funding market (triparty repo).Throughout 2022, the rate for dealers to borrow from cash lenders remained tightly pinned to O/N RRP. For banks, as the central bank pays interest on bank reserves, repo rates must to rise above both O/N RRP and IORB for banks to fund repo trades with reserves, which they’d otherwise park at the Fed for superior returns. Each time the spread between SOFR and IORB has widened significantly, Wall Street behemoths have begun to allocate cash to repo trades, supplying liquidity to the most crucial funding market. 


When SOFR (Secured Overnight Financing Rate), the Fed’s broadest measure of repo rates, exceeded O/N RRP, cash lenders returns to private repo, while the Fed’s facility took a backseat
•	When the spread between SOFR and IORB has widened/ significantly, funding market participants allocate cash to repo trades,
•	repo rates have had to rise above both O/N RRP and IORB for banks to fund repo trades

wrt to banks, As the central bank pays interest on bank reserves, repo rates must to rise above both O/N RRP and IORB for banks to fund repo trades with reserves, which they’d otherwise park at the Fed for superior returns. Each time the spread between SOFR and IORB has widened significantly, Wall Street behemoths have begun to allocate cash to repo trades, supplying liquidity to the most crucial funding market. Yet even Wall Street’s presence proved insufficient to create stable repo markets. Another level in the Fed’s repo hierarchy was needed.


•	Banks' “great shedding” pushed deposits off their balance sheets. The reduced reserves) were placed in the ON RRP.
}

• Beginning in 2023, the RRP balance was $2.5 trillion in excess liquidity
•	However, large U.S. Treasury issuance in June 2023 provided returns greater the O/N RPP, ending the safe asset deficit. The RRP balance had finally peaked, initiating the RRP drain, the primary RRP drainers, MMFs, bought Treasuries. 
•	RRP balance has plunged below $800 billion and is fast approaching the zero bound
•	start of 2023, the RRP balance was housing a whopping $2.5 trillion in excess liquidity
•	June 2023, however, the U.S. Treasury once again issued a deluge of Treasuries into the market, ending the safe asset deficit. The RRP balance had finally peaked, initiating the RRP drain
he U.S. Department of the Treasury today announced its current estimates of privately-held net marketable borrowing[1] for the April – June 2023 and July – September 2023 quarters.

During the April – June 2023 quarter, Treasury expects to borrow $726 billion in privately-held net marketable debt, assuming an end-of-June cash balance of $550 billion.[2]  The borrowing estimate is $449 billion higher than announced in January 2023, primarily due to the lower beginning-of-quarter cash balance ($322 billion), and projections of lower receipts and higher outlays ($117 billion).

During the July – September 2023 quarter, Treasury expects to borrow $733 billion in privately-held net marketable debt, assuming an end-of-September cash balance of $600 billion.2
\url{https://home.treasury.gov/news/press-releases/jy1453#:~:text=U.S.%20Department%20of%20the%20Treasury,-Search&text=During%20the%20April%20%E2%80%93%20June%202023,cash%20balance%20of%20%24550%20billion.
}
•	Then heavy debt issuance made yields on government debt more attractive than the Fed’s RRP, the primary RRP drainers, MMFs, bought Treasuries. 
Among fixed-income securities, there has been no refuge. Interest rates have spiked across the yield curve, thereby sinking all investment-grade debt. Lower-quality notes have also struggled. Sometimes when interest rates rise, junk bonds perform well, because credit spreads tighten. Not this year. Instead, credit spreads have widened owing to fears of a recession. The result has been comprehensive bond market losses.\url{https://www.morningstar.com/columns/rekenthaler-report/worst-bond-market-ever}

•	the RRP drain had entered beast mode.
•	RRP balance has plunged below $800 billion and is fast approaching the zero bound
-->


## FOMC rates changes, monetary regimes, and events over the seven year period, 2016-2023 
Candidate shocks occurring during the seven year period of our sample 2016-2023 (Table \@ref{table_fomc}) include FOMC rate and administered rate changes, different policy experiments, events such as the March 2020 dash for cash, and macroeconomic announcements. Changes in the Fed funds rate and the administered rates IORB and the reward rate ON RRP are one source of shocks to overnight reference rates 
<!--
(\@ref{table:FOMC rate changes 2016-2023})  
-->

The  Romer and Romer (2023) narrative approach to macroeconomic identification incorporate the evidence into a statistical framework.  Their criteria that monetary shocks be unrelated to current or prospective real economic  activity changes would exclude shocks such as policy changes such as QE, LSAP, and forward guidance or events such the spike in repo rates in 2019 or the March 2020 dash for cash.

<!--
In identify significant contractionary and expansionary changes in monetary policy not taken in response to current or prospective developments in real activity. 
Romer and Romer use historical minutes  and transcripts of Federal Reserve policymaking meetings to identify significant contractionary and expansionary changes in monetary policy not taken in response to current or prospective developments in real activity. Their sources are historical minutes and transcripts of Federal Reserve policy making meetings 
- “Record of Policy 
Actions” (very similar to what are now called the FOMC “Minutes”) 
- “FOMC Minutes” for the current period. 
* other external shocks to these markets

Romer and Romer regress the variable of impact like GDP or inflation on a current and past index of shocks - positive if contractionary, negative i expansionary, or zero if no impact.
-->

The literature beginning Campbell et al. (2012) identifies monetary policy shocks from changes of financial asset prices in a narrow time window around Federal Open Market Committee (FOMC) announcements. The authors distinguish between Odyssean forward guidance, which publicly commits the FOMC to a future action, and Delphic forward guidance, which merely forecasts macroeconomic performance and likely monetary policy actions. <!-- Public statements of FOMC intentions—forward guidance—can substitute for lower rates at the zero bound the issue they address. -->

Prior to the announcement, asset prices reflect the consensus view on the state of the economy and the Fed’s expected response to it. Afterwards, asset prices incorporate unexpected news conveyed in the announcement. News could be the current fed funds rate or its future path, asset purchases, the Fed’s view on the state of the economy. They represent different structural shocks that may affect the economy differently.

Jarocinski (2022)  estimates structural shocks underlying the reactions of financial market to FOMC announcements. Not specified ex ante, ex post the estimated shocks can be  labeled as the current fed funds rate policy, as 1)an “Odyssean” forward guidance, a commitment to a future course of policy rates such as a large scale asset purchase or 2) a “Delphic” forward guidance, a statement about the future course of policy rates, a forecast of the appropriate stance of the policy rather than a commitment (Campbell et al., 2012).

<!--
Jarocinski (2022) estimates high-frequency reactions of financial variables, such as interest rates and stock prices, to FOMC announcements. Usually very small, but sometimes very large.  Exploting these fat tails or excess kurtosis} implies that these data may contain information about the nature of the underlying structural shocks. Given the importance of the Fed policies, it is vital to exploit this available information as well as possible.
-->

His baseline model expresses surprises, high-frequency reactions to FOMC announcements, in near-term fed funds futures, 2 and 10-year Treasury yields and the S$\&$P500 stock index as linear combinations of four Student-t distributed shocks}.  These four shocks ex post have natural economic interpretations:
1.  the standard monetary policy shock raises the near-term fed funds futures, with a diminishing effect on longer maturities, and depresses stock prices.
2. The (Odyssean) forward guidance shock increases the 2-year Treasury yield the most and depresses the stock prices. 
3. The asset purchase shock increases the 10-year Treasury yield the most and plays a large role in some of the most important asset purchase announcements. 
4. Delphic forward guidance shock (Campbell et al. 2012)  has a similar impact on the yield curve as the Odyssean forward guidance shock, but triggers an increase, rather than a decrease, in the stock prices.



Monika Piazzesi (2005) takes this approach  in a continuous-time model of the joint distribution of bond yields and the FOMC interest rate target for the FFR in a linear-quadratic jump-diffusion model. With high-frequency data she provides information about the exact timing of FOMC meetings. The short informational lag before Fed's policy decision, information available right before the FOMC meeting start provides a recursive identification scheme that turns the target forecast from right before the Federal Open Market Committee (FOMC) meeting into a high-frequency policy rule and the associated forecast errors into policy shocks. 
<!--
 This information can improve bond pricing and ability to identify monetary policy shocks.
--> 

<!--
so it is crucial to disentangle their effects.
Since Kuttner (2001), many papers 
Previous literature on high-frequency reactions of financial variables to central bank announcements has ignored it, treating the shocks explicitly or implicitly as Gaussian. This paper is, to my knowledge, the first attempt to tap this valuable source of information.
-->


<!--
Other exercises that find very similar four shocks
- estimation on the principal components of a larger dataset and 
- a variety of other modifications of the baseline model.
-->

<!--
Definitions Maybe in policy discussion?
Forward guidance refers to central bank public communication about the likely future path of short-term interest rates, largely aimed at guiding financial markets

the difference between Delphic and Odyssean forward guidance?
Statements or forecasts about the likely future direction of monetary policy are known as Delphic forward guidance, after the oracles at the Temple of Apollo at Delphi, a definition first offered by Chicago Fed President Charles Evans and co-authors. When the Fed releases its Summary of Economic Projections, for instance, policymakers signal how they believe rates may change, but they explicitly aren’t making a commitment. Delphic guidance, which has become common among central banks around the world, helps markets and the public better understand policymakers’ outlook and how they are likely to respond to changes in the economy.

Stronger, explicit commitments about the path of future policy are known as Odyssean, a reference to Odysseus binding himself to the mast in Homer’s epic poem. This form of guidance—for instance, a pledge not to raise short-term rates for “a considerable period”—can have a bigger impact on the markets and the economy than Delphic guidance. It is particularly useful when short-term interest rates are at or near the zero lower bound and the Fed is looking for other ways to stimulate the economy. But making such commitments can limit the Fed’s flexibility in responding to changes in the economy.

Odyssean shocks:
Odyssean forward guidance is a type of policy guidance that involves a clear commitment to a future state of monetary policy. It's a form of forward guidance that's expressed through public statements of future intentions and forecasts. The term comes from Homer's epic poem, where Odysseus binds himself to the mast, and is a reference to the strong commitments made in Odyssean forward guidance. 

Odyssean forward guidance can have a greater impact on the economy and markets than other types of forward guidance, such as Delphic guidance. Delphic guidance, on the other hand, is more like a forecast of future economic conditions. Odyssean forward guidance can be especially useful when short-term interest rates are near zero and the Fed is looking for other ways to stimulate the economy. However, it can also limit the Fed's flexibility in responding to economic changes. 

Delphic shocks
Jul 27, 2023 — Stronger, explicit commitments about the path of future policy are known as Odyssean, a reference to Odysseus binding himself to the mast in Homer's epic poem. This form of guidance—for instance, a pledge not to raise short-term rates for “a considerable period”—can have a bigger impact on the markets and the economy than Delphic guidance. It is particularly useful when short-term interest rates are at or near the zero lower bound and the Fed is looking for other ways to stimulate the economy. But making such commitments can limit the Fed's flexibility in responding to changes in the economy.

 Brookings Institution
Macroeconomic Effects of FOMC Forward Guidance | Brookings
\url{https://www.brookings.edu/articles/what-is-forward-guidance/#:~:text=Stronger%2C%20explicit%20commitments%20about%20the,to%20changes%20in%20the%20economy.|
We examine how public statements of FOMC intentions—forward guidance—can substitute for lower rates at the zero bound. We distinguish between Odyssean forward guidance, which publicly commits the FOMC to a future action, and Delphic forward guidance, which merely forecasts macroeconomic performance and likely monetary ...

* Brookings Institution
What is forward guidance? - Brookings Institution
\url{https://www.brookings.edu/articles/what-is-forward-guidance/#:~:text=Stronger%2C%20explicit%20commitments%20about%20the,to%20changes%20in%20the%20economy}

Brookings Institution
Macroeconomic Effects of FOMC Forward Guidance | Brookings
\url{https://www.brookings.edu/articles/what-is-forward-guidance/#:~:text=Stronger%2C%20explicit%20commitments%20about%20the,to%20changes%20in%20the%20economy.


* Bank for International Settlements
Forward Guidance and Expectation Formation: A Narrative Approach.  Christopher S.Sutherland
\url{https://www.bis.org/publ/work1024.htm}

* Bank for International Settlements
Forward Guidance and Expectation Formation: A Narrative Approach.  Christopher S.Sutherland
\url{https://www.bis.org/publ/work1024.htm}
Delphic forward. guidance is a statement that provides direct information about the probable state of monetary policy. in the future. Odyssean forward guidance is a statement that clearly indicates a commitment to a state. of monetary policy in the future.

* Marek Jarocinski Estimating the Fed’s unconventional policy shocks. JME May 2024 \url{https://doi.org/10.1016/j.jmoneco.2024.01.001}
\url{https://www.sciencedirect.com/science/article/abs/pii/S0304393224000011}
\url{https://marekjarocinski.github.io/identkurto/identkurto.html}
For git: \url{https://github.com/marekjarocinski/identkurto_update_202401.git}

\url{https://github.com/marekjarocinski/identkurto_update_202401/blob/main/README.md}
-->

<!--
Updating the Fed conventional and unconventional policy shocks from: Marek Jarocinski "Estimating the Fed's Unconventional Monetary Policy Shocks," Journal of Monetary Economics, doi:10.1016/j.jmoneco.2024.01.001
Updated shocks (January 1991 - January 2024):
U1s.csv - one standard deviation shocks
U1bp.csv - shocks scaled to move the relevant variable by 1 basis point
Construction of the shocks:
main.m - Matlab script (calls other Matlab functions)
Source data:
fomc_surprises_jk.csv - narrow window (30 minutes) surprises around FOMC announcements from 1988 to 2024 updated by Jarocinski and Karadi.
These codes were tested using Matlab R2023b.
-->

The shocks (Table \@ref{table:FOMC rate changes 2016-2023}) encompass changes in both policy and administered rates- FFR, IOR, ONRRP (same as changes in RRF?) and classify these changes under episodes). I have included events like US Treasury sales and macro financial shocks like the repo shock in 2019 and the dash for cash event in March 2020. I have included observations of US Treasury debt issuance and events such as the repo apocalypse in 2019 and the dash for cash of March 2020.



```{r, tab.cap="FOMC rate changes 2016-2023", echo=FALSE, results='asis'}
library(xtable)
fomc <- read.csv('C:/Users/Owner/Documents/Research/OvernightRates/Final data files/FOMCrates_sampleFinal.csv', header = TRUE, sep = ",", dec = ".", stringsAsFactors = FALSE)
#Set column names based on the first row
colnames(fomc) <- names(fomc)
#print(colnames)
fdate<-as.Date(fomc$Date,"%d/%m/%Y")
xtable_fomc <- xtable(fomc, comment = FALSE)
#print(xtable_fomc, comment = FALSE)
```
<!--
https://stackoverflow.com/questions/9660359/general-guide-for-creating-publication-quality-tables-using-r-sweave-and-latex
-->
```{r, tab.cap="FOMC notes_table", echo=FALSE, results='asis'}
library(xtable)
library(lubridate)
dates <- c("March 3, 2020", "March 11, 2020", "March 15, 2020", "March 16, 2020", "April 1, 2020",
           "June 1, 2020",  "August 28, 2020", "December11, 2020", 
           "July 28, 2021", "November 1, 2021", "December 1, 2021", 
           "January 26, 2022", "February 24, 2022", "March 16, 2022", "May 5, 2022", "June 1, 2022", 
           "June 16, 2022", "July 28, 2022", "September 22, 2022", "November 3, 2022", 
           "December 15, 2022", "February 2, 2023", "March 23, 2023", "May 4, 2023", 
           "July 27, 2023")

#if we can use formats June 2020 deleted
#If note, convert to June 1, 2020

#Create a function to parse dates flexibly
parse_flexible_date <- function(date_string) {
  # Try parsing date using different formats
  parsed_date <- NA
  formats <- c("%B %Y", "%B %d, %Y", "%B %d, %Y", "%Y-%m-%d")
  for (format in formats) {
    parsed_date <- as.Date(date_string, format = format, tryFormats = format)
    if (!is.na(parsed_date)) {
      break
    }
  }
  # Print parsed date for debugging
  #print(parsed_date)
  return(parsed_date)
}

#Apply parse_flexible_date function to dates
parsed_dates <- sapply(dates, parse_flexible_date)

valid_indices <- !is.na(parsed_dates)
                        
#Filter valid indices from parsed dates
valid_parsed_dates <- parsed_dates[valid_indices]

#Filter notes dataframe to include only rows with valid parsed dates
notes_with_valid_dates <- valid_parsed_dates 
#Correct later
#notes[valid_indices & !is.na(parsed_dates), ]

notes_with_valid_dates$Date<-notes_with_valid_dates 

#Convert the Date column to character strings   June 6 confusion this line UNECESSARY
#notes_with_valid_dates$Date <- as.character(notes_with_valid_dates$Date)

Events<- c("Fed set rate of purchases",
            "Fed updated guidance",
            "Fed began tapering",
            "Fed doubled tapering speed",
            "Fed emergency rate cut",
            "WHO declares Covid-19 pandemic",
            "Fed slashes rates to zero",
            "Stock market crash",
            "Highest US unemployment since 1948",
            "Fed announces new strategy",
            "Fed holds rates steady",
            "Powell states labor market conditions",
            "Russia invades Ukraine",
            "Fed makes first rate increase since 2018",
            "Fed increases interest rates",
            "Inflation peaks",
            "Fed raises rates",
            "Fed hikes rates",
            "Fed delivers another rate increase",
            "Fed increases rates",
            "Fed raises rates",
            "Fed adds another increase",
            "Fed increases interest rates",
            "Fed hikes another increase",
            "Fed delivers final increase of 2023")

#Create a dataframe with 'Date' and 'Event' columns
notes_with_valid_dates$Event<-Events
notes<- data.frame(Date = notes_with_valid_dates$Date, Event = notes_with_valid_dates$Event)

# Create the table with the modified Date column
xtable_notes <- xtable(notes, caption = "Important Events Timeline")
#, comment = FALSE, sanitize.text.function = identity)
#xtable_notes <- xtable(notes_with_valid_dates, caption = "Important Events Timeline")
print(xtable_notes)
```
<!--
June 2020 - In June 2020, the Fed set its rate of purchases to at least $\$$80 billion 
a month in Treasuries and $\$$40 billion in residential and commercial mortgage-backed 
securities until further notice. 

 December 2020 slow: The Fed updated its guidance in December 2020 to indicate it would 
 slow these purchases once the economy had made “substantial further progress” toward the 
 Fed’s goals of maximum employment and price stability. 
 - November 2021 taper: In November 2021, judging that test had been met, the Fed began 
 tapering its pace of asset purchases by  \$10 billion in Treasuries and \$5 billion 
 in MBS each month. 
 - December 2021 double taper: At the subsequent FOMC meeting in December 2021, the Fed 
 doubled its speed of tapering, reducing its bond purchases by $\$$20 billion in Treasuries 
 and  \$10 billion in MBS each month

March 3, 2020: Citing “evolving risks to economic activity” from the coronavirus outbreak, the Fed held an emergency meeting, cutting interest rates by 0.5% to 1.0–1.25%
March 11, 2020: The World Health Organization (WHO) declares Covid-19 a global pandemic
March 15, 2020: In another emergency meeting, the Fed slashes rates to zero (a range of 0–0.25%) and launches a $\$$700 billion quantitative easing program
March 16, 2020: The Dow falls 12.9%, triggering a stock market crash. It would go on to lose a total of 37% before ending the year with a 7.3% gain
April 2020: U.S. unemployment reaches an average of 14.7%, its highest level since 1948, although job losses for women and minorities are even higher
August 28, 2020: At an economic symposium in Jackson Hole, the Fed announces a new strategy that calls maximum employment “a broad-based and inclusive goal”
July 28, 2021: The Fed holds rates steady at near-zero levels, labelling rising inflation a “transitory” phenomenon
January 26, 2022: Powell states that “labor market conditions are consistent with maximum employment” and predicts future interest rate hikes
February 24, 2022: Russia invades Ukraine
March 16, 2022: The Fed makes its first interest rate increase since 2018, raising rates by 0.25% to a level of 0.25–0.50%
May 5, 2022: The Fed increases interest rates 0.50% to 0.75–1.00% and states that it anticipates ongoing increases to be “appropriate”
June 2022: Inflation, as measured by the Consumer Price Index (CPI), peaks at 9.1%
June 16, 2022: The Fed raises rates 0.75% to 1.50–1.75%
July 28, 2022: The Fed hikes rates another 0.75% to 2.25–2.50%
September 22, 2022: The Fed delivers another 0.75% rate increase, bringing rates to 3.00–3.25%
November 3, 2022: It increases rates by 0.75% to 3.75–4.00%, adding that it is “prepared to adjust the stance of monetary policy as appropriate if risks emerge”
December 15, 2022: This time, the Fed raises rates by 0.5% to 4.25–4.50%
February 2, 2023: It adds another 0.25% increase to 4.50–4.75%
March 23, 2023: The Fed increases interest rates by an additional 0.25% to 4.75–5.0% and launches the Bank Term Funding Program, which will aid distressed banks suffering from interest-rate risk
May 4, 2023: The Fed hikes another 0.25% to 5.00–5.25%
July 27, 2023: The Fed delivers its final 0.25% increase of 2023, bringing rates to 5.25–5.50%

Events:

1) repo rate spike
    9/16/2019 Repo spike SOHR 2.42 +13 over 9/15, EFFR 2.23 +11
    9/17/2019 Repo spike    SOFR 5+                  EFFR 2.3   
\url{https://www.federalreserve.gov/econres/notes/feds-notes/what-happened-in-money-markets-in-september-2019-20200227.html}

On Monday, September 16, SOFR printed at 2.43 percent, 13 basis points higher than the 
previous business day. With pressures in the repo market spilling over into the fed funds 
market, the EFFR printed at 2.25 percent, 11 basis points above the Friday print and at the 
top of the FOMC's target range. On September 17, the EFFR moved above the top of the target 
range to 2.3 percent and the SOFR increased to above 5 percent.

Concoda
. Each time the spread between SOFR and IORB has widened significantly, Wall Street behemoths have begun to allocate cash to repo trades, supplying liquidity to the most crucial funding market. Yet even Wall Street’s presence proved insufficient to create stable repo markets. Another level in the Fed’s repo hierarchy was needed.
•	In 2019, the “repocalypse” emerged. A cash shortage, prompted by scarce bank reserves, constrained dealer balance sheets, and a segmented repo market, not only caused repo but Fed Funds and FX swap rates to spike, surpassing the Fed’s upper rate boundaries. 
•	Standing Repo Facility, or SRF for short. transformed the SRF into a permanent facility, adding a ceiling to its repo hierarchy.
 In 2019, the “repocalypse” emerged. A cash shortage, prompted by scarce bank reserves, constrained dealer balance sheets, and a segmented repo market, not only caused repo but Fed Funds and FX swap rates to spike, surpassing the Fed’s upper rate boundaries. Monetary leaders responded by instituting a Standing Repo Facility, or SRF for short. The U.S. central bank’s primary dealers and other approved counterparties borrowed cash from the Fed, secured against U.S. Treasuries, and then distributed emergency funds to cash borrowers further down the hierarchy. Shortly after the dust settled, the Fed transformed the SRF into a permanent facility, adding a ceiling to its repo hierarchy.


But if dollar scarcity increases enough to send repo rates soaring, the Fed’s SRF will again become active. This time, a surge in SRF usage will be regarded as a standard reaction to tight liquidity conditions (such as a larger-than-usual deleveraging during quarter-end dates) and may provoke further official or “stealth” easing by monetary leaders. This uncertainty around possible instability will vanish once reserves fall to Fed officials’ lowest comfortable level, as QE likely resumes before a repo spike can even emerge. Even so, any measures the central bank implements to avert repo turmoil beforehand will also appear stimulative to most market participants. The Federal Reserve’s “repo put” lies in waiting

Once the surplus of cash in the Fed’s RRP facility dries up, the stability of the triparty repo market will once again be tested. The Fed’s QT (quantitative tightening) and the U.S. Treasury’s giant debt issuance will continue to pull funding away from repo, perhaps causing a repeat of the September 2019 “repocalypse”. Sensing a recurrence, a large number of banks have begun signing up to the Fed’s standing repo facility, granting themselves the ability to receive emergency loans and front-run a repo rate spike. If turmoil re-emerges, more monetary theatrics from the Federal Reserve await us, and the triparty repo market will be front and center

What is the repo put official or “stealth” easing by monetary leaders.

\url{https://www.newyorkfed.org/markets/soma-holdingshttps://www.newyorkfed.org/markets/soma-holdings}
\url{https://www.brookings.edu/articles/how-will-the-federal-reserve-decide-when-to-end-quantitative-tightening/}
\url{https://www.cbo.gov/publication/58457}  Fed Balance sheet
2) Mar 10-18 2020  Dash for cash 
    3/8/2020 0:00 subtract 5 from coordinate
    3/15/2020 0:00
The COVID-19 Pandemic Caused Market Disruptions across Sovereign Bond Markets
At the start of the COVID-19 pandemic in late February 2020, and in response to the economic 
repercussions of impending lockdown measures, investors began to demand higher-quality, 
safe assets. In particular, they shifted their portfolios toward sovereign bonds, and the 
resulting buying pressure drove sovereign yields to decline broadly. As the crisis intensified 
in March 2020, however, investors’ demand for cash surged, leading to selling pressure on 
sovereign bonds and therefore increases in their yields. This down-and-up pattern in yields 
is illustrated for ten-year U.S., German, U.K., and Japanese bonds in the chart below.

March 15, 2020 On March 15, 2020, the Fed shifted the objective of QE to supporting 
the economy. It said that it would buy at least $\$$500 billion in Treasury securities and  $\$$200 billion in government-guaranteed mortgage-backed securities over “the coming months.” 
 -  3/22/2020  March 23, 2020, it made the purchases open-ended, saying it would buy 
 securities “in the amounts needed to support smooth market functioning and effective 
 transmission of monetary policy to broader financial conditions,” expanding the stated 
 purpose of the bond buying to include bolstering the economy. 
 

 %Observations issues
%Overnight rates are heteroskedastic, outliers present 
%All rates track and cluster around the effective Federal rate (EFFR)
%Quickly respond to changes in EFFR
%volatility of short rates survives rate the Federal Reserve Bank's (Fed) 
%management of of the Federal Funds rate.
%Volatility relative to to prior periods (here daily) 

-->

<!--
Balance Sheet normalization Program 2018-2020 reduce balance sheet $10 billion per month, gradually increase $50b per month
QE4 2020-2021? $1,5 trillion through reverse repurchase transactions, short term lending
-->

<!--
[WHERE SHOULD THIS PLOT GO] [FIGURE]
The distributions of daily reference rates and billions of dollars in transactions, change dramatically under different FOMC policy regimes [figure times series of rates]   (Table \@ref{table_fomc}), altering medians, and variability as mesured by clustering around their medians, outliers, and time varying volatility
-->

# Methodology
I plan to explore methods proposed by Piazzesi, Bezoni et al and Jarocinski. 

I first run a vector sutoregression on the EFFR and repo market rates to gain insight into mean reversion over one day, t to t+1,and clustering.  I re-estimate Bertolini, Bertola, and Prati's empirical model of the volatility of the EEFR and compare the results.


## VAR of daily rates EFFR, TGCR, BGCR, SOFR
The Fed's policy rate, the EFFR at a daily frequency is mean reverting, but is changes little  in response to changes in money market rates TGCR, the tri party repurchase rate. and BGCR the bilateral market rate where dealers sell securities to their customers, some 0.14  basis points (bp). In response to changes in the EFFR, the money market rates change by around 2 bp, the TGCR positively 2.1 bp, the BGCR a negative 2.02 bp.  They respond to changes in own rates and SOFR -- TGCR positively, BGCR negatively. SOFR  responds very little to changes in the EFFR,  a small -.08bp, with increases under one bp with changes in the money market rates TGCR and BGCR.

(Table (\@ref(tab:samplebeta))
```{r,samplebeta,  echo=FALSE, results='asis',warning=FALSE, message=FALSE}
beta_data <- matrix(c(
  1.00182555, 0.1409165, 0.1409992, 0.1399591,
  2.10310984, 1.7925774, 1.6257807, 1.1879627,
  -2.02027651, -1.7704494, -1.6090021, -1.9716220,
  -0.08315791, 0.8399083, 0.8452791, 1.6475444,
  0.14850094, -4.5388432, -4.5471756, -4.3906652
), nrow = 5, byrow = TRUE)

rownames(beta_data) <- c("EFFR", "TGCR", "BGCR", "SOFR", "ones_v")
colnames(beta_data) <- c("EFFR", "TGCR", "BGCR", "SOFR")
beta <- as.data.frame(beta_data)
#print(beta)

betasample<-xtable(beta,caption = "Beta sample rates 3/4/2016 to 12/14/2023", label="tab:samplebeta", caption.placement="bottom", comment = FALSE)
rownames <- c("EFFR", "TGCR", "BGCR", "SOFR","Constant")
colnames <- c("EFFR", "TGCR", "BGCR", "SOFR")
betasample
#print(betasample)
```


<!--            
\emph{EGARCH simple model of daily rates}

\url{https://www.newyorkfed.org/markets/reference-rates/additional-information-about-reference-rates#additional_reference_rate_data}

\url{https://www.federalreserve.gov/econres/notes/feds-notes/elevated-option-implied-pinterest-rate-volatility-and-downside-risks-to-economic-activity-20231222.html}
December 22, 2023
Cisil Sarisoy1 202-736-5606
cisil.sarisoy@frb.gov
Elevated Option-Implied Interest Rate Volatility and Downside Risks to Economic Activity
\url{Option-Implied volatilities of interest rates}


Spence Hilton FEDNY
\url{https://www.newyorkfed.org/medialibrary/media/research/current_issues/ci11-7.pdf}
Federal funds rate behavior is most commonly measured
in one of two ways: the deviation of the effective funds rate
from the target rate (or its absolute value) is widely used to
gauge average performance of the rate over an entire day
relative to the operating target; the intraday standard deviation
of rates around the daily effective rate is the most comprehensive measure of rate volatility within a day.
Both measures tend to become elevated on so-called
high-payment-flow days—normally the first, middle, and
final business day of each month. On these days, the flow of
financial transactions that affect the distribution of reserves
held at the Fed by banks is much heavier and more uncertain
than usual. Accordingly, we examine funds rate behavior on
high-payment-flow days and on all other days separately. To
obtain summary statistics for this analysis, we calculate
median values for these measures over semiannual periods.7
References
\url{https://cepr.org/about/people/giuseppe-bertola}
\url{https://ideas.repec.org/e/c/ppr50.html}

Seth Carpenter  Selva Demiralp p 9
Morgan Stanley Chief Global Economist Seth Carpenter
\url{https://finance.yahoo.com/video/why-fed-stuck-between-rock-210843575.html?fr=yhssrp_catchall&guccounter=1&guce_referrer=aHR0cHM6Ly9zZWFyY2gueWFob28uY29tL3locy9zZWFyY2g_aHNwYXJ0PXN6JmhzaW1wPXlocy0wMDImcD1TZXRoK0NhcnBlbnRlcitGZWRlcmFsK1Jlc2VydmUrQm9hcmQmdHlwZT10eXBlODAyNjAtMjg5MzAxMzImcGFyYW0xPTE2NjEzODQ0ODU&guce_referrer_sig=AQAAAM-gU-qwmbgLVD12DnhHBI6MIE0LdXOpbl-x2ORMgPd0ZgxsUNgFLV3gALNHmaZVC1x2GpJsWhkBVeFWlRNv0hI68sOg8qUM-nwql6bDmTQbw4WotjnP2jghJjeDiA61qsq1R8fc-3oLXJeL1k7U5HdyKtJCr_-kqzMs0_8da3dn}
\url{https://www.federalreserve.gov/pubs/feds/2011/201122/201122pap.pdf}
realized 
Volatility in the federal funds market can be measured in different ways. In
these results, we show the results from using the average intraday volatility over the
preceding 30 days as a proxy for expected volatility in the near future. However, the results
are robust to using other measures of funds rate volatility, such as realized daily standard
deviation of the federal funds rate or the mean absolute deviation of the funds rate from the
target over the prior 30 days (not shown).
-->

Optimal Parameters
Nelson (1991): By setting conditional variance equal to a constant $\omega$ plus a weighted average (with positive weights) of past squared residuals, GARCH models elegantly capture the volatility clustering in asset returns first noted by Mandelbrot (1963): " .. . large changes tend to be followed by large changes-of either sign-and small changes by small changes... " This feature of GARCH models accounts for both their theoretical appeal and their empirical success.

In EGARCH models, $\sigma^2_t$ responds asymmetrically to positive and negative residuals thus can accommodate volatility in returns that rises in response to "bad news" (excess returns lower than expected) and falls in response to "good news" 

Nelson's (1991) model of daily stock returns:
$\nu_t$ i.i.d. with $E(\nu_t) =0, Var(_t) = 1$
\begin{align*}
 log(\sigma^2_t)-\xi_t - \kappa h_t& =\sum_{j=1}^{T} \delta_j log(\sigma^2_{t-j})- \xi_{t-j} - \kappa h_{t-j} +  \alpha(abs(\nu_{t-1} -E[abs(\nu_{t-1})]+ \chi \nu_{t-1}))\
\end{align*} (6)
 
$\xi_t$ is the average value of $log(\sigma^2_t)$.
The parameters $\delta$ and $\alpha$ capture ARCH-type persistence in the deviation of the log of the conditional variance from its unconditional expected value of $\xi_t + \kappa h_t$. The parameter $\chi$ allows increases and decreases in the federal funds rate to have asymmetric implications for future volatility.

Making $ln(\sigma^2_t)$ a linear function of time and lagged $\nu's$, ensures that $\sigma^2_t$ remains
nonnegative.

<!--
Notes
EGARCH
Hamilton on FF
The federal funds market is a good place to start for an understand-
 ing of either finance or monetary policy. From the point of view of
 finance, overnight federal funds represent the shortest-term security
 that is actively traded and thus form the base of any term structure
 relation
 
An open-market purchase injects new  reserves into the banking system and immediately affects the terms
at which these reserves are loaned overnight.
there does not appear to be a consensus as to the nature of predictable changes in the federal funds rate or the economic forces that produce them
spectacular outliers and autoregressive conditional heteroskedasticity (ARCH) effects that
characterize these data, and apart from Campbell (1987), none offered a detailed description of how the findings could be reconciled with profit maximization by banks
By contrast, this paper proposes a complete
 empirical description of the time-series process that generates the
 daily federal funds rate, simultaneously modeling the conditional
 mean, variance, and overall shape of the probability distribution of
 daily changes in the federal funds rate. These results are then used
 to understand what happens to the federal funds rate when the Fed
 makes an open-market purchase
 
  These results suggest that there is little, if any, interday speculation
 that would smooth out small fluctuations in the federal funds rate. A
 small temporary infusion of reserves through an overnight re-
 purchase agreement by the Fed's trading desk lowers that day's fed-
 eral funds rate by inducing movement along a schedule that repre-
 sents lending banks' liquidity benefit from holding excess reserves.
 The ability of the repurchase agreement to affect the interest does
 not depend on whether the open-market operation is anticipated in
 advance. I conclude that transaction costs, rather than a minor institu-
 tional detail of this particular market, lie at the heart of the liquidity
 effect that enables the Federal Reserve to change the interest rate on
 a daily basis
 
 Time series properties
 Most days the federal funds rate
 changes very little: more than half the time, the federal funds rate is
 within 10 basis points of its value on the previous day. Notwithstand-
 ing, huge changes in the federal funds rate have been observed, the
 extreme observation being an 800-basis-point rise on December 30,
 
 Figure 2 also suggests that one needs to allow for the possibility of
 end-of-quarter and end-of-year effects as well. Public scrutiny of
 many enterprises is based on their balance sheets, which typically
 represent a snapshot of an institution's assets on the last day of the
 quarter or the last day of the year. Some institutions appear willing
 to hold certain assets on December 30 that they are unwilling to hold
 on December 31. 
 
 At the end of the year, there is a surge in asset
 turnover and in corporations drawing on bank lines of credit, which
 can generate a huge demand for short-term loans of good funds
 around that date; see Allen and Saunders (1992) for further discus-
 sion. Again at a minimum we want to allow for increased variability
 of the federal funds rate at the end of the quarter and possibly tempo-
 rary departures from the martingale hypothesis on these days as well.
 1986
 
Nelson's (1991) model of daily stock returns:
$\nu_t$ i.i.d. with $E(\nu_t) =0, Var(_t) = 1$
\begin{align*}
 log(\sigma^2_t)-\xi_t - \kappa h_t& =\sum_{j=1}^{T} \delta_j log(\sigma^2_{t-j})- \xi_{t-j} - \kappa h_{t-j} +  \alpha(abs(\nu_{t-1} -E[abs(\nu_{t-1})]+ \chi \nu_{t-1}))\
\end{align*} (6)
 
$\xi_t$ is the average value of $log(\sigma^2_t)$ for the first Thursday of a reserve maintenance period.
The parameters $\delta$ and $\alpha$ capture ARCH-type persistence in the deviation of the log of the conditional variance from its unconditional expected value of $\xi_t + \kappa h_t$. The parameter $\chi$ allows increases and decreases in the federal funds rate to have asymmetric implications for future volatility.

$\nu_t$ i.i.d. with $E(\nu_t) =0, Var(_t) = 1$
\begin{align*}
\sigma^2_t&= \sigma^2(\xi_{t-1},\xi_{t-2}, \cdot,x_t,b,)\\
\sigma^2_t&= \sigma^2(\sigma_{t-1}z_{t-1},\sigma_{t-2}z_{t-2}, \cdot,x_t,b)
\end{align*}

\begin{align*}
\xi_t&=\sigma_t z_t\\
g(z_t)&=\theta z_t + \gamma(abs(z_t) -E[z_t])
log(\sigma^2_t)& = \alpha_t + \left(\sum_{j=1}^{\infty}\beta_j g(z_{t-j} \right) 
\end{align*}
-->
<!--
Researchers beginning with Black (1976) have 
found evidence that stock returns are negatively correlated with changes in
 returns volatility-i.e., volatility tends to rise in response to "bad news" (excess
 returns lower than expected) and to fall in response to "good news" (excess
 returns higher than expected). GARCH models, however, assume that only the
 magnitude and not the positivity or negativity of unanticipated excess returns
 determines feature $\sigma^2_t$. If the distribution of $z_t$ is symmetric, the change in
 variance tomorrow is conditionally uncorrelated with excess returns today.5In
 (1.4)-(1.5), $\sigma^2_t$ is a function of lagged $\sigma^2_t$ and lagged $Z^2$, and so is invariant to
 changes in the algebraic sign of the $z_t$'s-i.e., only the size, not the sign, of
 lagged residuals determines conditional variance. This suggests that a model in
 which $\sigma^2_t$ responds asymmetrically to positive and negative residuals might be
 preferable for asset pricing applications.
 
 
Another limitation of GARCH models results from the nonnegativity constraints on $\omega^*$ and the k in (1.7), which are imposed to ensure that  $\sigma^2_t$. remains nonnegative for all t with probability one. These constraints imply that increasing $Z^2_t$ in any period increases $\sigma^2_{t+m}$  for all $m\geq 1$, ruling out random oscillatory behavior in the  $\sigma^2_t$ process. Furthermore, these nonnegativity constraints can create difficulties in estimating GARCH models. For example, Engle, Lilien, and Robins (1987), had to impose a linearly declining structure on the a coefficients in (1.4) to prevent some of them from becoming negative.

 A third drawback of GARCH modelling concerns the interpretation of the "persistence" of shocks to conditional variance. In many studies of the time series behavior of asset volatility (e.g., Poterba and Summers (1986), French, Schwert, and Stambaugh (1987), and Engle and Bollerslev (1986a)), the central
question has been how long shocks to conditional variance persist. If volatility shocks persist indefinitely, they may move the whole term structure of risk premia, and are therefore likely to have a significant impact on investment in long-lived capital goods (Poterba and Summers (1986)).

Note.The representation (1.7) assumes that ${\sigma^2}$ is strictly stationary, so that the recursion can be carried into the infinite past.

#\url{https://stackoverflow.com/questions/58354207/interpreting-coefficients-of-rugarch-package-in-r}
$\eta_1$ is the rotation parameter, i.e. when you do decomposition of the residuals inside the equation for the conditional variance, you can allow a shift ($\eta2$) or/and rotation ($\eta_1$) in the news impact curve.
-->

<!--
VOlatility and Treasuries
# ----------------------- Different realized volatility measures
  # Use 252 day trailing window of std calculate three ways
  # Volatility is calculated using publicly released weekly snapshots for 
  # 52-week trailing windows, as the standard deviation of the first difference
  # M = movstd(A,k) returns an array of local k-point standard deviation value
  #  a. log(r_t)-log(r_{t+1})
  # b. std deviation (log(r_t)-log(r_{t+1}))
  # c. movstd(vol_b,244) with kernel K=244 or 252
  # Both models are estimated via OLS on daily data, using a 260-day rolling window 
  # to allow their parameters to adapt to a changing environment.
  # Liberty Street  Price volatility is calculated for each day by summing squared one-minute returns (log changes in midpoint prices) from 7 a.m. to 5 p.m., 
  # annualizing by multiplying by 252, and then taking the square root. It is reported in percent.
  # 
  # US Treasuries
  # \url{https://libertystreeteconomics.newyorkfed.org/2024/02/measuring-treasury-market-depth/}
  # Michael Fleming, OCTOBER 17, 2023, How Has Treasury Market Liquidity Evolved in 2023?
  # \url{https://libertystreeteconomics.newyorkfed.org/2023/10/how-has-treasury-market-liquidity-evolved-in-2023/}
# Volatility Spiked in March 2023
# The failures of Silicon Valley Bank and Signature Bank increased uncertainty about the economic outlook 
# and expected path of interest rates. Interest rate volatility increased sharply as a result, as shown 
# in the next chart, with two-year note volatility in particular reaching levels more than twice as high 
# as in March 2020. Volatility causes market makers to widen their bid-ask spreads and post less depth 
# at any given price to manage the increased risk of taking on positions, producing a negative relationship 
# between volatility and liquidity. The sharp rise in volatility and its subsequent decline hence help 
# explain the observed patterns in the liquidity measures.
#   # Darrell Duffie, Still the world’s safe haven? Redesigning the U.S. Treasury market after the COVID-19 crisis
  # June 22, 2020 \url{https://www.brookings.edu/articles/still-the-worlds-safe-haven/} 2020
  # Market Liquidity After the Financial Crisis Tobias Adrian,1 Michael Fleming,2 Or Shachar,2 and Erik Vogt3
  # \url{chrome-extension://efaidnbmnnnibpcajpcglclefindmkaj/https://www.annualreviews.org/docserver/fulltext/financial/9/1/annurev-financial-110716-032325.pdf?expires=1721940002&id=id&accname=guest&checksum=737C14143F629319A66CAE45259D46F7}
  # Hamilton Figure 1 displays the sample histogram for fid, drawn for comparison with the Normal distribution. Forty-six percent of the observations are exactly zero, 
  # while 25 observations exceed 5 standard deviations. If fid were an i.i.d. Gaussian time series, one would not expect to see even one 5 standard deviation outlier. Often these outliers occur on days that Gurkaynak, Sack, and
  # 
  # While GARCH, FIGARCH and stochastic volatility models propose statistical
  # constructions which mimick volatility clustering in financial time series, they
  # do not provide any economic explanation for it.
  # 
  # Duffie Among our other explanatory variables are measures of the volatility of the federal funds rate and of the 
  # strength of the relationship between pairs of counterparties.
  # To capture the volatility of the federal funds rate, we start with 
  # a dollar-weighted average during a given minute t of the interest rates of all loans made in that minute. 
  # We then measure the time-series sample standard deviation of these minute-by-minute average rates 
  # over the previous 30 minutes, denoted or(t). 
  # The median federal funds rate volatility is about 3 basis points, but ranges from under 1 basis point to 87 basis points, 
  # with a sample standard deviation of 4 basis points. Our measure of sender-receiver relationship strength for a particular 
  # pair (i,j) of counterparties, denoted Sij, is the dollar volume of transactions sent by i to j over the previous month 
  # divided by the dollar volume of all transactions sent by i to the top 100 institutions. The receiver-sender relationship 
  # strength Rij is the dollar volume of transactions received by i from j over the previous month divided by the dollar 
  # volume of all transactions received by i from j
  # 
  # The formal definition of the primary metric I study, market volatility, is the standard deviation of 1
  # minute returns: 
  # sibN=sqrt(sum 1 through n(ri -rbar)^2/(n-1))

-->

<!--
## A simple model of the EFFR
The parameters are all significant. Negative alpha1 and positive beta1 imply oscillatory behavior.

Mean Model:
$\mu$ or mu constant
ar1  AR term

Distribution Model
skew: skew
shape: shape
ghlambda: $\lambda$  (for GHYP distribution)

power term1(shock): $\delta$

Variance Model (GJR, EGARCH)
constant: omega
$\alpha_1$ or alpha1 is the ARCH(q) parameter. 
$\beta_1$ or beta1 is the GARCH(p) parameter. 
assymetry term: $\gamma_1$

<!--
$ t=frac{H_a-H_0}{s/n^.5)}$
df=n-1
A one tailed test is significant when the t is in the bottom or top alpha percent of the probability distribution
Say alpha= .05 Reject $H_0=0$ when t Pr(>|t)
If there is less than a 5 pct chance of a result as extreme as the sample mean if the null were true, then the null is rejected
-->

GARCH Model	: eGARCH(1,1)
Mean Model	: ARFIMA(1,0,0)
Distribution	: ged 
LogLikelihood : 19029.49 

Information Criteria:
Akaike       -19.450
Bayes        -19.430
Shibata      -19.450
Hannan-Quinn -19.443

(Table (\@ref(tab:garchparams))
```{r,garchparams,  echo=FALSE, results='asis',warning=FALSE, message=FALSE}
params_data <- matrix(c(
 0.000000,    0.000000,  -0.004848,  0.99613,
 0.002852,    0.000272,  10.465322,  0.00000,
-0.381938,    0.019067, -20.031004,  0.00000,
-0.541177,    0.103694,  -5.218990,  0.00000,
 0.902623,    0.002823, 319.747033,  0.00000,
 0.812176,    0.064852,  12.523500,  0.00000,
 0.113474,    0.000906, 125.248149,  0.00000
), nrow = 7, byrow = TRUE)

rownames(params_data) <- c("mu","ar1", "omega", "alpha1", "beta1", "gamma1", "shape")
colnames(params_data) <- c("Estimate", "Std. Error", "t value", "Pr(>|t)")
params <- as.data.frame(params_data)
#print(beta)

paramssample<-xtable(params, caption = "EGARCH parameters sample rates 3/4/2016 to 12/14/2023", label="tab:garchparams", caption.placement="bottom", comment = FALSE)
rownames(params_data) <- c("mu","ar1", "omega", "alpha1", "beta1", "gamma1", "shape")
colnames(params_data) <- c("Estimate", "Std. Error", "t value", "Pr(>|t)")
#rownames <- c("EFFR", "TGCR", "BGCR", "SOFR")
#colnames <- c("EFFR", "TGCR", "BGCR", "SOFR")
paramssample
#print(paramssample)
```


(Table (\@ref(tab:garchse))
```{r,garchse,  echo=FALSE, results='asis',warning=FALSE, message=FALSE}
garchse_data <- matrix(c(
  0.000000,    0.000039, -0.000012, 0.999990,
  0.002852,    0.006583,  0.433168, 0.664893,
 -0.381938,    0.127277, -3.000838, 0.002692,
 -0.541177,    0.434317, -1.246039, 0.212750,
  0.902623,    0.019047, 47.389363, 0.000000,
  0.812176,    0.326126,  2.490372, 0.012761,
  0.113474,    0.009091, 12.481586, 0.000000
), nrow = 7, byrow = TRUE)

rownames(garchse_data) <- c("mu","ar1", "omega", "alpha1", "beta1", "gamma1", "shape")
colnames(garchse_data) <- c("Estimate", "Std. Error", "t value", "Pr(>|t)")
garchse <- as.data.frame(garchse_data)
#print(garchse)

garchsesample<-xtable(garchse,caption = "EGARCH std errors sample rates 3/4/2016 to 12/14/2023", label="tab:garchse", caption.placement="bottom", comment = FALSE)
rownames(params_data) <- c("mu","ar1", "omega", "alpha1", "beta1", "gamma1", "shape")
colnames(params_data) <- c("Estimate", "Std. Error", "t value", "Pr(>|t)")
#rownames <- c("EFFR", "TGCR", "BGCR", "SOFR")
#colnames <- c("EFFR", "TGCR", "BGCR", "SOFR")
garchsesample
#print(paramssample)
```
-->

<!--
The Ljung-Box test, named after statisticians Greta M. Ljung and George E.P. Box, is a statistical test that checks if autocorrelation exists in a time series.
-->




## Replicate of Bertola et al empirical model of the Fed Funds rate 
For comparison with other methods, I replicate Bertolini, Bertola, Prati (2000) Day to day Monetary Policy and the Volatility of the Federal Funds Interest Rate empirical model of the volatility of the Federal Funds rate. The objectives of the Bertolini, Bertola, Prati () or BBP time series methodology for the Fed Funds were: 
- capture mean reversion behavior
- establish main patterns of volatility in the Fed funds rates.

Bertolini et al findings about the volatility of the FFR:
- rises in advance of reserve settlement days 
- declines in high rate regimes 
- biweekly periodicity when Fed is perceived as committed to keeping rates close to the target

They note that although overnight wholesale money market rates change in response to monetary policy and other shocks, they quick revert to changes in the unsecured federal funds rate (FFR) or administered rates.

Their empirical model of Fed Funds rate
$r_t=\mu_t + \sigma_t\nu_t$
$\nu_t$ unit variance mean zero i.i.d error term

\emph{Conditional mean} $r_t, \mu_t=E[r_t]$

Include target changes level shift changes of target rates affect on interest rates:
$\mu_t= r_{t-1} +\delta_t + \kappa k_t + \iota(r_t-r{t-1}$

k dummy variable: before and after holidays, end of quarter, 
$\delta$ specific to maintenance day, irrelevant

\emph{Conditional variance)
$\sigma^2_t= E[(r_t-\mu_t)^2]$
$log(\sigma^2_t) +\omega h_t +\xi z_t = \lambda(log(\sigma^2_{t-1}) +\omega h_{t-1} +\xi z_{t-1} )$ $abs(\nu_{t-1})+ \theta \nu_{t-1}$

calendar effect $h_t$ include:
data.frame':	1957 obs. of  12 variables:
 - holiday               
 - oneday_beforeholiday  
 - threeday_beforeholiday
 - oneday_afterholiday  
 - threeday_afterholiday
 - endquarter            
 - endyear              
 - around_qtr           
 - around_yr            
 - Monday               
 - Friday     

$z_t$ expresses the target rate as proportion of discount window primary credit rate (DPCredit)

<!--
(Table (\@ref(tab:arima_bbp))
```{r,arima_bbp,  eval = FALSE}
#echo=FALSE, results='asis',warning=FALSE, message=FALSE}

 # Define the number of observations
  T <- 100  # You can change this to any number of observations you need
  # Generate T observations for sd_effr from a normal distribution
  set.seed(123)  # Setting seed for reproducibility
  
  # Generate dummy variables (h) and penalty function (z)
  # Assuming h and z are known and have T-1 observations
  T <- nrow(spread_no_na) #number of observations
  h<-spread_no_na$h
  str(h)
  h$around_qtr <- NULL
  h$around_yr <- NULL
  h$holiday <- NULL
  h$threeday_afterholiday<- NULL  # only zeros --> check data
  str(h)
  target<-.5*(spread_no_na$TargetDe+spread_no_na$TargetUe)
  z<- 1- target/(spread_no_na$DPCREDIT*100)
  sd_effr<-spread_no_na$sd_effr*100
  log_sd_effr_squared <- log(sd_effr^2)
  #mu <- 0
  #sigma <- 1
  #nu <- rnorm(T, mean = mu, sd = sigma)
  nu<-rt(T, df = 5)
  #abs(\nu_{t-1})+ \theta \nu_{t-1}
  absnu<-abs(nu)
  
  
  non_trading_days_pairs <- function(dates, holidays) {
  n <- length(sdate)
  non_trading_counts <- numeric(n-1)
  
  for (i in 2:n) {
    start_date <- sdate[i - 1]
    end_date <- sdate[i]
    
    # Generate sequence of dates between start_date and end_date
    date_seq <- seq.Date(start_date, end_date, by = "day")
    
    # Identify weekends
    weekends <- weekdays(date_seq) %in% c("Saturday", "Sunday")
    
    # Identify public holidays
    holidays <- date_seq %in% holidays
    
    # Combine weekends and holidays
    non_trading <- weekends | holidays
    
    # Count non-trading days
    non_trading_counts[i - 1] <- sum(non_trading)
  }
  
  return(non_trading_counts)
}
  
 # Log function for non-trading days---------------------------------
   holidays <- as.Date(c(
    "2016-01-01", "2016-01-18", "2016-02-15", "2016-03-25", "2016-05-30", 
    "2016-07-04", "2016-09-05", "2016-11-24", "2016-12-26", "2017-01-02", 
    "2017-01-16", "2017-02-20", "2017-04-14", "2017-05-29", "2017-07-04", 
    "2017-09-04", "2017-11-23", "2017-12-25", "2018-01-01", "2018-01-15", 
    "2018-02-19", "2018-03-30", "2018-05-28", "2018-07-04", "2018-09-03", 
    "2018-11-22", "2018-12-25", "2019-01-01", "2019-01-21", "2019-02-18", 
    "2019-04-19", "2019-05-27", "2019-07-04", "2019-09-02", "2019-11-28", 
    "2019-12-25", "2020-01-01", "2020-01-20", "2020-02-17", "2020-04-10", 
    "2020-05-25", "2020-07-03", "2020-09-07", "2020-11-26", "2020-12-25", 
    "2021-01-01", "2021-01-18", "2021-02-15", "2021-04-02", "2021-05-31", 
    "2021-07-05", "2021-09-06", "2021-11-25", "2021-12-24", "2022-01-17", 
    "2022-02-21", "2022-04-15", "2022-05-30", "2022-06-20", "2022-07-04", 
    "2022-09-05", "2022-11-24", "2022-12-26", "2023-01-02", "2023-01-16", 
    "2023-02-20", "2023-04-07", "2023-05-29", "2023-06-19", "2023-07-04", 
    "2023-09-04", "2023-11-23", "2023-12-25", "2016-11-11", "2017-11-11", 
    "2018-11-11", "2019-11-11", "2020-11-11", "2021-11-11", "2022-11-11", 
    "2023-11-11", "2016-10-10", "2017-10-09", "2018-10-08", "2019-10-14", 
    "2020-10-12", "2021-10-11", "2022-10-10", "2023-10-09", "2020-07-04", 
    "2021-07-04", "2016-12-25", "2021-12-25", "2022-12-25"
  ))
  
  # VOlatility
  non_trading_counts <- non_trading_days_pairs(dates, holidays)
  nontradingdays<-non_trading_counts
  
  log_nontradingdays <- function(gamma, nontradingdays) {
    return(log(1 - gamma * nontradingdays))
  }
  
  # Negative log-likelihood function
  if (!require("stats4")) install.packages("stats4")
  library(stats4)
 

  neg_log_likelihood <- function(gamma) {
    if (any(1 - gamma * non_trading_counts <= 0)) {
      return(Inf)
    }
    X <- log(1 - gamma * non_trading_counts)
    model <- lm(log_sd_effr_squared[2:T] ~ X)
    residuals <- residuals(model)
    log_likelihood <- -sum(dnorm(residuals, mean = 0, sd = sd(residuals), log = TRUE))
    return(log_likelihood)
  }
  
  
  # non_trading_counts <- non_trading_days_pairs(dates, holidays)  
  # nontradingdays<-non_trading_counts
  # log_nontradingdays <- function(gamma, nontradingdays) {
  #   return(log(1 - gamma * nontradingdays))
  # }
  # 
  # # Negative log-likelihood function
  # if (!require("stats4")) install.packages("stats4")
  # library(stats4)
  # 
  #  neg_log_likelihood <- function(gamma) {
  #   if (any(1 - gamma * non_trading_counts <= 0)) {
  #     return(Inf)
  #   }
  #   X <- log(1 - gamma * non_trading_counts)
  #   model <- lm(log_sd_effr_squared[2:T] ~ X)
  #   residuals <- residuals(model)
  #   log_likelihood <- -sum(dnorm(residuals, mean = 0, sd = sd(residuals), log = TRUE))
  #   return(log_likelihood)
  # }

  
  # neg_log_likelihood <- function(gamma) {
  #   if (any(1 - gamma * non_trading_counts <= 0)) {
  #     return(Inf)
  #   }
  #   X <- log(1 - gamma * non_trading_counts)
  #   model <- lm(log_sd_effr_squared[2:T] ~ X)
  #   residuals <- residuals(model)
  #   log_likelihood <- -sum(dnorm(residuals, mean = 0, sd = sd(residuals), log = TRUE))
  #   return(log_likelihood)
  # }
  
  
  # Initial guess for gamma
  gamma_start <- 0.01
  
  # Use optimize to find the best gamma within a reasonable range
  result <- optimize(neg_log_likelihood, interval = c(0, 1))
  
  gamma_estimated <- result$minimum
  print(gamma_estimated) # 0.6180798 0.2361138
  
  # Update the nt calculation with the estimated gamma
  non_trading_counts <- c(0, non_trading_counts)
  nt <- log(1 - gamma_estimated * non_trading_counts)
  print(nt)
  

  external_regressors <- cbind(h[,2:ncol(h)], z,nt,absnu, nu)
  
  
  # Ensure there are no non-finite values in the cleaned data
  stopifnot(!any(is.na(log_sd_effr_squared)))
  stopifnot(!any(is.infinite(log_sd_effr_squared)))
  stopifnot(!any(is.na(external_regressors)))
  stopifnot(!any(is.infinite(as.matrix(external_regressors))))
  
  # Recalculate correlation matrix
  cor_matrix<- cor(external_regressors, use = "complete.obs")
  print(cor_matrix)
  
  # Create a zoo object for log_sd_effr_squared with sdate as the index
  log_sd_effr_squared_zoo <- zoo(log_sd_effr_squared, order.by = spread_no_na$sdate)
  
  # Fit an ARIMA model with cleaned external regressors using CSS
  arima_model <- arima(coredata(log_sd_effr_squared_zoo), order = c(1, 0, 0), xreg = external_regressors, method = "CSS")
  
  # Extract parameters and residuals
  arima_params <- arima_model$coef
  arima_residuals <- residuals(arima_model)
  
  print("ARIMA Model Parameters:")
  print(arima_params)
  
  
  arima_params <- arima_model$coef
  vcov_matrix <- vcov(arima_model)
  std_errors <- sqrt(diag(vcov_matrix))
  results <- data.frame(Coefficients = arima_params, StdErrors = std_errors)
  # Print the results
  #print(results)     
  
  # Convert the parameter_estimates to a data frame
  arima_params_df <- as.data.frame(results)
  
  # Create a table using xtable
  arima_params_table <- xtable(arima_params, caption = "Arima (1,0,0) sample rates 3/4/2016 to 12/14/2023", label="tab:arima_bbp", caption.placement="bottom", comment = FALSE)
# rownames(params_data) <- c("mu","ar1", "omega", "alpha1", "beta1", "gamma1", "shape")
# colnames(params_data) <- c("Estimate", "Std. Error", "t value", "Pr(>|t)")
   arima_params_table 
  # Print the table
  #print( arima_params_table) 
  
#   garchsesample<-xtable(garchse,caption = "EGARCH std errors sample rates 3/4/2016 to 12/14/2023", label="tab:garchse", caption.placement="bottom", comment = FALSE)
# rownames(params_data) <- c("mu","ar1", "omega", "alpha1", "beta1", "gamma1", "shape")
# colnames(params_data) <- c("Estimate", "Std. Error", "t value", "Pr(>|t)")
# #rownames <- c("EFFR", "TGCR", "BGCR", "SOFR")
# #colnames <- c("EFFR", "TGCR", "BGCR", "SOFR")
# garchsesample
#print(paramssample)
```  

(Table (\@ref(tab:garch_bbp))
```{r,garch_bbp,eval=FALSE}  
#echo=FALSE, results='asis',warning=FALSE, message=FALSE}
# Specify the EGARCH model --------------------------------------
  spec <- ugarchspec(
    variance.model = list(model = "eGARCH", garchOrder = c(1, 1)),
    mean.model = list(armaOrder = c(0, 0), include.mean = FALSE),
    distribution.model = "std" 
  )
  #"norm"
  # Fit the EGARCH model on the residuals from the ARIMA model
  fit <- ugarchfit(spec = spec, data = arima_residuals)
  
  # Print the EGARCH model parameters
  print("EGARCH Model Parameters:")
  print(coef(fit))
  
  coefficients <- coef(fit)
  
  # Extract the variance-covariance matrix
  vcov_matrix <- vcov(fit)
  
  # Calculate standard errors from the diagonal of the vcov matrix
  std_errors <- sqrt(diag(vcov_matrix))
  
  # Combine coefficients and standard errors into a data frame
  results <- data.frame(Coefficients = coefficients, StdErrors = std_errors)
  
  # Print the results
  print(results)
  
  # Convert the parameter_estimates to a data frame
  coefgarch_df <- as.data.frame(results)
  
  # Create a table using xtable
  coefgarch_table <- xtable(garch_bbp,caption = "EGARCH (1,1) sample rates 3/4/2016 to 12/14/2023", label="tab:garch_bbp", caption.placement="bottom", comment = FALSE)
# rownames(params_data) <- c("mu","ar1", "omega", "alpha1", "beta1", "gamma1", "shape")
# colnames(params_data) <- c("Estimate", "Std. Error", "t value", "Pr(>|t)")
# #rownames <- c("EFFR", "TGCR", "BGCR", "SOFR")
# #colnames <- c("EFFR", "TGCR", "BGCR", "SOFR")
# garchsesample)
  garch_bbp
  # Print the table
 # print(coefgarch_table)
  
 
#   garchsesample<-xtable(garchse,caption = "EGARCH std errors sample rates 3/4/2016 to 12/14/2023", label="tab:garchse", caption.placement="bottom", comment = FALSE)
# rownames(params_data) <- c("mu","ar1", "omega", "alpha1", "beta1", "gamma1", "shape")
# colnames(params_data) <- c("Estimate", "Std. Error", "t value", "Pr(>|t)")
# #rownames <- c("EFFR", "TGCR", "BGCR", "SOFR")
# #colnames <- c("EFFR", "TGCR", "BGCR", "SOFR")
# garchsesample
#print(paramssample)
```
```{r,eval=FALSE}
residuals_bbp <- residuals(fit)
plot(residuals_bbp)
```
(Table (\@ref(tab:arima_both))
```{r,arima_both, eval=FALSE}
#echo=FALSE, results='asis',warning=FALSE, message=FALSE}
  # try 6 --------------------------------------------------
  colnames(arima_params_df) <- c("Coefficients", "StdErrors")
  colnames(bbp1994_params) <- c("Coefficients", "StdErrors")

  
  # Custom print function to visually align titles above columns
  print_with_titles <- function(df1, df2, title1, title2) {
    # Print the titles
    cat(title1, "\t\t\t", title2, "\n")
    
    # Print the column names
    cat(paste(colnames(arima_params_df), collapse = "\t"), "\t", paste(colnames(bbp1994_params), collapse = "\t"), "\n")
    
    # Print the data row by row
    for (i in 1:nrow(arima_params_df)) {
      cat(paste(arima_params_df[i, ], collapse = "\t"), "\t", paste(bbp1994_params[i, ], collapse = "\t"), "\n")
    }
  }
  
  # Use the custom print function
  print_with_titles(arima_params_df, bbp1994_params, "DailyEFFR 2016-2023", "BBP post 1994 no FOMC")
  
  
  # Combine the dataframes using cbind for further analysis
  combined_df <- cbind(arima_params_df, bbp1994_params)
 
  
  # Print the combined dataframe for any further analysis if needed
  cat("\nCombined DataFrame:\n")
  print(combined_df)
  
  # Create a table using xtable-------------------- for overnight EFFR
     arima_both_table <- xtable(combined_df, caption = "Arima (1,0,0) sample rates 3/4/2016 to 12/14/2023", label="tab:arima_both", caption.placement="bottom", comment = FALSE)
```
-->

\emph{Findings Bertolini et al}
Bertolini et al () find the variance of the FFR rate 
- falls at the end of the year with variance 17 times larger that that of a typical day
- rise at end of quarters 1,2, and 3 with variance 8 times larger that that of a typical day and falls afterward
- tends to fall before holidays and rise afterwards
- responds positively to penalty rate 1.240     (0.465)
- increases on FOMC announcements days 0.783  (0.262)

Each non trading day raises the variance of the next trading day by 67 percent

The EGARCH parameters are significant indicating:
- persistence in underlying volatility of liquidity shock
- the distribution of errors df of student indicate very fat tails with t 2.94 significantly different than 3 $\rho=0.747$

When I ran BBP's set up of their model, during the period of this paper,daily date from  2016 through 2023 when there are no longer reserve requirements for depositor banks and institutions at the Federal Reserve. So eliminated their dummary days for the reserve period (see (Table (\@ref(tab:arima_both)).  

CREATE GARCH table

I found the  response of the FFR to dummies representing inividual dates very small compared to Bertolini el al:

endquarter              0.114887391 0.142475753   vs     2.081     0.181
endyear                 0.066116640 0.173470169          2.913     0.331

oneday_beforeholiday    0.100839203 0.132623548           NA        NA
threeday_beforeholiday -0.095986648 0.045628642           NA        NA
oneday_afterholiday     0.035191454 0.129995377           NA        NA


Other findings:
The variance of the FFR 
- rises 0.067 rather falls at the end of the year as in BBP
- rises  at end of quarters 1,2, and 3  by a much smaller 0.115 versus 2.08 in BBP
<!--with variance 8 times larger that that of a typical day and falls after-->
- rises one day before holidays but falls three days before holidays and rises one day after holidays but a much smaller effect whereas Bertolini evidence shows the FFR tends to fall before holidays and rise afterward

Bertolini estimates show the FFR
- responds positively to penalty rate 1.240     (0.465)
- increases on FOMC announcements days 0.783  (0.262)

DUring the period 2016-2023, my estimates show the volatility of of the daily EFFR
- falls with increases in penalty rate -.07 (0.222)
- increases on FOMC days
- small non trading day increase 0.062 (0.091)
- Bertolini, Bertola, Prati () 

<!--
- rise end of year 0.066 (0.173)
- rise end of quarter 0.115 (0.142)
- rise one day before holiday
- fall three days before holiday
- rise one day after holiday
-->

The Ljung-Box test check for autocorrelation of the volatility time series reports:

<!--The Ljung-Box test, named after statisticians Greta M. Ljung and George E.P. Box, is a statistical test that checks if autocorrelation exists in a time series.\url{https://statisticalpoint.com/ljung-box-test/}
Weighted Ljung-Box Test on Standardized Residuals
-->

------------------------------------
                        statistic   p-value
Lag[1]                      18.32 1.871e-05
Lag[2*(p+q)+(p+q)-1][2]     18.80 9.200e-06
Lag[4*(p+q)+(p+q)-1][5]     21.89 5.844e-06
d.o.f=0
H0 : No serial correlation

Weighted Ljung-Box Test on Standardized Squared Residuals
------------------------------------
                        statistic p-value
Lag[1]                      4.598 0.03200
Lag[2*(p+q)+(p+q)-1][5]     8.407 0.02334
Lag[4*(p+q)+(p+q)-1][9]    10.010 0.04993
d.o.f=2


EGARCH
-----------------------------------
GARCH Model	: eGARCH(1,1)
Mean Model	: ARFIMA(0,0,0)
Distribution	: std 

Optimal Parameters
------------------------------------
        Estimate  Std. Error   t value Pr(>|t|)
omega  -0.000301    0.241476 -0.001246 0.999006
alpha1  0.027822    0.084668  0.328600 0.742458
beta1   0.655685    0.042956 15.264051 0.000000
gamma1  2.157099    0.763514  2.825224 0.004725
shape   2.100000    0.077000 27.272755 0.000000

AR1	0.06	0.038
abs_nu	0.718	0.069
nu	0.276	0.042
  

<!--
 print(combined_df)
                       Coefficients   StdErrors Coefficients StdErrors
ar1                     0.844237998 0.013053850        0.060     0.038
intercept               2.014386816 0.107115536           NA        NA
oneday_beforeholiday    0.100839203 0.132623548           NA        NA
threeday_beforeholiday -0.095986648 0.045628642           NA        NA
oneday_afterholiday     0.035191454 0.129995377           NA        NA
endquarter              0.114887391 0.142475753        2.081     0.181
endyear                 0.066116640 0.173470169        2.913     0.331
Monday                  0.004691872 0.061329648           NA        NA
Friday                 -0.011205695 0.023676676           NA        NA
fomc                    0.009640622 0.005993818        0.783     0.262
fomcindex              -0.282124740 0.149256602           NA        NA
z                      -0.700007226 0.221871277        1.240     0.465
nt                      0.061577943 0.091488156           NA        NA
absnu                  -0.002429300 0.011621492        0.718     0.069
nu                     -0.007706428 0.007626636        0.276     0.042
-->

fomcindex              -0.282124740 0.149256602        0.783     0.262
z                      -0.700007226 0.221871277        1.240     0.465
nt                      0.061577943 0.091488156           NA        NA
absnu                  -0.002429300 0.011621492        0.718     0.069
nu                     -0.007706428 0.007626636        0.276     0.042


<!--

*---------------------------------*
*          GARCH Model Fit        *
*---------------------------------*

Conditional Variance Dynamics 	
-----------------------------------
GARCH Model	: eGARCH(1,1)
Mean Model	: ARFIMA(0,0,0)
Distribution	: std 

Optimal Parameters
------------------------------------
        Estimate  Std. Error   t value Pr(>|t|)
omega  -0.000277    0.249396 -0.001110  0.99911
alpha1  0.000790    0.083915  0.009414  0.99249
beta1   0.651946    0.043837 14.872050  0.00000
gamma1  2.127154    0.769761  2.763396  0.00572
shape   2.100000    0.078766 26.661201  0.00000

Robust Standard Errors:
        Estimate  Std. Error   t value Pr(>|t|)
omega  -0.000277    0.328358 -0.000843 0.999327
alpha1  0.000790    0.086349  0.009149 0.992700
beta1   0.651946    0.082412  7.910777 0.000000
gamma1  2.127154    1.097995  1.937307 0.052708
shape   2.100000    0.115172 18.233666 0.000000

LogLikelihood : -933.0832 

Information Criteria
------------------------------------
                    
Akaike       0.95870
Bayes        0.97295
Shibata      0.95868
Hannan-Quinn 0.96393

Weighted Ljung-Box Test on Standardized Residuals
------------------------------------
                        statistic   p-value
Lag[1]                      18.32 1.871e-05
Lag[2*(p+q)+(p+q)-1][2]     18.80 9.200e-06
Lag[4*(p+q)+(p+q)-1][5]     21.89 5.844e-06
d.o.f=0
H0 : No serial correlation

Weighted Ljung-Box Test on Standardized Squared Residuals
------------------------------------
                        statistic p-value
Lag[1]                      4.598 0.03200
Lag[2*(p+q)+(p+q)-1][5]     8.407 0.02334
Lag[4*(p+q)+(p+q)-1][9]    10.010 0.04993
d.o.f=2

Weighted ARCH LM Tests
------------------------------------
            Statistic Shape Scale P-Value
ARCH Lag[3]    0.9026 0.500 2.000  0.3421
ARCH Lag[5]    2.5280 1.440 1.667  0.3659
ARCH Lag[7]    3.1468 2.315 1.543  0.4863

Nyblom stability test
------------------------------------
Joint Statistic:  9.5486
Individual Statistics:             
omega  0.8831
alpha1 0.1182
beta1  1.2543
gamma1 0.2607
shape  0.5429

Asymptotic Critical Values (10% 5% 1%)
Joint Statistic:     	 1.28 1.47 1.88
Individual Statistic:	 0.35 0.47 0.75

Sign Bias Test
------------------------------------
                   t-value      prob sig
Sign Bias           4.6424 3.673e-06 ***
Negative Sign Bias  5.1426 2.981e-07 ***
Positive Sign Bias  0.7789 4.361e-01    
Joint Effect       37.7713 3.160e-08 ***


Adjusted Pearson Goodness-of-Fit Test:
------------------------------------
  group statistic p-value(g-1)
1    20     221.1    2.114e-36
2    30     220.4    2.564e-31
3    40     270.3    2.210e-36
4    50     294.6    9.091e-37


Elapsed time : 1.072841 

-->
## Candidate models of short rates to explore:
Piazzesi (2005) constructs a continuous-time model of the joint distribution of bond yields and the FOMC  interest rate target for the FFR. With high-frequency data in a linear-quadratic jump-diffusion model, she provides information about the exact timing of FOMC meetings. This information can improve bond pricing and ability to identify monetary policy shocks.

Both Federal Reserve and financial markets watch and depend on bond yields. Yield-based information may underlie the FOMC’s policy decisions and describes Fed policy better than Taylor rules.The Fed's estimated policy rule reacts to information in the yield curve, especially yields with two year maturities, implying the Fed responds to some medium-run forecast of the economy.The short informational lag before Fed's policy decision, information available right before the FOMC meeting start provides a recursive identification scheme that turns the target forecast from right before the Federal Open Market Committee (FOMC) meeting into a high-frequency policy rule and the associated forecast errors into policy shocks. 
 
Decisions about target moves result in a series of target values that looks like a pure jump process. Estimates reveals increased volatility of interest rates at all maturities in both FOMC meeting days and releases of key macroeconomic data. Macro news releases change the conditional distribution of a future Fed move. 
 
<!--
Findings:
 1) latent factors
 the target set by the Fed is an observable factor in the model and provides a clean measure of the short end of the yield curve. The use of target data avoids having to deal with calendar day effects in very short rates, which typically require lots of parameters
 2) Second, the estimated response of yields to policy shocks is strong and slowly declines only with the maturity of the yield
 3) The estimated policy rule describes the Fed as reacting to information contained in the yield curve. the most important information is contained in yields with maturities around two years, which suggests that the Fed reacts to some medium-run forecast of the economy. 

* The estimated policy rule displays interest rate smoothing: the target level is autocorrelated. 
* The rule also displays policy inertia: the Fed only partially adjusts the target to its desired rate. Inertia leads to positive autocorrelation in target changes, because one change is typically followed by additional changes in the same direction over a number of FOMC meetings

* yield data summarize market expectations of future target moves. These market expectations are
based on a host of variables that are omitted from other rules. 
yield data are available at higher frequencies and are less affected by
measurement errors than macroeconomic variables. 
The model demonstrated the policy inertia, the tendency to continue same policy changes. 
-->
(Andersen, Benzoni,Lund, 2004) model the U.S. short-term interest rate 3 month Tbill with a three-factor jump-diffusion model, a time-varying mean reversion factor, a stochastic volatility factor, and a jump process.  The U.S. short-term interest rate is characterized by complex conditional heteroskedasticity, fat-tailed innovations, and pronounced autocorrelation patterns. Stochastic volatility is critical for a good fit. Benzoni et al identify mean reversion of the short rate around a central tendency. The stochastic mean  allows a relatively fast mean-reversion of the short rate around a highly persistent time-varying central tendency process. Jumps are integral to the quality of fit and relieve the stochastic volatility factor from accommodating extreme outlier behavior. 

The mean drift may be indicative of slowly evolving inflationary expectations (Gara horiz?), time-variation in the required real interest rate, or both.

Estimating the Fed's unconventional policy shocks Javorscinski ()  estimates the structural shocks that underlie the reactions of financial market to FOMC announcements. While the nature of the shocks is not specified ex ante, ex post the estimated shocks can be naturally labeled as the current fed funds rate policy, an “Odyssean” forward guidance (a commitment to a future course of policy rates), a large scale asset purchase and a “Delphic” forward guidance (a statement about the future course of policy rates understood as a forecast of the appropriate stance of the policy rather than a commitment (Campbell et al., 2012).


<!--
[Alvarez] metrics for kurtosis 
Hamilton (1996) and others have concluded that the hypothesis that the FFR follows a martingale is inconsistent with observed daily changes in the federal funds rate. (Bertolini,Bertola, Prati ,) site frictions such as  transactions costs, interbank credit limits, overdraft penalties, obstacles to intra-period arbitrage preclude the FFR from following a martingale process.
-->


<!--
2. Affine Term Structure Models in the Handbook of Financial Econometrics, Elsevier
Monika Piazzesi
Department of Economics, Stanford University, Stanford, California

Several aspects of bond
yields, however, set them apart from other variables typically used inVAR studies. One
aspect is that bonds are assets, and that bonds with many different maturities are traded at
the same time. Bonds with long maturities are risky when held over short horizons, and
risk-averse investors demand compensation for bearing such risk.Arbitrage opportunities
in these markets exist unless long yields are risk-adjusted expectations of average future
short rates. Movements in the cross section of yields are therefore closely tied together.
These ties show up as cross-equation restrictions in a yield-VAR. Another aspect of yields is
that they are not normally distributed, at least not until recently. This makes it difficult
to compute the risk-adjusted expected value of future short rates.

Term structure models capture exactly these aspects of bond yields. They impose the
cross-equation restrictions implied by no-arbitrage and allow yields to be nonnormal.
The word “affine term structure model” is often used in different ways. I will use the
word to describe any arbitrage-free model in which bond yields are affine (constant plus-linear) functions of some state vector x.
1 Affine models are thus a special class of
term structure models, which write the yield $y(\tau)$ of a $\tau$-period bond as
$y(\tau) = A(\tau) + B(\tau)x$
for coefficients $A(\tau) and B(\tau)$ that depend on maturity $\tau$. The functions $A(\tau) and B(\tau)$
make these yield equations consistent with each other for different values of $\tau$. The
functions also make the yield equations consistent with the state dynamics.


The functional form of bond yields is obtained from computing risk-adjusted expectations of future short rates.Therefore, restrictive assumptions have to be made on the risk-adjusted dynamics of the state
vector. More concretely,the risk-adjusted process for the state vector needs to be an affine
diffusion, a process with affine instantaneous mean and variance.

Why Care About Bond Yields: 
forecasting
monetary policy
debt policy
derivative pricing and hedging 
computed from a given
model of the yield curve (see the references in Duffie et al.,2000). Banks need to manage
the risk of paying short-term interest rates on deposits while receiving long-term interest
rates on loans.

\url{https://libertystreeteconomics.newyorkfed.org/2023/11/treasury-bill-supply-and-on-rrp-investment/}

policy shocks on long-term bonds outside of a yield-curve model.
More patience is required to estimate a system of yield equations in a way that ensures
no-arbitrage. The cross-equation restrictions have to be derived from parameters that
describe the state dynamics and risk premia. Although the model is affine in the state
vector x,the functions $A(\tau) and B(\tau)$ are nonlinear functions of the underlying parameters

Cross-equation restrictions have many advantages. First, these restrictions ensure that
the yield dynamics are consistent. $A(\tau) and B(\tau)$ make yield equations consistent with
each other in the cross section and the time series. 

Second, term structure models allow us to separate risk premia from expectations
about future short rates.

EH under which expected excess bond returns are zero. Modified versions of the EH have been tested under which expected excess returns are constant. These tests compare, e.g., the ratio of the likelihood function with and without restrictions implied by the EH (for references, see Bekaert and Hodrick,
2001).The evidence suggests that expected returns on long bonds are on average higher
than on short bonds and that they are time-varying. Cross-equation restrictions are then
needed to model these risk premia.
Third, unrestricted regressions imply that the number of variables needed to describe
the yield curve equals the number of yields in the regression.

2. BASICS
2.1. Bond Pricing in Continuous Time
Term structure modeling determines the price of zero-coupon bonds
The pricing relation (2.2) shows that any yield-curve model consists of two ingredients:
(i) the change of measure from Q to $Q^{\ast}$ and
(ii) the dynamics of the short rate r under $Q^{\ast}$.
In so-called factor models of the yield curve,(ii) is replaced by the following assumption:
(ii)' the short rate r is a function R(x) of x and $x \in R^N$ is a time-homogeneous Markov process under $Q^{\ast}$.
This means that x is the relevant state vector, a vector of factors. This modified (ii)
assumption implies that the conditional expectation in (2.2) is some function F of time-to-maturity $\tau$ and the state x_t at time t, or
$P(\tau)_t = F(x_t, \tau)$.
To capture certain features of yield data (e.g., seasonalities around macroeconomic
news releases), I will later consider functions R that also depend on time t and time-inhomogeneous Markov processes x, in which case $P^{\tau}_t = F(x_t, t,\tau)$ separately depends on t and $\tau$ (in addition to x_t)


The payoff of zero-coupon bonds is 1 unit at maturity, so their price is
CORRECT (2.2)
where $E^{\ast}$ denotes expectation under $Q{\ast}$. Standard results show that if there exists a risk-neutral probability measure  $Q{\ast}$, a system of asset prices is arbitrage free

The big advantage of pricing bonds (or any other assets) in continuous time is Ito’s
Lemma. The lemma says that smooth functions F of some Ito process x and time t are
again Ito processes (see Duffie, 2001, Chapter 5 for details). The lemma thus preserves
the Ito property even if F is nonlinear. Ito’s Lemma allows me to turn the problem
of solving the conditional expectation in (2.2) into the problem of solving a PDE for
the bond price $F(x, \tau)$. The trick of computing (2.2) by solving a PDE is called the
Feynman–Kac approach.

2.2. Local Expectations Hypothesis
The LEH states that the pricing relation (2.2) holds under the data-generating measure
Q. Bond yields are thus given by
LEH : 3) CORRECT (2.4)
where $S = \int_{t}^{t+\tau} ru du$ (as above). The LEH therefore amounts to risk-neutral pricing: the data-generating measure Q and the risk-neutral measure $Q{\ast}$ coincide. This means that
expected excess returns on long bonds are zero.
The LEH is not the same as the more prominent EH, which states that bond yields
$y^{\tau}_t$ are expected values of average future short rates, or
EH : $\gamma^{\tau}_t = \frac{E_t(S)}{\tau}$. (2.5)

The difference between the two hypotheses (2.4) and (2.5) is due to Jensen’s inequality.
For example, suppose that the short rate is Gaussian under Q = $Q^{\ast}$, which implies that
Affine Term Structure Models S is also Gaussian (as the sum of Gaussians). With this normality assumption, Eq. (2.4) becomes  CORRECT
which differs from (2.5) because of the variance term.

3. AFFINE MODELS
Affine term structure models make functional-form assumptions in step (ii)' of yield curve modeling, which lead to tractable pricing formulas.The functional-form assumptions are on the short-rate function R(x) and the process x for the state vector under the
risk-neutral measure. The functional form is affine in both cases:
• R(x) is affine 
• x is an affine diffusion under $Q^{\ast}$:
• the drift $\mu^{\ast}_x(x)$  is affine
• the variance matrix $\sigma^{\ast}_x(x) \sigma^{\ast}_x(x)'$ is affine.

These functional forms are for coefficients under the risk-neutral measure. In particular,
the drift $\mu_x(x)$ is affine under the data-generating measure only when $\sigma_x(x) \sigma_\xi(x)$ is
affine, which can be seen from (2.12). The next sections make these assumptions more
precise and show that bond prices $F(x,\tau)$ are exponential-affine in x. In this setting,
yields are thus affine in x which explains the name of this class of models.

3.1. Affine Short Rate
The functional form of the short rate is made precise in the following assumption.
Assumption 1 The short rate is given by
$r = R(x) = \delta_0 +  \delta_1 x$
for 4) CORRECT

The choice of short-rate parameters [CORRECT 5] depends on the number of factors in
the model.The short rate usually is the factor in one-factor models, which means 5 The short rate in one-factor models is Markov. In N-factor models, the
short rate alone is not Markov, but the short rate together with N-1 yields is typically
Markov.The short rate often serves as one of the factors in multidimensional models. In
this case, we still have 5 . Long yields still depend on the other
factors because the expected future path of the short rate depends on the current state
x in (2.2), when the short rate covaries with these other factors under the risk-neutral
measure.
-->


<!--
Bertolini, Bertola, Prati () and Gara () observe the effect of Fed interventions on the volatility in interbank rates. Add
(Schuhlhofer et all propose efficiency in the ample reserves regime adopted (date) address the tradeoff the Fed makes to minimize the frequency of operations, volatility of interest rates, and balance sheet costs 

that daily money market rates hover around Fed targets and quickly revert to them in times of shocks.Bertolini et al note the tendency of short term rates to hover around official targets and quickly revert to them in times of shocks.

Bertolini et al Time series methodology: 
volatility of interest rates - rises in advance of reserve
settlement days - declines in high rate regimes - biweekly periodicity when Fed is perceived as committed to keeping rates close to the target

Although overnight wholesale money market rates change in response to monetary policy and other shocks, they quick revert to changes in the unsecured federal funds rate (FFR) or administered rates.

- capture mean reversion behavior
- main patterns of volatility in the data

Empirical model of Fed Funds rate
$r_t=\mu_t + \sigma_t\nu_t$
$\nu_t$ unit variance mean zero i.i.d error term

\emph{Conditional mean} $r_t, \mu_t=E[r_t]$

Include target changes level shift changes of target rates affect on interest rates:
$\mu_t= r_{t-1} +\delta_t + \kappa k_t + \iota(r_t-r{t-1}$

k dummy variable: before and after holidays, end of quarter, 
$\delta$ specific to maintenance day, irrelevant

\emph{Conditional variance)
$\sigma^_t= E[(r_t-\mu_t)^2]$

calendar effect $h-t$ and $z_t$ target rate as proportion of penalty rate (discount rate?)
Other variables irrelevant to time period

zt candidate: daily 2019-current 

2016 through 6/19/2019 monthly INTDSRUSM193N
6/20/2019/12/14/2023  daily DPCresit
Primary credit is available to generally sound depository institutions at a rate set relative to the Federal Open Market Committee's (FOMC) target range for the federal funds rate. Depository institutions are not required to seek alternative sources of funds before requesting advances of primary credit. Primary credit may be used for any purpose, including financing the sale of federal funds. By making funds readily available at the primary credit rate the primary credit program complements open market operations in the implementation of monetary policy.
Reserve Banks ordinarily do not require depository institutions to provide reasons for requesting very short-term primary credit. Rather, borrowers are asked to provide only the minimum information necessary to process a loan, usually the amount and term of the loan.

This rate replaces that for adjustment credit, which was discontinued after January 8, 2003. For further information, see Board of Governor's announcement. The rate reported is that for the Federal Reserve Bank of New York.

Suggested Citation:
Board of Governors of the Federal Reserve System (US), Discount Window Primary Credit Rate [DPCREDIT], retrieved from FRED, Federal Reserve Bank of St. Louis; https://fred.stlouisfed.org/series/DPCREDIT, June 21, 2024.

The EGARCH(1,1) allows for significant difference from  unconditional variance $ \omega h_t + \psi z_t$
ARCH tests did not reveal residual conditional heteroscedacity 

Variance of FF rate: $log(\sigma^2_t)-\omega h_t - \psi z_t=\lambda[og(\sigma^2_{t-1})-\omega h_{t-1} - \psi z_{t-1}]+ \alpha abs(\nu_{t-1}) = \theta \nu_{t-1} $

Hypothesis time profile ofinterest rates should reflect Fed 's inclination to accommodate liquidity shocks
-->


<!--
USE this in paper outline:  Section II provides a brief review of the current operation of re-
 serve requirements and the federal funds market in the United
 States. Section III develops a time-series description of daily changes
 in the federal funds rate. 
-->
 
 <!--
 Hamilton ----------------------
 Section IV proposes a theoretical model of the federal funds market that
 could account for these features as a result of line limits, transaction
 costs, and weekend accounting conventions.
 
 These results suggest that there is little, if any, interday speculation
 that would smooth out small fluctuations in the federal funds rate. A
 small temporary infusion of reserves through an overnight re-
 purchase agreement by the Fed's trading desk lowers that day's fed-
 eral funds rate by inducing movement along a schedule that repre-
 sents lending banks' liquidity benefit from holding excess reserves.
 
 The ability of the repurchase agreement to affect the interest does
 not depend on whether the open-market operation is anticipated in
 advance. 
 
 A small temporary infusion of reserves through an overnight repurchase agreement by the Fed's trading desk, whether or not the open-market operation is anticipated in advance, lowers that day's federal funds rate by inducing movement along a schedule that represents lending banks' liquidity benefit from holding excess reserves. [repo means dealer deposits (borrowed) reserves collateralized by UST securities?]
 
Hamilton provides valuable evidence of  end-of-quarter and end-of-year effects since bank balance sheets are publically available, providing a snapshot of an institution's assets on the last day of the
quarter or the last day of the year. Fridays, the federal funds market is soft. A federal funds loan on a Friday has a 3-day term rather than a 1-day term, and it is not altogether surprising that if the 
martingale hypothesis fails, its failure might show up in part in the appearance of something different about Fridays. 

Hamilton (1996) adapts Nelson's (1991) model of daily stock return in a model of the conditional mean and the conditional variance of  the FFR federal funds rate. The volatility consequences of upward and downward moves in interest rates are asymmetric. There is controversy if the FFR and overight rates, follow a random walk. Hamilton (1996) and others have concluded that the hypothesis that the FFR follows a martingale is inconsistent with observed daily changes in the federal funds rate. (Bertolini,Bertola, Prati ,) site frictions such as  transactions costs, interbank credit limits, overdraft penalties, obstacles to intra-period arbitrage preclude the FFR from following a martingale process.

His empirical description of the time-series process that generates the
 daily federal funds rate, simultaneously modeling the conditional
 mean, variance, and overall shape of the probability distribution of
 daily changes in the federal funds rate. These results are then used
 to understand what happens to the federal funds rate when the Fed
 makes an open-market purchase
 
Mondays are independently estimated to be days of federal funds increases. If we accept the idea that the level of the  federal funds rate tends to be a little low on Fridays, the change from Friday to Monday by implication would be bigger than average.

 
 I conclude that transaction costs, rather than a minor institu-
 tional detail of this particular market, lie at the heart of the liquidity
 effect that enables the Federal Reserve to change the interest rate on
 a daily basis
 
end-of-quarter and end-of-year effects as well. Public scrutiny of
 many enterprises is based on their balance sheets, which typically
 represent a snapshot of an institution's assets on the last day of the
 quarter or the last day of the year. Some institutions appear willing
 to hold certain assets on December 30 that they are unwilling to hold
 on December 31. At the end of the year, there is a surge in asset
 turnover and in corporations drawing on bank lines of credit, which
 can generate a huge demand for short-term loans of good funds
 around that date; see Allen and Saunders (1992) for further discus-
 sion. Again at a minimum we want to allow for increased variability
 of the federal funds rate at the end of the quarter and possibly tempo-
 rary departures from the martingale hypothesis on these days as well
 
 
 The model  In modeling the conditional mean, recall that the martingale hy-
 pothesis does not restrict the process followed by it if t corresponds
 to the first Thursday of a maintenance period. The last day of a
 quarter may likewise reflect special circumstances, with limited substi-
 tutability with reserves held on the day before or after. Thus if t is
 the first day of a maintenance period or the first day of a quarter, I
 describe the conditional mean for the federal funds rate with a pth-
 order autoregression:
 
 The mean 
 \begin{align*}
 i_t&=\mu_t +\sigma_t \nu_t\\
 \mu_t &= i_{t-1} + \eta_{s_t} + \beta h_t\\
 y_t &= [(sum_{i}^{}(v_{i,t}) times yhat_{i,t})]/(sum_{i}^{}v_{i,t})
 \end{align*}
 where $s_t$  {1, 2, . . ., 10} indicates which day of the maintenance
 period is associated with observation t.
  
  Thus $\eta_2$ corresponds to the average change in the federal funds rate
 between the first Thursday and Friday of a maintenance period,
 whereas $\eta_10$ gives the average change of the federal funds rate on
 settlement Wednesday. Under the martingale hypothesis, $\eta_j$ = 0 for j=2, 3, .. ., 10.
 
 
To describe at, the conditional variance of the federal funds rate,
 I adapt Nelson's (1991) model of daily stock returns
 $log(\sigma^2_t)-\xi_{s_t}-\kappa h_t = (sum_{j=1}^{\tau}(log(\sigma^2_{t-j}) -\xi_{t-j}-\kappa h_{t-j} =
 (\alpha abs(\nu_{t-1})-E(abs(\nu_{t-1})) + \chi\nu_{t-1})$  or $hi or \zeta$
 
Empirical results  pp 38-44 
 He finds deviations of the FFR from the FOMC target tend to dissipate quickly. (same for other rates?).  S fraction - ) of the cumulative change over the preceding two days is reversed on
 day t:
 $\mu_t = \eta_1 + i_{t-l} + \fi(i_{t-1} - i_{t - 3} + I'h_t $ (12)
 
 the unconditional variance has the same value for days 2-7,
 $ \xi_2 = \xi_2= cdot \xi_7 $ (13)
 the generalized autoregressive conditional heteroskedasticity
 effects are integrated:
 $\delta_2 + \delta_2  + cdot + \delta_\tau= 1$
 
Two magnitudes most useful for describing the conditional variance are (1) the conditional variance on the previous day and (2) the average deviation during the maintenance period (eqn 12)
 
  The autoregressive coefficients that characterize the first day of a new maintenance pe-
 riod or new quarter take the following form: some fraction - ) of
 the cumulative change over the preceding two days is reversed on
 day t. That is, these observations are described with the following
 special case of (4):
 $\mu_t = 91 + i_{t-l} + 4k(i_{t-1} - i_{t - 3} + I'h_t $ (12)
 where I estimate + = - 0.81. This is clearly related to the conclusion
 by Rudebusch (1994) that deviations of the funds rate from the value
 targeted by the Fed tend to dissipate quickly. M
 
 \url{https://bookdown.org/dalzelnm/bookdown-demo/mathematical-notation-in-r.html}
 $Y_i \sim N( \mu, \sigma)$ makes  Yi∼N(μ,σ)
 gridExtra::grid.arrange(g1,g2, g1,g2, ncol = 2)
 .
 The vector $h_t$ is a collection of zero-one dummy variables incorporating calendar effects.
 Calendar effects nine elements of h_t :
 t holidays (as captured by the first four elements of ht) matter for
 the mean parameters (I) but not for the variance parameters (K). By
 contrast, the end-of-quarter and end-of-year effects on the variance
 were very dramati
  j 1 Kj Meaning
 1 -.028 {.00} t precedes a 1-day holiday
 (.020)
 2 -.031 {.00} t precedes a 3-day holiday
 (.011)
 3 .023 {.00} t follows a 1-day holiday
 (.020)
 4 .171 {.00} t follows a 3-day holiday
 (.017)
 5 {.00} .853 t is the last day of quarter 1, 2, 3, or 4
 (.379)
 6 {.00} .975 t is the last day of the year
 (.765)
 7 {.00} 1.550 t is the day before, on, or after the last day of quarter 1,
 (.216) 2, or 3
 8 {.00} {1.550} t is 2 days before, 1 day before, on, 1 day after, or 2 days
 after the end of the year
 9 {.185} {.00} t is day 9 but precedes a 1-day holida
 
  MAXIMUM LIKELIHOOD ESTIMATES OF OTHER PARAMETERS IN EQUATIONS
 (7), (12), AND (15)
 Parameter Value Meaning
 $\fi$- .811 Fraction of $i_{t-1} - i_{t-3}$ that is expected to be reversed if t is
 (.021) first day of a new period
  $\delta$- .793 Weight on the previous day's log variance in determining
 (.046) today's log variance
   $\alpha$-.316 Weight on the absolute value of the previous day's innova-
 (.036) tion in determining today's log variance
 $\x$ .341 Additional effect of a positive previous day's innovation in
 (.083) determining today's log variance
  $\rho$- .861 Fraction of innovations drawn from distribution 1
 (.026)
 j 1{1.00} Standard deviation of distribution 1
 T2 2.915 Standard deviation of distribution 2
 (.200


Fridays, the federal funds market is soft  the eta's
 A federal funds loan on a Friday has a 3-day term rather
 than a 1-day term, and it is not altogether surprising that if the mar-
 tingale hypothesis fails, its failure might show up in part in the ap-
 pearance of something different about Fridays. Likewise, days 3 and
 8 are both Mondays, and both are independently estimated to be days
 of federal funds increases. If we accept the idea that the level of the
 federal funds rate tends to be a little low on Fridays, the change from
 Friday to Monday by implication would be bigger than average

 proposes a complete
 empirical description of the time-series process that generates the
 daily federal funds rate, simultaneously modeling the conditional
 mean, variance, and overall shape of the probability distribution of
 daily changes in the federal funds rate. These results are then used
 to understand what happens to the federal funds rate when the Fed
 makes an open-market purchasThe federal funds market is a good place to start for an understand-
 ing of either finance or monetary policy. From the point of view of
 finance, overnight federal funds represent the shortest-term security
 that is actively traded and thus form the base of any term structure
 relation. Indeed, recent papers by Balduzzi, Bertola, and Foresi
 (1993), Roberds, Runkle, and Whiteman (1994), and Rudebusch
 (1994) suggest that several well-known puzzles in the term structure
 of interest rates can be resolved by tracking these relations back to
 daily changes in the federal funds rate.
 From the point of view of monetary policy, the daily operating
 procedures of the Federal Reserve System are also defined in terms
 of the federal funds market. An open-market purchase injects neThe federal funds market is a good place to start for an understand-
 ing of either finance or monetary policy. From the point of view of
 finance, overnight federal funds represent the shortest-term security
 that is actively traded and thus form the base of any term structure
 relation. Indeed, recent papers by Balduzzi, Bertola, and Foresi
 (1993), Roberds, Runkle, and Whiteman (1994), and Rudebusch
 (1994) suggest that several well-known puzzles in the term structure
 of interest rates can be resolved by tracking these relations back to
 daily changes in the federal funds rate.
 From the point of view of monetary policy, the daily operating
 procedures of the Federal Reserve System are also defined in terms
 of the federal funds market. An open-market purchase injects ne
 a consensus as to the nature of predictable changes in
 the federal funds rate or the economic forces that produce them.
 Earlier researchers have agreed that this daily interest rate fails to
 follow a martingale, However,
 none of these studies made allowance for the spectacular outliers
 and autoregressive conditional heteroskedasticity (ARCH) effects that
 characterize these data, and apart from Campbell (1987), none of-
 fered a detailed description of how the findings could be reconciled
 with profit maximization by banks.
-->


# Results
# Conclusion

# References
Adam Copeland | Darrell Duffie | Yilin (David) Yang.  Reserves Were Not So Ample After All. July 2021. Federal Reserve Bank of New York Staff Reports, no. 974
JEL classification: G14, D47, D8

James D. Hamilton. The Daily Market for Federal Funds. February 1996. Journal of Political Economy, Vol. 104, No. 1 
Stable URL: \url{https://www.jstor.org/stable/2138958} 
 Published by: The University of Chicago Press  pp. 26-56

Piazzesi, Monika. Bond Yields and the Federal Reserve. April 2005. Journal of Political Economy, Volume 113, Issue 2, pp. 311-344.

Gara Afonso, Kyungmin Kim, Antoine Martin, Ed Nosal, Simon Potter, and Sam Schulhofer-Wohl. Monetary policy implementation with an ample supply of reserves. January, 2020. Federal Reserve Bank Chicago.WP 2020-02
\url{https://doi.org/10.21033/wp-2020-0}

Bertolini.L, Bertola, Prati. Day-To-DaY_Monetary Policy and the Volatility of the Federal Funds Interest Rate. December 2000.  IMF WOrking Paper WP/00/206

Torben Gustav Andersen, Luca Benzoni,Jesper Lund. Stochastic volatility, mean drift, and jumps in the short-term interest rate. January 2004

@{article,
author = {Andersen, Torben and Benzoni, Luca and Lund, Jesper},
year = {2004},
month = {01},
pages = {},
title = {Stochastic volatility, mean drift, and jumps in the short-term interest rate}
}

article_citation <- list(
  author = c("Hamilton, James D."),
  year = 1996,
  month = 02,
  title = "The Daily Market for Federal Funds.",
  journal = "Journal of Political Economy",
  volume = "104",
  issue = "1",
  type = "article"
)

<!-
Campbell, Jeffrey R., Charles L. Evans, Jonas D. M. Fisher, and Alejandro Justiniano (2012) “Macroeconomic Effects of Federal Reserve Forward Guidance,” Brookings Papers on Economic Activity, 1–80, https://EconPapers.repec.org/RePEc:
bin:bpeajo:v:43:y:2012:i:2012-01:p:1-80.
-->

article_citation <- list(
  author = c("Campbell, Jeffrey R., Charles L. Evans, Jonas D. M. Fisher, and Alejandro Justiniano"),
  year = 2012,
  month = 04,
  title = "Macroeconomic Effects of Federal Reserve Forward Guidance",
  volume = "113",
  issue = "2",
  pages = "1-80",
  type = "Brookings Papers on Economic Activity"
)
article_citation <- list(
  author = c("Piazzesi, Monika"),
  year = 2005,
  month = 04,
  title = "Bond Yields and the Federal Reserve",
  volume = "113",
  issue = "2",
  pages = "311-344",
  type = "Article"
)

article_citation <- list(
  author = c("Afonso, Gara", "Kyungmin, Kim", "Martin, Antoine","Potter,Simon","Schulhofer-Wohl,Sam"),
  year = 2004,
  month = 01,
  title = "Stochastic volatility, mean drift, and jumps in the short-term interest rate",
  type = "article"
)

article_citation <- list(
  author = c("Afonso, Gara", "Cipriani, Marco ", "La Spada,Gabriele"),
  year = 2022,
  month = 12,
  title = "Banks’ Balance-Sheet Costs, Monetary Policy, and the ON RRP",
  type = "NY Federal Reserve staff report NO. 1041"
)

article_citation <- list(
  author = c("Afonso, Gara", "Logan,Lorie", "Martin, Antoine",  "Riordan, William", "ZobelPatricia"),
  year = 2022,
  month = 1,
  title = "Reverse Repo Facility Works",
  type = "Federal Reserve Bank of New York Liberty Street Economics\url{https://libertystreeteconomics.newyorkfed.org/2022/1/how-the-feds-overnight-reverse-repo-facil%%ity-works/}"
)


article_citation <- list(
  author = c("Bertolini.L", " Bertola", "Prati"),
  year = 2000,
  month = 12,
  title = "Day-To-DaY_Monetary Policy and the Volatility of the Federal Funds Interest Rate",
  type = " IMF WOrking Paper"
)

article_citation <- list(
  author = c("Andersen, Torben", "Benzoni, Luca", "Lund, Jesper"),
  year = 2004,
  month = 01,
  title = "Stochastic volatility, mean drift, and jumps in the short-term interest rate",
  type = "article"
)

article_citation <- list(
  author = c("Romer, Christina D.", "Romer, David H."),
  year = 2023,
  month = 04,
  title = "DOES MONETARY POLICY MATTER? THE NARRATIVE APPROACH AFTER 35 YEARS",
  type = "NBER Working Paper 31170"
)

\url{http://www.nber.org/papers/w31170}

article_citation <- list(
  author = c("Bianchi,Francesco", "Ludvigsony, Sydney C.","Ma,Sai"),
  year = 2024,
  month = 01,
  title = "Monetary-Based Asset Pricing: A Mixed-Frequency Structural
Approach",
  type = "NBER Working Paper "
)


article_citation <- list(
  author = c("Jarocinski, Marek),
  year = 2022,
  month = 06,
  title = "Estimating the Fed's unconventional policy shocks",
  type = "article ECB working paper"
)

article_citation <- list(
  author = c("Adams, Michael),
  year = 2024,
  month = 05,
  title = "Federal Funds Rate History 1990 to 2024",
  type = "\url{https://www.forbes.com/advisor/investing/fed-funds-rate-history/}"
)

Concoda

Richmond Fed

Liberty Street

<!--
%\url{https://libertystreeteconomics.newyorkfed.org/2022/01/how-the-feds-overnight-reverse-repo-facility-w%orks/}

* Brookings Institution
What is forward guidance? - Brookings Institution
\url{https://www.brookings.edu/articles/what-is-forward-guidance/#:~:text=Stronger%2C%20explicit%20commitments%20about%20the,to%20changes%20in%20the%20economy}

Brookings Institution
Macroeconomic Effects of FOMC Forward Guidance | Brookings
\url{https://www.brookings.edu/articles/what-is-forward-guidance/#:~:text=Stronger%2C%20explicit%20commitments%20about%20the,to%20changes%20in%20the%20economy.|

Bank for International Settlements
Forward Guidance and Expectation Formation: A Narrative Approach.  Christopher S.Sutherland
\url{https://www.bis.org/publ/work1024.htm}

-->


# Appendix
